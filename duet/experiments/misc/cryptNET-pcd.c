/* Generated by CIL v. 1.7.3 */
/* print_CIL_Input is true */

#line 40 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef int __int32_t;
#line 133 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __dev_t;
#line 134 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __uid_t;
#line 135 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __gid_t;
#line 136 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __ino_t;
#line 138 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __mode_t;
#line 139 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned long __nlink_t;
#line 140 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off_t;
#line 141 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __off64_t;
#line 148 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __time_t;
#line 162 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blksize_t;
#line 167 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __blkcnt_t;
#line 181 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __ssize_t;
#line 184 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef long __syscall_slong_t;
#line 198 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef unsigned int __socklen_t;
#line 220 "/usr/include/unistd.h"
typedef __ssize_t ssize_t;
#line 213 "/usr/lib/gcc/x86_64-linux-gnu/4.7/include/stddef.h"
typedef unsigned long size_t;
#line 274 "/usr/include/unistd.h"
typedef __socklen_t socklen_t;
#line 28 "/usr/include/x86_64-linux-gnu/bits/sigset.h"
struct __anonstruct___sigset_t_5 {
   unsigned long __val[1024UL / (8UL * sizeof(unsigned long ))] ;
};
#line 28 "/usr/include/x86_64-linux-gnu/bits/sigset.h"
typedef struct __anonstruct___sigset_t_5 __sigset_t;
#line 120 "/usr/include/time.h"
struct timespec {
   __time_t tv_sec ;
   __syscall_slong_t tv_nsec ;
};
#line 297 "/usr/include/x86_64-linux-gnu/bits/siginfo.h"
union pthread_attr_t;
#line 297 "/usr/include/x86_64-linux-gnu/bits/siginfo.h"
typedef union pthread_attr_t pthread_attr_t;
#line 85 "/usr/include/signal.h"
typedef void (*__sighandler_t)(int  );
#line 60 "/usr/include/x86_64-linux-gnu/bits/pthreadtypes.h"
typedef unsigned long pthread_t;
#line 63 "/usr/include/x86_64-linux-gnu/bits/pthreadtypes.h"
union pthread_attr_t {
   char __size[56] ;
   long __align ;
};
#line 75 "/usr/include/x86_64-linux-gnu/bits/pthreadtypes.h"
struct __pthread_internal_list {
   struct __pthread_internal_list *__prev ;
   struct __pthread_internal_list *__next ;
};
#line 75 "/usr/include/x86_64-linux-gnu/bits/pthreadtypes.h"
typedef struct __pthread_internal_list __pthread_list_t;
#line 90 "/usr/include/x86_64-linux-gnu/bits/pthreadtypes.h"
struct __pthread_mutex_s {
   int __lock ;
   unsigned int __count ;
   int __owner ;
   unsigned int __nusers ;
   int __kind ;
   int __spins ;
   __pthread_list_t __list ;
};
#line 90 "/usr/include/x86_64-linux-gnu/bits/pthreadtypes.h"
union __anonunion_pthread_mutex_t_30 {
   struct __pthread_mutex_s __data ;
   char __size[40] ;
   long __align ;
};
#line 90 "/usr/include/x86_64-linux-gnu/bits/pthreadtypes.h"
typedef union __anonunion_pthread_mutex_t_30 pthread_mutex_t;
#line 75 "/usr/include/time.h"
typedef __time_t time_t;
#line 43 "/usr/include/x86_64-linux-gnu/bits/uio.h"
struct iovec {
   void *iov_base ;
   size_t iov_len ;
};
#line 28 "/usr/include/x86_64-linux-gnu/bits/sockaddr.h"
typedef unsigned short sa_family_t;
#line 147 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct sockaddr {
   sa_family_t sa_family ;
   char sa_data[14] ;
};
#line 222 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct msghdr {
   void *msg_name ;
   socklen_t msg_namelen ;
   struct iovec *msg_iov ;
   size_t msg_iovlen ;
   void *msg_control ;
   size_t msg_controllen ;
   int msg_flags ;
};
#line 240 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct cmsghdr {
   size_t cmsg_len ;
   int cmsg_level ;
   int cmsg_type ;
   unsigned char __cmsg_data[] ;
};
#line 377 "/usr/include/x86_64-linux-gnu/bits/socket.h"
struct linger {
   int l_onoff ;
   int l_linger ;
};
#line 49 "/usr/include/stdint.h"
typedef unsigned short uint16_t;
#line 51 "/usr/include/stdint.h"
typedef unsigned int uint32_t;
#line 96 "/usr/include/netinet/in.h"
typedef uint16_t in_port_t;
#line 140 "/usr/include/netinet/in.h"
typedef uint32_t in_addr_t;
#line 141 "/usr/include/netinet/in.h"
struct in_addr {
   in_addr_t s_addr ;
};
#line 224 "/usr/include/netinet/in.h"
struct sockaddr_in {
   sa_family_t sin_family ;
   in_port_t sin_port ;
   struct in_addr sin_addr ;
   unsigned char sin_zero[((sizeof(struct sockaddr ) - sizeof(unsigned short )) - sizeof(in_port_t )) - sizeof(struct in_addr )] ;
};
#line 44 "/usr/include/stdio.h"
struct _IO_FILE;
#line 48 "/usr/include/stdio.h"
typedef struct _IO_FILE FILE;
#line 40 "/usr/lib/gcc/x86_64-linux-gnu/4.7/include/stdarg.h"
typedef __builtin_va_list __gnuc_va_list;
#line 155 "/usr/include/libio.h"
typedef void _IO_lock_t;
#line 161 "/usr/include/libio.h"
struct _IO_marker {
   struct _IO_marker *_next ;
   struct _IO_FILE *_sbuf ;
   int _pos ;
};
#line 246 "/usr/include/libio.h"
struct _IO_FILE {
   int _flags ;
   char *_IO_read_ptr ;
   char *_IO_read_end ;
   char *_IO_read_base ;
   char *_IO_write_base ;
   char *_IO_write_ptr ;
   char *_IO_write_end ;
   char *_IO_buf_base ;
   char *_IO_buf_end ;
   char *_IO_save_base ;
   char *_IO_backup_base ;
   char *_IO_save_end ;
   struct _IO_marker *_markers ;
   struct _IO_FILE *_chain ;
   int _fileno ;
   int _flags2 ;
   __off_t _old_offset ;
   unsigned short _cur_column ;
   signed char _vtable_offset ;
   char _shortbuf[1] ;
   _IO_lock_t *_lock ;
   __off64_t _offset ;
   void *__pad1 ;
   void *__pad2 ;
   void *__pad3 ;
   void *__pad4 ;
   size_t __pad5 ;
   int _mode ;
   char _unused2[(15UL * sizeof(int ) - 4UL * sizeof(void *)) - sizeof(size_t )] ;
};
#line 316 "/usr/include/libio.h"
typedef struct _IO_FILE _IO_FILE;
#line 325 "/usr/lib/gcc/x86_64-linux-gnu/4.7/include/stddef.h"
typedef int wchar_t;
#line 22 "cpcd_datastructures.h"
struct hosts {
   char type ;
   unsigned char *addr ;
   unsigned long bdate ;
   struct hosts *next ;
   struct hosts *prev ;
};
#line 32 "cpcd_datastructures.h"
struct networks {
   char name[256] ;
   struct hosts *hosts ;
   struct hosts *bad_hosts ;
   unsigned int dirty ;
   struct networks *next ;
   struct networks *prev ;
};
#line 45 "cpcd_datastructures.h"
struct cpcd_config {
   char allowed_networks[256] ;
   char default_allow[256] ;
   char default_network[256] ;
   char cpcd_version[50] ;
   char server_url[256] ;
   char data_dir[256] ;
   char log_file[256] ;
   char pid_file[256] ;
   int cpcd_keep_log ;
   int cpcd_throttle_support ;
   int max_bad_urls ;
   int max_hosts ;
   int max_urls ;
   int max_nets ;
   int listen_threads ;
   int host_threads ;
   int port_restriction ;
   unsigned char bind_ip[16] ;
   unsigned char web_bind_port[10] ;
   unsigned char gnutella_bind_port[10] ;
};
#line 76
struct queue;
#line 76 "cpcd_datastructures.h"
struct cpcd_ctx {
   struct cpcd_config *config ;
   struct networks *networks ;
   struct hosts *bad_caches ;
   unsigned long total_hits ;
   unsigned long updts ;
   unsigned long reqs ;
   int exit_flag ;
   int verbose ;
   struct queue *host_queue ;
   struct queue *url_queue ;
   FILE *log ;
};
#line 95 "cpcd_datastructures.h"
struct queue {
   char *data ;
   char *net_name ;
   struct queue *next ;
};
#line 46 "/usr/include/x86_64-linux-gnu/bits/stat.h"
struct stat {
   __dev_t st_dev ;
   __ino_t st_ino ;
   __nlink_t st_nlink ;
   __mode_t st_mode ;
   __uid_t st_uid ;
   __gid_t st_gid ;
   int __pad0 ;
   __dev_t st_rdev ;
   __off_t st_size ;
   __blksize_t st_blksize ;
   __blkcnt_t st_blocks ;
   struct timespec st_atim ;
   struct timespec st_mtim ;
   struct timespec st_ctim ;
   __syscall_slong_t __unused[3] ;
};
#line 36 "/usr/include/x86_64-linux-gnu/sys/poll.h"
typedef unsigned long nfds_t;
#line 39 "/usr/include/x86_64-linux-gnu/sys/poll.h"
struct pollfd {
   int fd ;
   short events ;
   short revents ;
};
#line 27 "datastructures.h"
struct name_value_pair_dllst {
   unsigned char *name ;
   unsigned char *value ;
   struct name_value_pair_dllst *prev ;
   struct name_value_pair_dllst *next ;
};
#line 142 "/usr/include/x86_64-linux-gnu/bits/types.h"
typedef int __pid_t;
#line 260 "/usr/include/unistd.h"
typedef __pid_t pid_t;
#line 100 "/usr/include/netdb.h"
struct hostent {
   char *h_name ;
   char **h_aliases ;
   int h_addrtype ;
   int h_length ;
   char **h_addr_list ;
};
#line 133 "/usr/include/time.h"
struct tm {
   int tm_sec ;
   int tm_min ;
   int tm_hour ;
   int tm_mday ;
   int tm_mon ;
   int tm_year ;
   int tm_wday ;
   int tm_yday ;
   int tm_isdst ;
   long tm_gmtoff ;
   char const   *tm_zone ;
};
/* compiler builtin: 
   int __builtin_strcmp(char const   * , char const   * ) ;  */
/* compiler builtin: 
   void *__builtin___memmove_chk(void * , void const   * , unsigned long  , unsigned long  ) ;  */
/* compiler builtin: 
   char *__builtin_strchr(char * , int  ) ;  */
/* compiler builtin: 
   void *__builtin___memcpy_chk(void * , void const   * , unsigned long  , unsigned long  ) ;  */
/* compiler builtin: 
   int __builtin___vsprintf_chk(char * , int  , unsigned long  , char const   * ,
                                __builtin_va_list  ) ;  */
/* compiler builtin: 
   char *__builtin___strncpy_chk(char * , char const   * , unsigned long  , unsigned long  ) ;  */
/* compiler builtin: 
   char *__builtin___strcat_chk(char * , char const   * , unsigned long  ) ;  */
/* compiler builtin: 
   unsigned long __builtin_strlen(char const   * ) ;  */
/* compiler builtin: 
   unsigned long __builtin_object_size(void * , int  ) ;  */
/* compiler builtin: 
   int __builtin___sprintf_chk(char * , int  , unsigned long  , char const   *  , ...) ;  */
/* compiler builtin: 
   int __builtin___snprintf_chk(char * , unsigned long  , int  , unsigned long  ,
                                char const   *  , ...) ;  */
/* compiler builtin: 
   int __builtin___vsnprintf_chk(char * , unsigned long  , int  , unsigned long  ,
                                 char const   * , __builtin_va_list  ) ;  */
/* compiler builtin: 
   char *__builtin___strcpy_chk(char * , char const   * , unsigned long  ) ;  */
/* compiler builtin: 
   int __builtin_va_arg_pack_len(void) ;  */
/* compiler builtin: 
   void *__builtin___memset_chk(void * , int  , unsigned long  , unsigned long  ) ;  */
/* compiler builtin: 
   char *__builtin___strncat_chk(char * , char const   * , unsigned long  , unsigned long  ) ;  */
/* compiler builtin: 
   long __builtin_expect(long  , long  ) ;  */
/* compiler builtin: 
   int __builtin_va_arg_pack(void) ;  */
#line 1 "cpcd-cpcd.o"
#pragma merger("0","/tmp/cil-kWnvb26S.i","-g,-O2,-Wall,-g,-O2")
#line 353 "/usr/include/unistd.h"
extern int close(int __fd ) ;
#line 360
__inline extern ssize_t ( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) read)(int __fd ,
                                                                                                           void *__buf ,
                                                                                                           size_t __nbytes ) ;
#line 444
extern unsigned int sleep(unsigned int __seconds ) ;
#line 469
extern int pause(void) ;
#line 511
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__, __artificial__, __always_inline__)) getcwd)(char *__buf , size_t __size ) ;
#line 525
__inline extern  __attribute__((__nothrow__)) char __attribute__((__deprecated__))  *( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__, __artificial__, __always_inline__)) getwd)(char *__buf )  __attribute__((__deprecated__)) ;
#line 623
__inline extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__, __artificial__,
__always_inline__)) confstr)(int __name , char *__buf , size_t __len ) ;
#line 700
extern  __attribute__((__nothrow__)) __uid_t ( __attribute__((__leaf__)) geteuid)(void) ;
#line 711
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__, __artificial__, __always_inline__)) getgroups)(int __size , __gid_t *__list ) ;
#line 796
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(2), __leaf__, __artificial__, __always_inline__)) ttyname_r)(int __fd ,
                                                                         char *__buf ,
                                                                         size_t __buflen ) ;
#line 831
__inline extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(1,2), __leaf__, __artificial__, __always_inline__)) readlink)(char const   * __restrict  __path ,
                                                                          char * __restrict  __buf ,
                                                                          size_t __len ) ;
#line 842
__inline extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(2,3), __leaf__, __artificial__, __always_inline__)) readlinkat)(int __fd ,
                                                                            char const   * __restrict  __path ,
                                                                            char * __restrict  __buf ,
                                                                            size_t __len ) ;
#line 879
__inline extern int ( __attribute__((__nonnull__(1), __artificial__, __always_inline__)) getlogin_r)(char *__buf ,
                                                                                                     size_t __buflen ) ;
#line 901
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1),
__leaf__, __artificial__, __always_inline__)) gethostname)(char *__buf , size_t __buflen ) ;
#line 919
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__, __artificial__, __always_inline__)) getdomainname)(char *__buf ,
                                                                             size_t __buflen ) ;
#line 23 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
extern ssize_t ( __attribute__((__warn_unused_result__)) __read_chk)(int __fd , void *__buf ,
                                                                     size_t __nbytes ,
                                                                     size_t __buflen ) ;
#line 25
extern ssize_t ( __attribute__((__warn_unused_result__)) __read_alias)(int __fd ,
                                                                       void *__buf ,
                                                                       size_t __nbytes )  __asm__("read")  ;
#line 27
extern ssize_t ( __attribute__((__warn_unused_result__)) __read_chk_warn)(int __fd ,
                                                                          void *__buf ,
                                                                          size_t __nbytes ,
                                                                          size_t __buflen )  __asm__("__read_chk") __attribute__((__warning__("read called with bigger length than size of the destination buffer"))) ;
#line 33 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern ssize_t ( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) read)(int __fd ,
                                                                                                           void *__buf ,
                                                                                                           size_t __nbytes ) 
{ 
  unsigned long tmp ;
  ssize_t tmp___0 ;
  unsigned long tmp___1 ;
  ssize_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  ssize_t tmp___5 ;

  {
#line 36
  tmp___4 = __builtin_object_size(__buf, 0);
#line 36
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 39
    tmp = __builtin_object_size(__buf, 0);
#line 39
    tmp___0 = __read_chk(__fd, __buf, __nbytes, tmp);
#line 39
    return (tmp___0);
#line 41
    tmp___3 = __builtin_object_size(__buf, 0);
#line 41
    if (__nbytes > tmp___3) {
#line 42
      tmp___1 = __builtin_object_size(__buf, 0);
#line 42
      tmp___2 = __read_chk_warn(__fd, __buf, __nbytes, tmp___1);
#line 42
      return (tmp___2);
    }
  }
#line 44
  tmp___5 = __read_alias(__fd, __buf, __nbytes);
#line 44
  return (tmp___5);
}
}
#line 123
extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(1,2), __leaf__)) __readlink_chk)(char const   * __restrict  __path , char * __restrict  __buf ,
                                             size_t __len , size_t __buflen ) ;
#line 127
extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(1,2), __leaf__)) __readlink_alias)(char const   * __restrict  __path ,
                                               char * __restrict  __buf , size_t __len )  __asm__("readlink")  ;
#line 131
extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(1,2), __leaf__)) __readlink_chk_warn)(char const   * __restrict  __path ,
                                                  char * __restrict  __buf , size_t __len ,
                                                  size_t __buflen )  __asm__("__readlink_chk") __attribute__((__warning__("readlink called with bigger length than size of destination buffer"))) ;
#line 138
__inline extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(1,2), __leaf__, __artificial__, __always_inline__)) readlink)(char const   * __restrict  __path ,
                                                                          char * __restrict  __buf ,
                                                                          size_t __len ) ;
#line 138 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern ssize_t ( __attribute__((__warn_unused_result__, __nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) readlink)(char const   * __restrict  __path ,
                                                        char * __restrict  __buf ,
                                                        size_t __len ) 
{ 
  unsigned long tmp ;
  ssize_t tmp___0 ;
  unsigned long tmp___1 ;
  ssize_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  ssize_t tmp___5 ;

  {
#line 142
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 142
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 145
    tmp = __builtin_object_size((void *)__buf, 1);
#line 145
    tmp___0 = __readlink_chk(__path, __buf, __len, tmp);
#line 145
    return (tmp___0);
#line 147
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 147
    if (__len > tmp___3) {
#line 148
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 148
      tmp___2 = __readlink_chk_warn(__path, __buf, __len, tmp___1);
#line 148
      return (tmp___2);
    }
  }
#line 150
  tmp___5 = __readlink_alias(__path, __buf, __len);
#line 150
  return (tmp___5);
}
}
#line 155
extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(2,3), __leaf__)) __readlinkat_chk)(int __fd , char const   * __restrict  __path ,
                                               char * __restrict  __buf , size_t __len ,
                                               size_t __buflen ) ;
#line 159
extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(2,3), __leaf__)) __readlinkat_alias)(int __fd , char const   * __restrict  __path ,
                                                 char * __restrict  __buf , size_t __len )  __asm__("readlinkat")  ;
#line 164
extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(2,3), __leaf__)) __readlinkat_chk_warn)(int __fd , char const   * __restrict  __path ,
                                                    char * __restrict  __buf , size_t __len ,
                                                    size_t __buflen )  __asm__("__readlinkat_chk") __attribute__((__warning__("readlinkat called with bigger length than size of destination buffer"))) ;
#line 172
__inline extern  __attribute__((__nothrow__)) ssize_t ( __attribute__((__warn_unused_result__,
__nonnull__(2,3), __leaf__, __artificial__, __always_inline__)) readlinkat)(int __fd ,
                                                                            char const   * __restrict  __path ,
                                                                            char * __restrict  __buf ,
                                                                            size_t __len ) ;
#line 172 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern ssize_t ( __attribute__((__warn_unused_result__, __nonnull__(2,3),
__leaf__, __artificial__, __always_inline__)) readlinkat)(int __fd , char const   * __restrict  __path ,
                                                          char * __restrict  __buf ,
                                                          size_t __len ) 
{ 
  unsigned long tmp ;
  ssize_t tmp___0 ;
  unsigned long tmp___1 ;
  ssize_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  ssize_t tmp___5 ;

  {
#line 176
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 176
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 179
    tmp = __builtin_object_size((void *)__buf, 1);
#line 179
    tmp___0 = __readlinkat_chk(__fd, __path, __buf, __len, tmp);
#line 179
    return (tmp___0);
#line 181
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 181
    if (__len > tmp___3) {
#line 182
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 182
      tmp___2 = __readlinkat_chk_warn(__fd, __path, __buf, __len, tmp___1);
#line 182
      return (tmp___2);
    }
  }
#line 185
  tmp___5 = __readlinkat_alias(__fd, __path, __buf, __len);
#line 185
  return (tmp___5);
}
}
#line 189
extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__)) __getcwd_chk)(char *__buf , size_t __size , size_t __buflen ) ;
#line 191
extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__)) __getcwd_alias)(char *__buf , size_t __size )  __asm__("getcwd")  ;
#line 193
extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__)) __getcwd_chk_warn)(char *__buf , size_t __size , size_t __buflen )  __asm__("__getcwd_chk") __attribute__((__warning__("getcwd caller with bigger length than size of destination buffer"))) ;
#line 199
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__, __artificial__, __always_inline__)) getcwd)(char *__buf , size_t __size ) ;
#line 199 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern char *( __attribute__((__warn_unused_result__, __leaf__, __artificial__,
__always_inline__)) getcwd)(char *__buf , size_t __size ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;
  unsigned long tmp___1 ;
  char *tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  char *tmp___5 ;

  {
#line 202
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 202
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 205
    tmp = __builtin_object_size((void *)__buf, 1);
#line 205
    tmp___0 = __getcwd_chk(__buf, __size, tmp);
#line 205
    return (tmp___0);
#line 207
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 207
    if (__size > tmp___3) {
#line 208
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 208
      tmp___2 = __getcwd_chk_warn(__buf, __size, tmp___1);
#line 208
      return (tmp___2);
    }
  }
#line 210
  tmp___5 = __getcwd_alias(__buf, __size);
#line 210
  return (tmp___5);
}
}
#line 214
extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) __getwd_chk)(char *__buf , size_t buflen ) ;
#line 216
extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) __getwd_warn)(char *__buf )  __asm__("getwd") __attribute__((__warning__("please use getcwd instead, as getwd doesn\'t specify buffer size"))) ;
#line 220
__inline extern  __attribute__((__nothrow__)) char __attribute__((__deprecated__))  *( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__, __artificial__, __always_inline__)) getwd)(char *__buf )  __attribute__((__deprecated__)) ;
#line 220 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern char __attribute__((__deprecated__))  *( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__, __artificial__, __always_inline__)) getwd)(char *__buf ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;
  unsigned long tmp___1 ;
  char *tmp___2 ;

  {
#line 223
  tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 223
  if (tmp___1 != 0xffffffffffffffffUL) {
#line 224
    tmp = __builtin_object_size((void *)__buf, 1);
#line 224
    tmp___0 = __getwd_chk(__buf, tmp);
#line 224
    return ((char __attribute__((__deprecated__))  *)tmp___0);
  }
#line 225
  tmp___2 = __getwd_warn(__buf);
#line 225
  return ((char __attribute__((__deprecated__))  *)tmp___2);
}
}
#line 229
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __confstr_chk)(int __name ,
                                                                                       char *__buf ,
                                                                                       size_t __len ,
                                                                                       size_t __buflen ) ;
#line 231
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __confstr_alias)(int __name ,
                                                                                         char *__buf ,
                                                                                         size_t __len )  __asm__("confstr")  ;
#line 233
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __confstr_chk_warn)(int __name ,
                                                                                            char *__buf ,
                                                                                            size_t __len ,
                                                                                            size_t __buflen )  __asm__("__confstr_chk") __attribute__((__warning__("confstr called with bigger length than size of destination buffer"))) ;
#line 239
__inline extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__, __artificial__,
__always_inline__)) confstr)(int __name , char *__buf , size_t __len ) ;
#line 239 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern size_t ( __attribute__((__leaf__, __artificial__, __always_inline__)) confstr)(int __name ,
                                                                                               char *__buf ,
                                                                                               size_t __len ) 
{ 
  unsigned long tmp ;
  size_t tmp___0 ;
  unsigned long tmp___1 ;
  size_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  size_t tmp___5 ;

  {
#line 242
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 242
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 245
    tmp = __builtin_object_size((void *)__buf, 1);
#line 245
    tmp___0 = __confstr_chk(__name, __buf, __len, tmp);
#line 245
    return (tmp___0);
#line 247
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 247
    if (tmp___3 < __len) {
#line 248
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 248
      tmp___2 = __confstr_chk_warn(__name, __buf, __len, tmp___1);
#line 248
      return (tmp___2);
    }
  }
#line 250
  tmp___5 = __confstr_alias(__name, __buf, __len);
#line 250
  return (tmp___5);
}
}
#line 254
extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) __getgroups_chk)(int __size , __gid_t *__list , size_t __listlen ) ;
#line 256
extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) __getgroups_alias)(int __size , __gid_t *__list )  __asm__("getgroups")  ;
#line 258
extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) __getgroups_chk_warn)(int __size , __gid_t *__list , size_t __listlen )  __asm__("__getgroups_chk") __attribute__((__warning__("getgroups called with bigger group count than what can fit into destination buffer"))) ;
#line 264
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__, __artificial__, __always_inline__)) getgroups)(int __size , __gid_t *__list ) ;
#line 264 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern int ( __attribute__((__warn_unused_result__, __leaf__, __artificial__,
__always_inline__)) getgroups)(int __size , __gid_t *__list ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;
  unsigned long tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  int tmp___5 ;

  {
#line 267
  tmp___4 = __builtin_object_size((void *)__list, 1);
#line 267
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 270
    tmp = __builtin_object_size((void *)__list, 1);
#line 270
    tmp___0 = __getgroups_chk(__size, __list, tmp);
#line 270
    return (tmp___0);
#line 272
    tmp___3 = __builtin_object_size((void *)__list, 1);
#line 272
    if ((unsigned long )__size * sizeof(__gid_t ) > tmp___3) {
#line 273
      tmp___1 = __builtin_object_size((void *)__list, 1);
#line 273
      tmp___2 = __getgroups_chk_warn(__size, __list, tmp___1);
#line 273
      return (tmp___2);
    }
  }
#line 275
  tmp___5 = __getgroups_alias(__size, __list);
#line 275
  return (tmp___5);
}
}
#line 279
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2), __leaf__)) __ttyname_r_chk)(int __fd ,
                                                                                                      char *__buf ,
                                                                                                      size_t __buflen ,
                                                                                                      size_t __nreal ) ;
#line 281
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2), __leaf__)) __ttyname_r_alias)(int __fd ,
                                                                                                        char *__buf ,
                                                                                                        size_t __buflen )  __asm__("ttyname_r")  ;
#line 284
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2), __leaf__)) __ttyname_r_chk_warn)(int __fd ,
                                                                                                           char *__buf ,
                                                                                                           size_t __buflen ,
                                                                                                           size_t __nreal )  __asm__("__ttyname_r_chk") __attribute__((__warning__("ttyname_r called with bigger buflen than size of destination buffer"))) ;
#line 290
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(2), __leaf__, __artificial__, __always_inline__)) ttyname_r)(int __fd ,
                                                                         char *__buf ,
                                                                         size_t __buflen ) ;
#line 290 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern int ( __attribute__((__warn_unused_result__, __nonnull__(2), __leaf__,
__artificial__, __always_inline__)) ttyname_r)(int __fd , char *__buf , size_t __buflen ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;
  unsigned long tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  int tmp___5 ;

  {
#line 293
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 293
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 296
    tmp = __builtin_object_size((void *)__buf, 1);
#line 296
    tmp___0 = __ttyname_r_chk(__fd, __buf, __buflen, tmp);
#line 296
    return (tmp___0);
#line 298
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 298
    if (__buflen > tmp___3) {
#line 299
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 299
      tmp___2 = __ttyname_r_chk_warn(__fd, __buf, __buflen, tmp___1);
#line 299
      return (tmp___2);
    }
  }
#line 301
  tmp___5 = __ttyname_r_alias(__fd, __buf, __buflen);
#line 301
  return (tmp___5);
}
}
#line 306
extern int ( __attribute__((__nonnull__(1))) __getlogin_r_chk)(char *__buf , size_t __buflen ,
                                                               size_t __nreal ) ;
#line 308
extern int ( __attribute__((__nonnull__(1))) __getlogin_r_alias)(char *__buf , size_t __buflen )  __asm__("getlogin_r")  ;
#line 310
extern int ( __attribute__((__nonnull__(1))) __getlogin_r_chk_warn)(char *__buf ,
                                                                    size_t __buflen ,
                                                                    size_t __nreal )  __asm__("__getlogin_r_chk") __attribute__((__warning__("getlogin_r called with bigger buflen than size of destination buffer"))) ;
#line 316 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern int ( __attribute__((__nonnull__(1), __artificial__, __always_inline__)) getlogin_r)(char *__buf ,
                                                                                                     size_t __buflen ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;
  unsigned long tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  int tmp___5 ;

  {
#line 319
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 319
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 322
    tmp = __builtin_object_size((void *)__buf, 1);
#line 322
    tmp___0 = __getlogin_r_chk(__buf, __buflen, tmp);
#line 322
    return (tmp___0);
#line 324
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 324
    if (__buflen > tmp___3) {
#line 325
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 325
      tmp___2 = __getlogin_r_chk_warn(__buf, __buflen, tmp___1);
#line 325
      return (tmp___2);
    }
  }
#line 327
  tmp___5 = __getlogin_r_alias(__buf, __buflen);
#line 327
  return (tmp___5);
}
}
#line 333
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) __gethostname_chk)(char *__buf ,
                                                                                                        size_t __buflen ,
                                                                                                        size_t __nreal ) ;
#line 335
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) __gethostname_alias)(char *__buf ,
                                                                                                          size_t __buflen )  __asm__("gethostname")  ;
#line 337
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1), __leaf__)) __gethostname_chk_warn)(char *__buf ,
                                                                                                             size_t __buflen ,
                                                                                                             size_t __nreal )  __asm__("__gethostname_chk") __attribute__((__warning__("gethostname called with bigger buflen than size of destination buffer"))) ;
#line 343
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1),
__leaf__, __artificial__, __always_inline__)) gethostname)(char *__buf , size_t __buflen ) ;
#line 343 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern int ( __attribute__((__nonnull__(1), __leaf__, __artificial__, __always_inline__)) gethostname)(char *__buf ,
                                                                                                                size_t __buflen ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;
  unsigned long tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  int tmp___5 ;

  {
#line 346
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 346
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 349
    tmp = __builtin_object_size((void *)__buf, 1);
#line 349
    tmp___0 = __gethostname_chk(__buf, __buflen, tmp);
#line 349
    return (tmp___0);
#line 351
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 351
    if (__buflen > tmp___3) {
#line 352
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 352
      tmp___2 = __gethostname_chk_warn(__buf, __buflen, tmp___1);
#line 352
      return (tmp___2);
    }
  }
#line 354
  tmp___5 = __gethostname_alias(__buf, __buflen);
#line 354
  return (tmp___5);
}
}
#line 360
extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) __getdomainname_chk)(char *__buf , size_t __buflen , size_t __nreal ) ;
#line 362
extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) __getdomainname_alias)(char *__buf , size_t __buflen )  __asm__("getdomainname")  ;
#line 365
extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) __getdomainname_chk_warn)(char *__buf , size_t __buflen ,
                                                     size_t __nreal )  __asm__("__getdomainname_chk") __attribute__((__warning__("getdomainname called with bigger buflen than size of destination buffer"))) ;
#line 372
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__, __artificial__, __always_inline__)) getdomainname)(char *__buf ,
                                                                             size_t __buflen ) ;
#line 372 "/usr/include/x86_64-linux-gnu/bits/unistd.h"
__inline extern int ( __attribute__((__warn_unused_result__, __nonnull__(1), __leaf__,
__artificial__, __always_inline__)) getdomainname)(char *__buf , size_t __buflen ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;
  unsigned long tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  int tmp___5 ;

  {
#line 375
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 375
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 378
    tmp = __builtin_object_size((void *)__buf, 1);
#line 378
    tmp___0 = __getdomainname_chk(__buf, __buflen, tmp);
#line 378
    return (tmp___0);
#line 380
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 380
    if (__buflen > tmp___3) {
#line 381
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 381
      tmp___2 = __getdomainname_chk_warn(__buf, __buflen, tmp___1);
#line 381
      return (tmp___2);
    }
  }
#line 383
  tmp___5 = __getdomainname_alias(__buf, __buflen);
#line 383
  return (tmp___5);
}
}
#line 103 "/usr/include/x86_64-linux-gnu/bits/sigset.h"
__inline extern int __sigismember(__sigset_t const   *__set , int __sig ) ;
#line 104
__inline extern int __sigaddset(__sigset_t *__set , int __sig ) ;
#line 105
__inline extern int __sigdelset(__sigset_t *__set , int __sig ) ;
#line 117 "/usr/include/x86_64-linux-gnu/bits/sigset.h"
__inline extern int __sigismember(__sigset_t const   *__set , int __sig ) 
{ 
  unsigned long __mask ;
  unsigned long __word ;
  int tmp ;

  {
#line 117
  __mask = 1UL << (unsigned long )(__sig - 1) % (8UL * sizeof(unsigned long ));
#line 117
  __word = (unsigned long )(__sig - 1) / (8UL * sizeof(unsigned long ));
#line 117
  if (__set->__val[__word] & __mask) {
#line 117
    tmp = 1;
  } else {
#line 117
    tmp = 0;
  }
#line 117
  return (tmp);
}
}
#line 118 "/usr/include/x86_64-linux-gnu/bits/sigset.h"
__inline extern int __sigaddset(__sigset_t *__set , int __sig ) 
{ 
  unsigned long __mask ;
  unsigned long __word ;

  {
#line 118
  __mask = 1UL << (unsigned long )(__sig - 1) % (8UL * sizeof(unsigned long ));
#line 118
  __word = (unsigned long )(__sig - 1) / (8UL * sizeof(unsigned long ));
#line 118
  __set->__val[__word] |= __mask;
#line 118
  return (0);
}
}
#line 119 "/usr/include/x86_64-linux-gnu/bits/sigset.h"
__inline extern int __sigdelset(__sigset_t *__set , int __sig ) 
{ 
  unsigned long __mask ;
  unsigned long __word ;

  {
#line 119
  __mask = 1UL << (unsigned long )(__sig - 1) % (8UL * sizeof(unsigned long ));
#line 119
  __word = (unsigned long )(__sig - 1) / (8UL * sizeof(unsigned long ));
#line 119
  __set->__val[__word] &= ~ __mask;
#line 119
  return (0);
}
}
#line 102 "/usr/include/signal.h"
extern  __attribute__((__nothrow__)) __sighandler_t ( __attribute__((__leaf__)) signal)(int __sig ,
                                                                                        void (*__handler)(int  ) ) ;
#line 32 "/usr/include/x86_64-linux-gnu/sys/sysmacros.h"
__inline extern  __attribute__((__nothrow__)) unsigned int ( __attribute__((__leaf__)) gnu_dev_major)(unsigned long long __dev )  __attribute__((__const__)) ;
#line 35
__inline extern  __attribute__((__nothrow__)) unsigned int ( __attribute__((__leaf__)) gnu_dev_minor)(unsigned long long __dev )  __attribute__((__const__)) ;
#line 38
__inline extern  __attribute__((__nothrow__)) unsigned long long ( __attribute__((__leaf__)) gnu_dev_makedev)(unsigned int __major ,
                                                                                                              unsigned int __minor )  __attribute__((__const__)) ;
#line 43
__inline extern  __attribute__((__nothrow__)) unsigned int ( __attribute__((__leaf__)) gnu_dev_major)(unsigned long long __dev )  __attribute__((__const__)) ;
#line 43 "/usr/include/x86_64-linux-gnu/sys/sysmacros.h"
__inline extern unsigned int ( __attribute__((__leaf__)) gnu_dev_major)(unsigned long long __dev ) 
{ 


  {
#line 46
  return ((unsigned int )(((__dev >> 8) & 4095ULL) | (unsigned long long )((unsigned int )(__dev >> 32) & 4294963200U)));
}
}
#line 49
__inline extern  __attribute__((__nothrow__)) unsigned int ( __attribute__((__leaf__)) gnu_dev_minor)(unsigned long long __dev )  __attribute__((__const__)) ;
#line 49 "/usr/include/x86_64-linux-gnu/sys/sysmacros.h"
__inline extern unsigned int ( __attribute__((__leaf__)) gnu_dev_minor)(unsigned long long __dev ) 
{ 


  {
#line 52
  return ((unsigned int )((__dev & 255ULL) | (unsigned long long )((unsigned int )(__dev >> 12) & 4294967040U)));
}
}
#line 55
__inline extern  __attribute__((__nothrow__)) unsigned long long ( __attribute__((__leaf__)) gnu_dev_makedev)(unsigned int __major ,
                                                                                                              unsigned int __minor )  __attribute__((__const__)) ;
#line 55 "/usr/include/x86_64-linux-gnu/sys/sysmacros.h"
__inline extern unsigned long long ( __attribute__((__leaf__)) gnu_dev_makedev)(unsigned int __major ,
                                                                                unsigned int __minor ) 
{ 


  {
#line 58
  return (((unsigned long long )((__minor & 255U) | ((__major & 4095U) << 8)) | ((unsigned long long )(__minor & 4294967040U) << 12)) | ((unsigned long long )(__major & 4294963200U) << 32));
}
}
#line 270 "/usr/include/x86_64-linux-gnu/bits/socket.h"
__inline extern  __attribute__((__nothrow__)) struct cmsghdr *( __attribute__((__leaf__)) __cmsg_nxthdr)(struct msghdr *__mhdr ,
                                                                                                         struct cmsghdr *__cmsg ) ;
#line 276
__inline extern  __attribute__((__nothrow__)) struct cmsghdr *( __attribute__((__leaf__)) __cmsg_nxthdr)(struct msghdr *__mhdr ,
                                                                                                         struct cmsghdr *__cmsg ) ;
#line 276 "/usr/include/x86_64-linux-gnu/bits/socket.h"
__inline extern struct cmsghdr *( __attribute__((__leaf__)) __cmsg_nxthdr)(struct msghdr *__mhdr ,
                                                                           struct cmsghdr *__cmsg ) 
{ 


  {
#line 279
  if (__cmsg->cmsg_len < sizeof(struct cmsghdr )) {
#line 281
    return ((struct cmsghdr *)0);
  }
#line 283
  __cmsg = (struct cmsghdr *)((unsigned char *)__cmsg + (((__cmsg->cmsg_len + sizeof(size_t )) - 1UL) & ~ (sizeof(size_t ) - 1UL)));
#line 285
  if ((unsigned long )((unsigned char *)(__cmsg + 1)) > (unsigned long )((unsigned char *)__mhdr->msg_control + __mhdr->msg_controllen)) {
#line 290
    return ((struct cmsghdr *)0);
  } else
#line 285
  if ((unsigned long )((unsigned char *)__cmsg + (((__cmsg->cmsg_len + sizeof(size_t )) - 1UL) & ~ (sizeof(size_t ) - 1UL))) > (unsigned long )((unsigned char *)__mhdr->msg_control + __mhdr->msg_controllen)) {
#line 290
    return ((struct cmsghdr *)0);
  }
#line 291
  return (__cmsg);
}
}
#line 114 "/usr/include/x86_64-linux-gnu/sys/socket.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) socket)(int __domain ,
                                                                             int __type ,
                                                                             int __protocol ) ;
#line 124
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) bind)(int __fd ,
                                                                           struct sockaddr  const  *__addr ,
                                                                           socklen_t __len ) ;
#line 142
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) getpeername)(int __fd ,
                                                                                  struct sockaddr * __restrict  __addr ,
                                                                                  socklen_t * __restrict  __len ) ;
#line 157
__inline extern ssize_t ( __attribute__((__artificial__, __always_inline__)) recv)(int __fd ,
                                                                                   void *__buf ,
                                                                                   size_t __n ,
                                                                                   int __flags ) ;
#line 175
__inline extern ssize_t ( __attribute__((__artificial__, __always_inline__)) recvfrom)(int __fd ,
                                                                                       void * __restrict  __buf ,
                                                                                       size_t __n ,
                                                                                       int __flags ,
                                                                                       struct sockaddr * __restrict  __addr ,
                                                                                       socklen_t * __restrict  __addr_len ) ;
#line 227
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) setsockopt)(int __fd ,
                                                                                 int __level ,
                                                                                 int __optname ,
                                                                                 void const   *__optval ,
                                                                                 socklen_t __optlen ) ;
#line 234
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) listen)(int __fd ,
                                                                             int __n ) ;
#line 244
extern int accept(int __fd , struct sockaddr * __restrict  __addr , socklen_t * __restrict  __addr_len ) ;
#line 262
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) shutdown)(int __fd ,
                                                                               int __how ) ;
#line 23 "/usr/include/x86_64-linux-gnu/bits/socket2.h"
extern ssize_t __recv_chk(int __fd , void *__buf , size_t __n , size_t __buflen ,
                          int __flags ) ;
#line 25
extern ssize_t __recv_alias(int __fd , void *__buf , size_t __n , int __flags )  __asm__("recv")  ;
#line 27
extern ssize_t __recv_chk_warn(int __fd , void *__buf , size_t __n , size_t __buflen ,
                               int __flags )  __asm__("__recv_chk") __attribute__((__warning__("recv called with bigger length than size of destination buffer"))) ;
#line 33 "/usr/include/x86_64-linux-gnu/bits/socket2.h"
__inline extern ssize_t ( __attribute__((__artificial__, __always_inline__)) recv)(int __fd ,
                                                                                   void *__buf ,
                                                                                   size_t __n ,
                                                                                   int __flags ) 
{ 
  unsigned long tmp ;
  ssize_t tmp___0 ;
  unsigned long tmp___1 ;
  ssize_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  ssize_t tmp___5 ;

  {
#line 36
  tmp___4 = __builtin_object_size(__buf, 0);
#line 36
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 39
    tmp = __builtin_object_size(__buf, 0);
#line 39
    tmp___0 = __recv_chk(__fd, __buf, __n, tmp, __flags);
#line 39
    return (tmp___0);
#line 41
    tmp___3 = __builtin_object_size(__buf, 0);
#line 41
    if (__n > tmp___3) {
#line 42
      tmp___1 = __builtin_object_size(__buf, 0);
#line 42
      tmp___2 = __recv_chk_warn(__fd, __buf, __n, tmp___1, __flags);
#line 42
      return (tmp___2);
    }
  }
#line 44
  tmp___5 = __recv_alias(__fd, __buf, __n, __flags);
#line 44
  return (tmp___5);
}
}
#line 47
extern ssize_t __recvfrom_chk(int __fd , void * __restrict  __buf , size_t __n , size_t __buflen ,
                              int __flags , struct sockaddr * __restrict  __addr ,
                              socklen_t * __restrict  __addr_len ) ;
#line 51
extern ssize_t __recvfrom_alias(int __fd , void * __restrict  __buf , size_t __n ,
                                int __flags , struct sockaddr * __restrict  __addr ,
                                socklen_t * __restrict  __addr_len )  __asm__("recvfrom")  ;
#line 55
extern ssize_t __recvfrom_chk_warn(int __fd , void * __restrict  __buf , size_t __n ,
                                   size_t __buflen , int __flags , struct sockaddr * __restrict  __addr ,
                                   socklen_t * __restrict  __addr_len )  __asm__("__recvfrom_chk") __attribute__((__warning__("recvfrom called with bigger length than size of destination buffer"))) ;
#line 63 "/usr/include/x86_64-linux-gnu/bits/socket2.h"
__inline extern ssize_t ( __attribute__((__artificial__, __always_inline__)) recvfrom)(int __fd ,
                                                                                       void * __restrict  __buf ,
                                                                                       size_t __n ,
                                                                                       int __flags ,
                                                                                       struct sockaddr * __restrict  __addr ,
                                                                                       socklen_t * __restrict  __addr_len ) 
{ 
  unsigned long tmp ;
  ssize_t tmp___0 ;
  unsigned long tmp___1 ;
  ssize_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  ssize_t tmp___5 ;

  {
#line 67
  tmp___4 = __builtin_object_size((void *)__buf, 0);
#line 67
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 70
    tmp = __builtin_object_size((void *)__buf, 0);
#line 70
    tmp___0 = __recvfrom_chk(__fd, __buf, __n, tmp, __flags, __addr, __addr_len);
#line 70
    return (tmp___0);
#line 72
    tmp___3 = __builtin_object_size((void *)__buf, 0);
#line 72
    if (__n > tmp___3) {
#line 73
      tmp___1 = __builtin_object_size((void *)__buf, 0);
#line 73
      tmp___2 = __recvfrom_chk_warn(__fd, __buf, __n, tmp___1, __flags, __addr, __addr_len);
#line 73
      return (tmp___2);
    }
  }
#line 76
  tmp___5 = __recvfrom_alias(__fd, __buf, __n, __flags, __addr, __addr_len);
#line 76
  return (tmp___5);
}
}
#line 34 "/usr/include/arpa/inet.h"
extern  __attribute__((__nothrow__)) in_addr_t ( __attribute__((__leaf__)) inet_addr)(char const   *__cp ) ;
#line 53
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) inet_ntoa)(struct in_addr __in ) ;
#line 192 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) time_t ( __attribute__((__leaf__)) time)(time_t *__timer ) ;
#line 392 "/usr/include/libio.h"
extern int __uflow(_IO_FILE * ) ;
#line 393
extern int __overflow(_IO_FILE * , int  ) ;
#line 435
extern int _IO_getc(_IO_FILE *__fp ) ;
#line 436
extern int _IO_putc(int __c , _IO_FILE *__fp ) ;
#line 168 "/usr/include/stdio.h"
extern struct _IO_FILE *stdin ;
#line 169
extern struct _IO_FILE *stdout ;
#line 170
extern struct _IO_FILE *stderr ;
#line 237
extern int fclose(FILE *__stream ) ;
#line 272
extern FILE *( __attribute__((__warn_unused_result__)) fopen)(char const   * __restrict  __filename ,
                                                              char const   * __restrict  __modes ) ;
#line 356
__inline extern int ( __attribute__((__artificial__, __always_inline__)) fprintf)(FILE * __restrict  __stream ,
                                                                                  char const   * __restrict  __fmt 
                                                                                  , ...) ;
#line 362
__inline extern int ( __attribute__((__artificial__, __always_inline__)) printf)(char const   * __restrict  __fmt 
                                                                                 , ...) ;
#line 364
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__, __artificial__,
__always_inline__)) sprintf)(char * __restrict  __s , char const   * __restrict  __fmt 
                             , ...) ;
#line 371
__inline extern int ( __attribute__((__artificial__, __always_inline__)) vfprintf)(FILE * __restrict  __stream ,
                                                                                   char const   * __restrict  __fmt ,
                                                                                   __gnuc_va_list __ap ) ;
#line 377
__inline extern int ( __attribute__((__artificial__, __always_inline__)) vprintf)(char const   * __restrict  __fmt ,
                                                                                  __gnuc_va_list __ap ) ;
#line 379
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__, __artificial__,
__always_inline__)) vsprintf)(char * __restrict  __s , char const   * __restrict  __fmt ,
                              __gnuc_va_list __ap ) ;
#line 386
__inline extern  __attribute__((__nothrow__)) int ( /* format attribute */ __attribute__((__leaf__,
__artificial__, __always_inline__)) snprintf)(char * __restrict  __s , size_t __n ,
                                              char const   * __restrict  __fmt  , ...) ;
#line 390
__inline extern  __attribute__((__nothrow__)) int ( /* format attribute */ __attribute__((__leaf__,
__artificial__, __always_inline__)) vsnprintf)(char * __restrict  __s , size_t __n ,
                                               char const   * __restrict  __fmt ,
                                               __gnuc_va_list __ap ) ;
#line 412
__inline extern int ( /* format attribute */ __attribute__((__artificial__, __always_inline__)) vdprintf)(int __fd ,
                                                                                                          char const   * __restrict  __fmt ,
                                                                                                          __gnuc_va_list __ap ) ;
#line 415
__inline extern int ( /* format attribute */ __attribute__((__artificial__, __always_inline__)) dprintf)(int __fd ,
                                                                                                         char const   * __restrict  __fmt 
                                                                                                         , ...) ;
#line 538
__inline extern int getchar(void) ;
#line 550
__inline extern int getc_unlocked(FILE *__fp ) ;
#line 551
__inline extern int getchar_unlocked(void) ;
#line 561
__inline extern int fgetc_unlocked(FILE *__fp ) ;
#line 580
__inline extern int putchar(int __c ) ;
#line 594
__inline extern int fputc_unlocked(int __c , FILE *__stream ) ;
#line 602
__inline extern int putc_unlocked(int __c , FILE *__stream ) ;
#line 603
__inline extern int putchar_unlocked(int __c ) ;
#line 622
__inline extern char *( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) fgets)(char * __restrict  __s ,
                                                                                                          int __n ,
                                                                                                          FILE * __restrict  __stream ) ;
#line 638
__inline extern char *( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) gets)(char *__str )  __attribute__((__deprecated__)) ;
#line 709
__inline extern size_t ( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) fread)(void * __restrict  __ptr ,
                                                                                                           size_t __size ,
                                                                                                           size_t __n ,
                                                                                                           FILE * __restrict  __stream ) ;
#line 737
__inline extern size_t ( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) fread_unlocked)(void * __restrict  __ptr ,
                                                                                                                    size_t __size ,
                                                                                                                    size_t __n ,
                                                                                                                    FILE * __restrict  __stream ) ;
#line 836
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) feof_unlocked)(FILE *__stream ) ;
#line 837
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) ferror_unlocked)(FILE *__stream ) ;
#line 43 "/usr/include/x86_64-linux-gnu/bits/stdio.h"
__inline extern int getchar(void) 
{ 
  int tmp ;

  {
#line 46
  tmp = _IO_getc(stdin);
#line 46
  return (tmp);
}
}
#line 52 "/usr/include/x86_64-linux-gnu/bits/stdio.h"
__inline extern int fgetc_unlocked(FILE *__fp ) 
{ 
  int tmp___0 ;
  char *tmp___1 ;
  int tmp___2 ;
  long tmp___3 ;

  {
#line 55
  tmp___3 = __builtin_expect((long )((unsigned long )__fp->_IO_read_ptr >= (unsigned long )__fp->_IO_read_end),
                             0L);
#line 55
  if (tmp___3) {
#line 55
    tmp___0 = __uflow(__fp);
#line 55
    tmp___2 = tmp___0;
  } else {
#line 55
    tmp___1 = __fp->_IO_read_ptr;
#line 55
    (__fp->_IO_read_ptr) ++;
#line 55
    tmp___2 = (int )*((unsigned char *)tmp___1);
  }
#line 55
  return (tmp___2);
}
}
#line 69 "/usr/include/x86_64-linux-gnu/bits/stdio.h"
__inline extern int getchar_unlocked(void) 
{ 
  int tmp___0 ;
  char *tmp___1 ;
  int tmp___2 ;
  long tmp___3 ;

  {
#line 72
  tmp___3 = __builtin_expect((long )((unsigned long )stdin->_IO_read_ptr >= (unsigned long )stdin->_IO_read_end),
                             0L);
#line 72
  if (tmp___3) {
#line 72
    tmp___0 = __uflow(stdin);
#line 72
    tmp___2 = tmp___0;
  } else {
#line 72
    tmp___1 = stdin->_IO_read_ptr;
#line 72
    (stdin->_IO_read_ptr) ++;
#line 72
    tmp___2 = (int )*((unsigned char *)tmp___1);
  }
#line 72
  return (tmp___2);
}
}
#line 78 "/usr/include/x86_64-linux-gnu/bits/stdio.h"
__inline extern int putchar(int __c ) 
{ 
  int tmp ;

  {
#line 81
  tmp = _IO_putc(__c, stdout);
#line 81
  return (tmp);
}
}
#line 87 "/usr/include/x86_64-linux-gnu/bits/stdio.h"
__inline extern int fputc_unlocked(int __c , FILE *__stream ) 
{ 
  int tmp___0 ;
  char *tmp___1 ;
  char tmp___2 ;
  int tmp___3 ;
  long tmp___4 ;

  {
#line 90
  tmp___4 = __builtin_expect((long )((unsigned long )__stream->_IO_write_ptr >= (unsigned long )__stream->_IO_write_end),
                             0L);
#line 90
  if (tmp___4) {
#line 90
    tmp___0 = __overflow(__stream, (int )((unsigned char )__c));
#line 90
    tmp___3 = tmp___0;
  } else {
#line 90
    tmp___1 = __stream->_IO_write_ptr;
#line 90
    (__stream->_IO_write_ptr) ++;
#line 90
    tmp___2 = (char )__c;
#line 90
    *tmp___1 = tmp___2;
#line 90
    tmp___3 = (int )((unsigned char )tmp___2);
  }
#line 90
  return (tmp___3);
}
}
#line 104 "/usr/include/x86_64-linux-gnu/bits/stdio.h"
__inline extern int putchar_unlocked(int __c ) 
{ 
  int tmp___0 ;
  char *tmp___1 ;
  char tmp___2 ;
  int tmp___3 ;
  long tmp___4 ;

  {
#line 107
  tmp___4 = __builtin_expect((long )((unsigned long )stdout->_IO_write_ptr >= (unsigned long )stdout->_IO_write_end),
                             0L);
#line 107
  if (tmp___4) {
#line 107
    tmp___0 = __overflow(stdout, (int )((unsigned char )__c));
#line 107
    tmp___3 = tmp___0;
  } else {
#line 107
    tmp___1 = stdout->_IO_write_ptr;
#line 107
    (stdout->_IO_write_ptr) ++;
#line 107
    tmp___2 = (char )__c;
#line 107
    *tmp___1 = tmp___2;
#line 107
    tmp___3 = (int )((unsigned char )tmp___2);
  }
#line 107
  return (tmp___3);
}
}
#line 124
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) feof_unlocked)(FILE *__stream ) ;
#line 124 "/usr/include/x86_64-linux-gnu/bits/stdio.h"
__inline extern int ( __attribute__((__warn_unused_result__, __leaf__)) feof_unlocked)(FILE *__stream ) 
{ 


  {
#line 127
  return ((__stream->_flags & 16) != 0);
}
}
#line 131
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) ferror_unlocked)(FILE *__stream ) ;
#line 131 "/usr/include/x86_64-linux-gnu/bits/stdio.h"
__inline extern int ( __attribute__((__warn_unused_result__, __leaf__)) ferror_unlocked)(FILE *__stream ) 
{ 


  {
#line 134
  return ((__stream->_flags & 32) != 0);
}
}
#line 30 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__, __artificial__,
__always_inline__)) sprintf)(char * __restrict  __s , char const   * __restrict  __fmt 
                             , ...) ;
#line 30 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( __attribute__((__leaf__, __artificial__, __always_inline__)) sprintf)(char * __restrict  __s ,
                                                                                            char const   * __restrict  __fmt 
                                                                                            , ...) 
{ 
  unsigned long tmp ;
  int tmp___0 ;

  {
#line 33
  tmp = __builtin_object_size((void *)__s, 1);
#line 33
  tmp___0 = __builtin___sprintf_chk((char *)__s, 1, tmp, (char const   *)__fmt, __builtin_va_arg_pack());
#line 33
  return (tmp___0);
}
}
#line 42
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__, __artificial__,
__always_inline__)) vsprintf)(char * __restrict  __s , char const   * __restrict  __fmt ,
                              __gnuc_va_list __ap ) ;
#line 42 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( __attribute__((__leaf__, __artificial__, __always_inline__)) vsprintf)(char * __restrict  __s ,
                                                                                             char const   * __restrict  __fmt ,
                                                                                             __gnuc_va_list __ap ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;

  {
#line 46
  tmp = __builtin_object_size((void *)__s, 1);
#line 46
  tmp___0 = __builtin___vsprintf_chk((char *)__s, 1, tmp, (char const   *)__fmt, __ap);
#line 46
  return (tmp___0);
}
}
#line 60
__inline extern  __attribute__((__nothrow__)) int ( /* format attribute */ __attribute__((__leaf__,
__artificial__, __always_inline__)) snprintf)(char * __restrict  __s , size_t __n ,
                                              char const   * __restrict  __fmt  , ...) ;
#line 60 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( /* format attribute */ __attribute__((__leaf__, __artificial__,
__always_inline__)) snprintf)(char * __restrict  __s , size_t __n , char const   * __restrict  __fmt 
                              , ...) 
{ 
  unsigned long tmp ;
  int tmp___0 ;

  {
#line 64
  tmp = __builtin_object_size((void *)__s, 1);
#line 64
  tmp___0 = __builtin___snprintf_chk((char *)__s, __n, 1, tmp, (char const   *)__fmt,
                                     __builtin_va_arg_pack());
#line 64
  return (tmp___0);
}
}
#line 73
__inline extern  __attribute__((__nothrow__)) int ( /* format attribute */ __attribute__((__leaf__,
__artificial__, __always_inline__)) vsnprintf)(char * __restrict  __s , size_t __n ,
                                               char const   * __restrict  __fmt ,
                                               __gnuc_va_list __ap ) ;
#line 73 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( /* format attribute */ __attribute__((__leaf__, __artificial__,
__always_inline__)) vsnprintf)(char * __restrict  __s , size_t __n , char const   * __restrict  __fmt ,
                               __gnuc_va_list __ap ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;

  {
#line 77
  tmp = __builtin_object_size((void *)__s, 1);
#line 77
  tmp___0 = __builtin___vsnprintf_chk((char *)__s, __n, 1, tmp, (char const   *)__fmt,
                                      __ap);
#line 77
  return (tmp___0);
}
}
#line 85
extern int __fprintf_chk(FILE * __restrict  __stream , int __flag , char const   * __restrict  __format 
                         , ...) ;
#line 87
extern int __printf_chk(int __flag , char const   * __restrict  __format  , ...) ;
#line 88
extern int __vfprintf_chk(FILE * __restrict  __stream , int __flag , char const   * __restrict  __format ,
                          __gnuc_va_list __ap ) ;
#line 94 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( __attribute__((__artificial__, __always_inline__)) fprintf)(FILE * __restrict  __stream ,
                                                                                  char const   * __restrict  __fmt 
                                                                                  , ...) 
{ 
  int tmp ;

  {
#line 97
  tmp = __fprintf_chk(__stream, 1, __fmt, __builtin_va_arg_pack());
#line 97
  return (tmp);
}
}
#line 101 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( __attribute__((__artificial__, __always_inline__)) printf)(char const   * __restrict  __fmt 
                                                                                 , ...) 
{ 
  int tmp ;

  {
#line 104
  tmp = __printf_chk(1, __fmt, __builtin_va_arg_pack());
#line 104
  return (tmp);
}
}
#line 113 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( __attribute__((__artificial__, __always_inline__)) vprintf)(char const   * __restrict  __fmt ,
                                                                                  __gnuc_va_list __ap ) 
{ 
  int tmp ;

  {
#line 117
  tmp = __vfprintf_chk((FILE * __restrict  )stdout, 1, __fmt, __ap);
#line 117
  return (tmp);
}
}
#line 123 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( __attribute__((__artificial__, __always_inline__)) vfprintf)(FILE * __restrict  __stream ,
                                                                                   char const   * __restrict  __fmt ,
                                                                                   __gnuc_va_list __ap ) 
{ 
  int tmp ;

  {
#line 127
  tmp = __vfprintf_chk(__stream, 1, __fmt, __ap);
#line 127
  return (tmp);
}
}
#line 131
extern int ( /* format attribute */  __dprintf_chk)(int __fd , int __flag , char const   * __restrict  __fmt 
                                                    , ...) ;
#line 133
extern int ( /* format attribute */  __vdprintf_chk)(int __fd , int __flag , char const   * __restrict  __fmt ,
                                                     __gnuc_va_list __arg ) ;
#line 138 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( /* format attribute */ __attribute__((__artificial__, __always_inline__)) dprintf)(int __fd ,
                                                                                                         char const   * __restrict  __fmt 
                                                                                                         , ...) 
{ 
  int tmp ;

  {
#line 141
  tmp = __dprintf_chk(__fd, 1, __fmt, __builtin_va_arg_pack());
#line 141
  return (tmp);
}
}
#line 149 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern int ( /* format attribute */ __attribute__((__artificial__, __always_inline__)) vdprintf)(int __fd ,
                                                                                                          char const   * __restrict  __fmt ,
                                                                                                          __gnuc_va_list __ap ) 
{ 
  int tmp ;

  {
#line 152
  tmp = __vdprintf_chk(__fd, 1, __fmt, __ap);
#line 152
  return (tmp);
}
}
#line 227
extern char *( __attribute__((__warn_unused_result__)) __gets_chk)(char *__str , size_t  ) ;
#line 228
extern char *( __attribute__((__warn_unused_result__)) __gets_warn)(char *__str )  __asm__("gets") __attribute__((__warning__("please use fgets or getline instead, gets can\'t specify buffer size"))) ;
#line 232
__inline extern char *( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) gets)(char *__str )  __attribute__((__deprecated__)) ;
#line 232 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern char *( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) gets)(char *__str ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;
  unsigned long tmp___1 ;
  char *tmp___2 ;

  {
#line 235
  tmp___1 = __builtin_object_size((void *)__str, 1);
#line 235
  if (tmp___1 != 0xffffffffffffffffUL) {
#line 236
    tmp = __builtin_object_size((void *)__str, 1);
#line 236
    tmp___0 = __gets_chk(__str, tmp);
#line 236
    return (tmp___0);
  }
#line 237
  tmp___2 = __gets_warn(__str);
#line 237
  return (tmp___2);
}
}
#line 241
extern char *( __attribute__((__warn_unused_result__)) __fgets_chk)(char * __restrict  __s ,
                                                                    size_t __size ,
                                                                    int __n , FILE * __restrict  __stream ) ;
#line 243
extern char *( __attribute__((__warn_unused_result__)) __fgets_alias)(char * __restrict  __s ,
                                                                      int __n , FILE * __restrict  __stream )  __asm__("fgets")  ;
#line 246
extern char *( __attribute__((__warn_unused_result__)) __fgets_chk_warn)(char * __restrict  __s ,
                                                                         size_t __size ,
                                                                         int __n ,
                                                                         FILE * __restrict  __stream )  __asm__("__fgets_chk") __attribute__((__warning__("fgets called with bigger size than length of destination buffer"))) ;
#line 252 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern char *( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) fgets)(char * __restrict  __s ,
                                                                                                          int __n ,
                                                                                                          FILE * __restrict  __stream ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;
  unsigned long tmp___1 ;
  char *tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  char *tmp___5 ;

  {
#line 255
  tmp___4 = __builtin_object_size((void *)__s, 1);
#line 255
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 258
    tmp = __builtin_object_size((void *)__s, 1);
#line 258
    tmp___0 = __fgets_chk(__s, tmp, __n, __stream);
#line 258
    return (tmp___0);
#line 260
    tmp___3 = __builtin_object_size((void *)__s, 1);
#line 260
    if ((size_t )__n > tmp___3) {
#line 261
      tmp___1 = __builtin_object_size((void *)__s, 1);
#line 261
      tmp___2 = __fgets_chk_warn(__s, tmp___1, __n, __stream);
#line 261
      return (tmp___2);
    }
  }
#line 263
  tmp___5 = __fgets_alias(__s, __n, __stream);
#line 263
  return (tmp___5);
}
}
#line 266
extern size_t ( __attribute__((__warn_unused_result__)) __fread_chk)(void * __restrict  __ptr ,
                                                                     size_t __ptrlen ,
                                                                     size_t __size ,
                                                                     size_t __n ,
                                                                     FILE * __restrict  __stream ) ;
#line 269
extern size_t ( __attribute__((__warn_unused_result__)) __fread_alias)(void * __restrict  __ptr ,
                                                                       size_t __size ,
                                                                       size_t __n ,
                                                                       FILE * __restrict  __stream )  __asm__("fread")  ;
#line 273
extern size_t ( __attribute__((__warn_unused_result__)) __fread_chk_warn)(void * __restrict  __ptr ,
                                                                          size_t __ptrlen ,
                                                                          size_t __size ,
                                                                          size_t __n ,
                                                                          FILE * __restrict  __stream )  __asm__("__fread_chk") __attribute__((__warning__("fread called with bigger size * nmemb than length of destination buffer"))) ;
#line 281 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern size_t ( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) fread)(void * __restrict  __ptr ,
                                                                                                           size_t __size ,
                                                                                                           size_t __n ,
                                                                                                           FILE * __restrict  __stream ) 
{ 
  unsigned long tmp ;
  size_t tmp___0 ;
  unsigned long tmp___1 ;
  size_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  size_t tmp___5 ;

  {
#line 285
  tmp___4 = __builtin_object_size((void *)__ptr, 0);
#line 285
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 290
    tmp = __builtin_object_size((void *)__ptr, 0);
#line 290
    tmp___0 = __fread_chk(__ptr, tmp, __size, __n, __stream);
#line 290
    return (tmp___0);
#line 292
    tmp___3 = __builtin_object_size((void *)__ptr, 0);
#line 292
    if (__size * __n > tmp___3) {
#line 293
      tmp___1 = __builtin_object_size((void *)__ptr, 0);
#line 293
      tmp___2 = __fread_chk_warn(__ptr, tmp___1, __size, __n, __stream);
#line 293
      return (tmp___2);
    }
  }
#line 295
  tmp___5 = __fread_alias(__ptr, __size, __n, __stream);
#line 295
  return (tmp___5);
}
}
#line 327
extern size_t ( __attribute__((__warn_unused_result__)) __fread_unlocked_chk)(void * __restrict  __ptr ,
                                                                              size_t __ptrlen ,
                                                                              size_t __size ,
                                                                              size_t __n ,
                                                                              FILE * __restrict  __stream ) ;
#line 330
extern size_t ( __attribute__((__warn_unused_result__)) __fread_unlocked_alias)(void * __restrict  __ptr ,
                                                                                size_t __size ,
                                                                                size_t __n ,
                                                                                FILE * __restrict  __stream )  __asm__("fread_unlocked")  ;
#line 334
extern size_t ( __attribute__((__warn_unused_result__)) __fread_unlocked_chk_warn)(void * __restrict  __ptr ,
                                                                                   size_t __ptrlen ,
                                                                                   size_t __size ,
                                                                                   size_t __n ,
                                                                                   FILE * __restrict  __stream )  __asm__("__fread_unlocked_chk") __attribute__((__warning__("fread_unlocked called with bigger size * nmemb than length of destination buffer"))) ;
#line 342 "/usr/include/x86_64-linux-gnu/bits/stdio2.h"
__inline extern size_t ( __attribute__((__warn_unused_result__, __artificial__, __always_inline__)) fread_unlocked)(void * __restrict  __ptr ,
                                                                                                                    size_t __size ,
                                                                                                                    size_t __n ,
                                                                                                                    FILE * __restrict  __stream ) 
{ 
  unsigned long tmp ;
  size_t tmp___0 ;
  unsigned long tmp___1 ;
  size_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  size_t tmp___11 ;

  {
#line 346
  tmp___4 = __builtin_object_size((void *)__ptr, 0);
#line 346
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 351
    tmp = __builtin_object_size((void *)__ptr, 0);
#line 351
    tmp___0 = __fread_unlocked_chk(__ptr, tmp, __size, __n, __stream);
#line 351
    return (tmp___0);
#line 354
    tmp___3 = __builtin_object_size((void *)__ptr, 0);
#line 354
    if (__size * __n > tmp___3) {
#line 355
      tmp___1 = __builtin_object_size((void *)__ptr, 0);
#line 355
      tmp___2 = __fread_unlocked_chk_warn(__ptr, tmp___1, __size, __n, __stream);
#line 355
      return (tmp___2);
    }
  }
#line 380
  tmp___11 = __fread_unlocked_alias(__ptr, __size, __n, __stream);
#line 380
  return (tmp___11);
}
}
#line 42 "/usr/include/string.h"
__inline extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) memcpy)(void * __restrict  __dest ,
                                                      void const   * __restrict  __src ,
                                                      size_t __len ) ;
#line 46
__inline extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) memmove)(void *__dest , void const   *__src ,
                                                       size_t __len ) ;
#line 62
__inline extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1),
__leaf__, __artificial__, __always_inline__)) memset)(void *__dest , int __ch , size_t __len ) ;
#line 65
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) memcmp)(void const   *__s1 ,
                                                                                               void const   *__s2 ,
                                                                                               size_t __n )  __attribute__((__pure__)) ;
#line 92
extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1), __leaf__)) memchr)(void const   *__s ,
                                                                                               int __c ,
                                                                                               size_t __n )  __attribute__((__pure__)) ;
#line 125
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) strcpy)(char * __restrict  __dest ,
                                                      char const   * __restrict  __src ) ;
#line 128
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) strncpy)(char * __restrict  __dest ,
                                                       char const   * __restrict  __src ,
                                                       size_t __len ) ;
#line 133
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) strcat)(char * __restrict  __dest ,
                                                      char const   * __restrict  __src ) ;
#line 136
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) strncat)(char * __restrict  __dest ,
                                                       char const   * __restrict  __src ,
                                                       size_t __len ) ;
#line 338
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2), __leaf__)) strstr)(char const   *__haystack ,
                                                                                                 char const   *__needle )  __attribute__((__pure__)) ;
#line 350
extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(2,3), __leaf__)) __strtok_r)(char * __restrict  __s ,
                                                                                                     char const   * __restrict  __delim ,
                                                                                                     char ** __restrict  __save_ptr ) ;
#line 395
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__nonnull__(1), __leaf__)) strlen)(char const   *__s )  __attribute__((__pure__)) ;
#line 451
__inline extern  __attribute__((__nothrow__)) void ( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) bcopy)(void const   *__src , void *__dest ,
                                                     size_t __len ) ;
#line 455
__inline extern  __attribute__((__nothrow__)) void ( __attribute__((__nonnull__(1),
__leaf__, __artificial__, __always_inline__)) bzero)(void *__dest , size_t __len ) ;
#line 536
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2), __leaf__)) strncasecmp)(char const   *__s1 ,
                                                                                                    char const   *__s2 ,
                                                                                                    size_t __n )  __attribute__((__pure__)) ;
#line 575
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) stpncpy)(char * __restrict  __dest ,
                                                       char const   * __restrict  __src ,
                                                       size_t __n ) ;
#line 968 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern size_t __strcspn_c1(char const   *__s , int __reject ) ;
#line 969 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern size_t __strcspn_c1(char const   *__s , int __reject ) 
{ 
  register size_t __result ;

  {
#line 972
  __result = (size_t )0;
#line 973
  while (1) {
#line 973
    if ((int const   )*(__s + __result) != 0) {
#line 973
      if (! ((int const   )*(__s + __result) != (int const   )__reject)) {
#line 973
        break;
      }
    } else {
#line 973
      break;
    }
#line 974
    __result ++;
  }
#line 975
  return (__result);
}
}
#line 978
__inline extern size_t __strcspn_c2(char const   *__s , int __reject1 , int __reject2 ) ;
#line 980 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern size_t __strcspn_c2(char const   *__s , int __reject1 , int __reject2 ) 
{ 
  register size_t __result ;

  {
#line 983
  __result = (size_t )0;
#line 984
  while (1) {
#line 984
    if ((int const   )*(__s + __result) != 0) {
#line 984
      if ((int const   )*(__s + __result) != (int const   )__reject1) {
#line 984
        if (! ((int const   )*(__s + __result) != (int const   )__reject2)) {
#line 984
          break;
        }
      } else {
#line 984
        break;
      }
    } else {
#line 984
      break;
    }
#line 986
    __result ++;
  }
#line 987
  return (__result);
}
}
#line 990
__inline extern size_t __strcspn_c3(char const   *__s , int __reject1 , int __reject2 ,
                                    int __reject3 ) ;
#line 992 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern size_t __strcspn_c3(char const   *__s , int __reject1 , int __reject2 ,
                                    int __reject3 ) 
{ 
  register size_t __result ;

  {
#line 996
  __result = (size_t )0;
#line 997
  while (1) {
#line 997
    if ((int const   )*(__s + __result) != 0) {
#line 997
      if ((int const   )*(__s + __result) != (int const   )__reject1) {
#line 997
        if ((int const   )*(__s + __result) != (int const   )__reject2) {
#line 997
          if (! ((int const   )*(__s + __result) != (int const   )__reject3)) {
#line 997
            break;
          }
        } else {
#line 997
          break;
        }
      } else {
#line 997
        break;
      }
    } else {
#line 997
      break;
    }
#line 999
    __result ++;
  }
#line 1000
  return (__result);
}
}
#line 1044
__inline extern size_t __strspn_c1(char const   *__s , int __accept ) ;
#line 1045 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern size_t __strspn_c1(char const   *__s , int __accept ) 
{ 
  register size_t __result ;

  {
#line 1048
  __result = (size_t )0;
#line 1050
  while ((int const   )*(__s + __result) == (int const   )__accept) {
#line 1051
    __result ++;
  }
#line 1052
  return (__result);
}
}
#line 1055
__inline extern size_t __strspn_c2(char const   *__s , int __accept1 , int __accept2 ) ;
#line 1057 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern size_t __strspn_c2(char const   *__s , int __accept1 , int __accept2 ) 
{ 
  register size_t __result ;

  {
#line 1060
  __result = (size_t )0;
#line 1062
  while (1) {
#line 1062
    if (! ((int const   )*(__s + __result) == (int const   )__accept1)) {
#line 1062
      if (! ((int const   )*(__s + __result) == (int const   )__accept2)) {
#line 1062
        break;
      }
    }
#line 1063
    __result ++;
  }
#line 1064
  return (__result);
}
}
#line 1067
__inline extern size_t __strspn_c3(char const   *__s , int __accept1 , int __accept2 ,
                                   int __accept3 ) ;
#line 1069 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern size_t __strspn_c3(char const   *__s , int __accept1 , int __accept2 ,
                                   int __accept3 ) 
{ 
  register size_t __result ;

  {
#line 1072
  __result = (size_t )0;
#line 1074
  while (1) {
#line 1074
    if (! ((int const   )*(__s + __result) == (int const   )__accept1)) {
#line 1074
      if (! ((int const   )*(__s + __result) == (int const   )__accept2)) {
#line 1074
        if (! ((int const   )*(__s + __result) == (int const   )__accept3)) {
#line 1074
          break;
        }
      }
    }
#line 1076
    __result ++;
  }
#line 1077
  return (__result);
}
}
#line 1120
__inline extern char *__strpbrk_c2(char const   *__s , int __accept1 , int __accept2 ) ;
#line 1122 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern char *__strpbrk_c2(char const   *__s , int __accept1 , int __accept2 ) 
{ 
  char *tmp ;

  {
#line 1126
  while (1) {
#line 1126
    if ((int const   )*__s != 0) {
#line 1126
      if ((int const   )*__s != (int const   )__accept1) {
#line 1126
        if (! ((int const   )*__s != (int const   )__accept2)) {
#line 1126
          break;
        }
      } else {
#line 1126
        break;
      }
    } else {
#line 1126
      break;
    }
#line 1127
    __s ++;
  }
#line 1128
  if ((int const   )*__s == 0) {
#line 1128
    tmp = (char *)((void *)0);
  } else {
#line 1128
    tmp = (char *)((size_t )__s);
  }
#line 1128
  return (tmp);
}
}
#line 1131
__inline extern char *__strpbrk_c3(char const   *__s , int __accept1 , int __accept2 ,
                                   int __accept3 ) ;
#line 1133 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern char *__strpbrk_c3(char const   *__s , int __accept1 , int __accept2 ,
                                   int __accept3 ) 
{ 
  char *tmp ;

  {
#line 1137
  while (1) {
#line 1137
    if ((int const   )*__s != 0) {
#line 1137
      if ((int const   )*__s != (int const   )__accept1) {
#line 1137
        if ((int const   )*__s != (int const   )__accept2) {
#line 1137
          if (! ((int const   )*__s != (int const   )__accept3)) {
#line 1137
            break;
          }
        } else {
#line 1137
          break;
        }
      } else {
#line 1137
        break;
      }
    } else {
#line 1137
      break;
    }
#line 1139
    __s ++;
  }
#line 1140
  if ((int const   )*__s == 0) {
#line 1140
    tmp = (char *)((void *)0);
  } else {
#line 1140
    tmp = (char *)((size_t )__s);
  }
#line 1140
  return (tmp);
}
}
#line 1170
__inline extern char *__strtok_r_1c(char *__s , char __sep , char **__nextp ) ;
#line 1171 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern char *__strtok_r_1c(char *__s , char __sep , char **__nextp ) 
{ 
  char *__result ;
  char *tmp ;
  char *tmp___0 ;

  {
#line 1175
  if ((unsigned long )__s == (unsigned long )((void *)0)) {
#line 1176
    __s = *__nextp;
  }
#line 1177
  while ((int )*__s == (int )__sep) {
#line 1178
    __s ++;
  }
#line 1179
  __result = (char *)((void *)0);
#line 1180
  if ((int )*__s != 0) {
#line 1182
    tmp = __s;
#line 1182
    __s ++;
#line 1182
    __result = tmp;
#line 1183
    while ((int )*__s != 0) {
#line 1184
      tmp___0 = __s;
#line 1184
      __s ++;
#line 1184
      if ((int )*tmp___0 == (int )__sep) {
#line 1186
        *(__s + -1) = (char )'\000';
#line 1187
        break;
      }
    }
  }
#line 1190
  *__nextp = __s;
#line 1191
  return (__result);
}
}
#line 1220
__inline extern char *__strsep_1c(char **__s , char __reject ) ;
#line 1221 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern char *__strsep_1c(char **__s , char __reject ) 
{ 
  register char *__retval ;
  char *tmp ;
  char *tmp___0 ;
  char *tmp___2 ;

  {
#line 1224
  __retval = *__s;
#line 1225
  if ((unsigned long )__retval != (unsigned long )((void *)0)) {
#line 1225
    tmp___2 = __builtin_strchr(__retval, (int )__reject);
#line 1225
    tmp___0 = tmp___2;
#line 1225
    *__s = tmp___0;
#line 1225
    if ((unsigned long )tmp___0 != (unsigned long )((void *)0)) {
#line 1226
      tmp = *__s;
#line 1226
      (*__s) ++;
#line 1226
      *tmp = (char )'\000';
    }
  }
#line 1227
  return (__retval);
}
}
#line 1230
__inline extern char *__strsep_2c(char **__s , char __reject1 , char __reject2 ) ;
#line 1231 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern char *__strsep_2c(char **__s , char __reject1 , char __reject2 ) 
{ 
  register char *__retval ;
  register char *__cp ;
  char *tmp ;

  {
#line 1234
  __retval = *__s;
#line 1235
  if ((unsigned long )__retval != (unsigned long )((void *)0)) {
#line 1237
    __cp = __retval;
#line 1238
    while (1) {
#line 1240
      if ((int )*__cp == 0) {
#line 1242
        __cp = (char *)((void *)0);
#line 1243
        break;
      }
#line 1245
      if ((int )*__cp == (int )__reject1) {
#line 1247
        tmp = __cp;
#line 1247
        __cp ++;
#line 1247
        *tmp = (char )'\000';
#line 1248
        break;
      } else
#line 1245
      if ((int )*__cp == (int )__reject2) {
#line 1247
        tmp = __cp;
#line 1247
        __cp ++;
#line 1247
        *tmp = (char )'\000';
#line 1248
        break;
      }
#line 1250
      __cp ++;
    }
#line 1252
    *__s = __cp;
  }
#line 1254
  return (__retval);
}
}
#line 1257
__inline extern char *__strsep_3c(char **__s , char __reject1 , char __reject2 , char __reject3 ) ;
#line 1259 "/usr/include/x86_64-linux-gnu/bits/string2.h"
__inline extern char *__strsep_3c(char **__s , char __reject1 , char __reject2 , char __reject3 ) 
{ 
  register char *__retval ;
  register char *__cp ;
  char *tmp ;

  {
#line 1262
  __retval = *__s;
#line 1263
  if ((unsigned long )__retval != (unsigned long )((void *)0)) {
#line 1265
    __cp = __retval;
#line 1266
    while (1) {
#line 1268
      if ((int )*__cp == 0) {
#line 1270
        __cp = (char *)((void *)0);
#line 1271
        break;
      }
#line 1273
      if ((int )*__cp == (int )__reject1) {
#line 1275
        tmp = __cp;
#line 1275
        __cp ++;
#line 1275
        *tmp = (char )'\000';
#line 1276
        break;
      } else
#line 1273
      if ((int )*__cp == (int )__reject2) {
#line 1275
        tmp = __cp;
#line 1275
        __cp ++;
#line 1275
        *tmp = (char )'\000';
#line 1276
        break;
      } else
#line 1273
      if ((int )*__cp == (int )__reject3) {
#line 1275
        tmp = __cp;
#line 1275
        __cp ++;
#line 1275
        *tmp = (char )'\000';
#line 1276
        break;
      }
#line 1278
      __cp ++;
    }
#line 1280
    *__s = __cp;
  }
#line 1282
  return (__retval);
}
}
#line 465 "/usr/include/stdlib.h"
extern  __attribute__((__nothrow__)) void *( __attribute__((__warn_unused_result__,
__leaf__)) malloc)(size_t __size )  __attribute__((__malloc__)) ;
#line 467
extern  __attribute__((__nothrow__)) void *( __attribute__((__warn_unused_result__,
__leaf__)) calloc)(size_t __nmemb , size_t __size )  __attribute__((__malloc__)) ;
#line 47 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) memcpy)(void * __restrict  __dest ,
                                                      void const   * __restrict  __src ,
                                                      size_t __len ) ;
#line 47 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern void *( __attribute__((__nonnull__(1,2), __leaf__, __artificial__,
__always_inline__)) memcpy)(void * __restrict  __dest , void const   * __restrict  __src ,
                            size_t __len ) 
{ 
  unsigned long tmp ;
  void *tmp___0 ;

  {
#line 51
  tmp = __builtin_object_size((void *)__dest, 0);
#line 51
  tmp___0 = __builtin___memcpy_chk((void *)__dest, (void const   *)__src, __len, tmp);
#line 51
  return (tmp___0);
}
}
#line 54
__inline extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) memmove)(void *__dest , void const   *__src ,
                                                       size_t __len ) ;
#line 54 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern void *( __attribute__((__nonnull__(1,2), __leaf__, __artificial__,
__always_inline__)) memmove)(void *__dest , void const   *__src , size_t __len ) 
{ 
  unsigned long tmp ;
  void *tmp___0 ;

  {
#line 57
  tmp = __builtin_object_size(__dest, 0);
#line 57
  tmp___0 = __builtin___memmove_chk(__dest, __src, __len, tmp);
#line 57
  return (tmp___0);
}
}
#line 75
__inline extern  __attribute__((__nothrow__)) void *( __attribute__((__nonnull__(1),
__leaf__, __artificial__, __always_inline__)) memset)(void *__dest , int __ch , size_t __len ) ;
#line 75 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern void *( __attribute__((__nonnull__(1), __leaf__, __artificial__, __always_inline__)) memset)(void *__dest ,
                                                                                                             int __ch ,
                                                                                                             size_t __len ) 
{ 
  unsigned long tmp ;
  void *tmp___0 ;

  {
#line 84
  tmp = __builtin_object_size(__dest, 0);
#line 84
  tmp___0 = __builtin___memset_chk(__dest, __ch, __len, tmp);
#line 84
  return (tmp___0);
}
}
#line 88
__inline extern  __attribute__((__nothrow__)) void ( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) bcopy)(void const   *__src , void *__dest ,
                                                     size_t __len ) ;
#line 88 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern void ( __attribute__((__nonnull__(1,2), __leaf__, __artificial__,
__always_inline__)) bcopy)(void const   *__src , void *__dest , size_t __len ) 
{ 
  unsigned long tmp ;

  {
#line 91
  tmp = __builtin_object_size(__dest, 0);
#line 91
  __builtin___memmove_chk(__dest, __src, __len, tmp);
#line 92
  return;
}
}
#line 94
__inline extern  __attribute__((__nothrow__)) void ( __attribute__((__nonnull__(1),
__leaf__, __artificial__, __always_inline__)) bzero)(void *__dest , size_t __len ) ;
#line 94 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern void ( __attribute__((__nonnull__(1), __leaf__, __artificial__, __always_inline__)) bzero)(void *__dest ,
                                                                                                           size_t __len ) 
{ 
  unsigned long tmp ;

  {
#line 97
  tmp = __builtin_object_size(__dest, 0);
#line 97
  __builtin___memset_chk(__dest, '\000', __len, tmp);
#line 98
  return;
}
}
#line 101
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) strcpy)(char * __restrict  __dest ,
                                                      char const   * __restrict  __src ) ;
#line 101 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern char *( __attribute__((__nonnull__(1,2), __leaf__, __artificial__,
__always_inline__)) strcpy)(char * __restrict  __dest , char const   * __restrict  __src ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;

  {
#line 104
  tmp = __builtin_object_size((void *)__dest, 1);
#line 104
  tmp___0 = __builtin___strcpy_chk((char *)__dest, (char const   *)__src, tmp);
#line 104
  return (tmp___0);
}
}
#line 116
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) strncpy)(char * __restrict  __dest ,
                                                       char const   * __restrict  __src ,
                                                       size_t __len ) ;
#line 116 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern char *( __attribute__((__nonnull__(1,2), __leaf__, __artificial__,
__always_inline__)) strncpy)(char * __restrict  __dest , char const   * __restrict  __src ,
                             size_t __len ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;

  {
#line 120
  tmp = __builtin_object_size((void *)__dest, 1);
#line 120
  tmp___0 = __builtin___strncpy_chk((char *)__dest, (char const   *)__src, __len,
                                    tmp);
#line 120
  return (tmp___0);
}
}
#line 124
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) __stpncpy_chk)(char *__dest ,
                                                                                      char const   *__src ,
                                                                                      size_t __n ,
                                                                                      size_t __destlen ) ;
#line 126
extern  __attribute__((__nothrow__)) char *( __attribute__((__leaf__)) __stpncpy_alias)(char *__dest ,
                                                                                        char const   *__src ,
                                                                                        size_t __n )  __asm__("stpncpy")  ;
#line 129
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) stpncpy)(char * __restrict  __dest ,
                                                       char const   * __restrict  __src ,
                                                       size_t __n ) ;
#line 129 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern char *( __attribute__((__nonnull__(1,2), __leaf__, __artificial__,
__always_inline__)) stpncpy)(char * __restrict  __dest , char const   * __restrict  __src ,
                             size_t __n ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;
  unsigned long tmp___1 ;
  char *tmp___3 ;

  {
#line 132
  tmp___1 = __builtin_object_size((void *)__dest, 1);
#line 132
  if (tmp___1 != 0xffffffffffffffffUL) {
#line 134
    tmp = __builtin_object_size((void *)__dest, 1);
#line 134
    tmp___0 = __stpncpy_chk((char *)__dest, (char const   *)__src, __n, tmp);
#line 134
    return (tmp___0);
  }
#line 135
  tmp___3 = __stpncpy_alias((char *)__dest, (char const   *)__src, __n);
#line 135
  return (tmp___3);
}
}
#line 139
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) strcat)(char * __restrict  __dest ,
                                                      char const   * __restrict  __src ) ;
#line 139 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern char *( __attribute__((__nonnull__(1,2), __leaf__, __artificial__,
__always_inline__)) strcat)(char * __restrict  __dest , char const   * __restrict  __src ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;

  {
#line 142
  tmp = __builtin_object_size((void *)__dest, 1);
#line 142
  tmp___0 = __builtin___strcat_chk((char *)__dest, (char const   *)__src, tmp);
#line 142
  return (tmp___0);
}
}
#line 146
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__nonnull__(1,2),
__leaf__, __artificial__, __always_inline__)) strncat)(char * __restrict  __dest ,
                                                       char const   * __restrict  __src ,
                                                       size_t __len ) ;
#line 146 "/usr/include/x86_64-linux-gnu/bits/string3.h"
__inline extern char *( __attribute__((__nonnull__(1,2), __leaf__, __artificial__,
__always_inline__)) strncat)(char * __restrict  __dest , char const   * __restrict  __src ,
                             size_t __len ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;

  {
#line 150
  tmp = __builtin_object_size((void *)__dest, 1);
#line 150
  tmp___0 = __builtin___strncat_chk((char *)__dest, (char const   *)__src, __len,
                                    tmp);
#line 150
  return (tmp___0);
}
}
#line 144 "/usr/include/stdlib.h"
__inline extern  __attribute__((__nothrow__)) double ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) atof)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 147
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) atoi)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 150
__inline extern  __attribute__((__nothrow__)) long ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) atol)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 157
__inline extern  __attribute__((__nothrow__)) long long ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) atoll)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 164
extern  __attribute__((__nothrow__)) double ( __attribute__((__nonnull__(1), __leaf__)) strtod)(char const   * __restrict  __nptr ,
                                                                                                char ** __restrict  __endptr ) ;
#line 183
extern  __attribute__((__nothrow__)) long ( __attribute__((__nonnull__(1), __leaf__)) strtol)(char const   * __restrict  __nptr ,
                                                                                              char ** __restrict  __endptr ,
                                                                                              int __base ) ;
#line 209
extern  __attribute__((__nothrow__)) long long ( __attribute__((__nonnull__(1), __leaf__)) strtoll)(char const   * __restrict  __nptr ,
                                                                                                    char ** __restrict  __endptr ,
                                                                                                    int __base ) ;
#line 277
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) atoi)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 277 "/usr/include/stdlib.h"
__inline extern int ( __attribute__((__warn_unused_result__, __nonnull__(1), __leaf__)) atoi)(char const   *__nptr ) 
{ 
  long tmp ;

  {
#line 280
  tmp = strtol((char const   * __restrict  )__nptr, (char ** __restrict  )((char **)((void *)0)),
               10);
#line 280
  return ((int )tmp);
}
}
#line 282
__inline extern  __attribute__((__nothrow__)) long ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) atol)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 282 "/usr/include/stdlib.h"
__inline extern long ( __attribute__((__warn_unused_result__, __nonnull__(1), __leaf__)) atol)(char const   *__nptr ) 
{ 
  long tmp ;

  {
#line 285
  tmp = strtol((char const   * __restrict  )__nptr, (char ** __restrict  )((char **)((void *)0)),
               10);
#line 285
  return (tmp);
}
}
#line 291
__inline extern  __attribute__((__nothrow__)) long long ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) atoll)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 291 "/usr/include/stdlib.h"
__inline extern long long ( __attribute__((__warn_unused_result__, __nonnull__(1),
__leaf__)) atoll)(char const   *__nptr ) 
{ 
  long long tmp ;

  {
#line 294
  tmp = strtoll((char const   * __restrict  )__nptr, (char ** __restrict  )((char **)((void *)0)),
                10);
#line 294
  return (tmp);
}
}
#line 482
extern  __attribute__((__nothrow__)) void ( __attribute__((__leaf__)) free)(void *__ptr ) ;
#line 733
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__, __artificial__, __always_inline__)) realpath)(char const   * __restrict  __name ,
                                                        char * __restrict  __resolved ) ;
#line 866
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__, __artificial__, __always_inline__)) wctomb)(char *__s , wchar_t __wchar ) ;
#line 870
__inline extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__, __artificial__,
__always_inline__)) mbstowcs)(wchar_t * __restrict  __dst , char const   * __restrict  __src ,
                              size_t __len ) ;
#line 873
__inline extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__, __artificial__,
__always_inline__)) wcstombs)(char * __restrict  __dst , wchar_t const   * __restrict  __src ,
                              size_t __len ) ;
#line 25 "/usr/include/x86_64-linux-gnu/bits/stdlib-float.h"
__inline extern  __attribute__((__nothrow__)) double ( __attribute__((__warn_unused_result__,
__nonnull__(1), __leaf__)) atof)(char const   *__nptr )  __attribute__((__pure__)) ;
#line 25 "/usr/include/x86_64-linux-gnu/bits/stdlib-float.h"
__inline extern double ( __attribute__((__warn_unused_result__, __nonnull__(1), __leaf__)) atof)(char const   *__nptr ) 
{ 
  double tmp ;

  {
#line 28
  tmp = strtod((char const   * __restrict  )__nptr, (char ** __restrict  )((char **)((void *)0)));
#line 28
  return (tmp);
}
}
#line 23 "/usr/include/x86_64-linux-gnu/bits/stdlib.h"
extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__)) __realpath_chk)(char const   * __restrict  __name , char * __restrict  __resolved ,
                           size_t __resolvedlen ) ;
#line 26
extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__)) __realpath_alias)(char const   * __restrict  __name , char * __restrict  __resolved )  __asm__("realpath")  ;
#line 36
__inline extern  __attribute__((__nothrow__)) char *( __attribute__((__warn_unused_result__,
__leaf__, __artificial__, __always_inline__)) realpath)(char const   * __restrict  __name ,
                                                        char * __restrict  __resolved ) ;
#line 36 "/usr/include/x86_64-linux-gnu/bits/stdlib.h"
__inline extern char *( __attribute__((__warn_unused_result__, __leaf__, __artificial__,
__always_inline__)) realpath)(char const   * __restrict  __name , char * __restrict  __resolved ) 
{ 
  unsigned long tmp ;
  char *tmp___0 ;
  unsigned long tmp___1 ;
  char *tmp___2 ;

  {
#line 39
  tmp___1 = __builtin_object_size((void *)__resolved, 1);
#line 39
  if (tmp___1 != 0xffffffffffffffffUL) {
#line 45
    tmp = __builtin_object_size((void *)__resolved, 1);
#line 45
    tmp___0 = __realpath_chk(__name, __resolved, tmp);
#line 45
    return (tmp___0);
  }
#line 48
  tmp___2 = __realpath_alias(__name, __resolved);
#line 48
  return (tmp___2);
}
}
#line 52
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2), __leaf__)) __ptsname_r_chk)(int __fd ,
                                                                                                      char *__buf ,
                                                                                                      size_t __buflen ,
                                                                                                      size_t __nreal ) ;
#line 54
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2), __leaf__)) __ptsname_r_alias)(int __fd ,
                                                                                                        char *__buf ,
                                                                                                        size_t __buflen )  __asm__("ptsname_r")  ;
#line 57
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2), __leaf__)) __ptsname_r_chk_warn)(int __fd ,
                                                                                                           char *__buf ,
                                                                                                           size_t __buflen ,
                                                                                                           size_t __nreal )  __asm__("__ptsname_r_chk") __attribute__((__warning__("ptsname_r called with buflen bigger than size of buf"))) ;
#line 63
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__, __artificial__,
__always_inline__)) ptsname_r)(int __fd , char *__buf , size_t __buflen ) ;
#line 63 "/usr/include/x86_64-linux-gnu/bits/stdlib.h"
__inline extern int ( __attribute__((__leaf__, __artificial__, __always_inline__)) ptsname_r)(int __fd ,
                                                                                              char *__buf ,
                                                                                              size_t __buflen ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;
  unsigned long tmp___1 ;
  int tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  int tmp___5 ;

  {
#line 66
  tmp___4 = __builtin_object_size((void *)__buf, 1);
#line 66
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 69
    tmp = __builtin_object_size((void *)__buf, 1);
#line 69
    tmp___0 = __ptsname_r_chk(__fd, __buf, __buflen, tmp);
#line 69
    return (tmp___0);
#line 70
    tmp___3 = __builtin_object_size((void *)__buf, 1);
#line 70
    if (__buflen > tmp___3) {
#line 71
      tmp___1 = __builtin_object_size((void *)__buf, 1);
#line 71
      tmp___2 = __ptsname_r_chk_warn(__fd, __buf, __buflen, tmp___1);
#line 71
      return (tmp___2);
    }
  }
#line 73
  tmp___5 = __ptsname_r_alias(__fd, __buf, __buflen);
#line 73
  return (tmp___5);
}
}
#line 77
extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) __wctomb_chk)(char *__s , wchar_t __wchar , size_t __buflen ) ;
#line 79
extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__)) __wctomb_alias)(char *__s , wchar_t __wchar )  __asm__("wctomb")  ;
#line 82
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__warn_unused_result__,
__leaf__, __artificial__, __always_inline__)) wctomb)(char *__s , wchar_t __wchar ) ;
#line 82 "/usr/include/x86_64-linux-gnu/bits/stdlib.h"
__inline extern int ( __attribute__((__warn_unused_result__, __leaf__, __artificial__,
__always_inline__)) wctomb)(char *__s , wchar_t __wchar ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;
  unsigned long tmp___1 ;
  unsigned long tmp___2 ;
  int tmp___3 ;

  {
#line 92
  tmp___1 = __builtin_object_size((void *)__s, 1);
#line 92
  if (tmp___1 != 0xffffffffffffffffUL) {
#line 92
    tmp___2 = __builtin_object_size((void *)__s, 1);
#line 92
    if (16UL > tmp___2) {
#line 93
      tmp = __builtin_object_size((void *)__s, 1);
#line 93
      tmp___0 = __wctomb_chk(__s, __wchar, tmp);
#line 93
      return (tmp___0);
    }
  }
#line 94
  tmp___3 = __wctomb_alias(__s, __wchar);
#line 94
  return (tmp___3);
}
}
#line 98
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __mbstowcs_chk)(wchar_t * __restrict  __dst ,
                                                                                        char const   * __restrict  __src ,
                                                                                        size_t __len ,
                                                                                        size_t __dstlen ) ;
#line 101
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __mbstowcs_alias)(wchar_t * __restrict  __dst ,
                                                                                          char const   * __restrict  __src ,
                                                                                          size_t __len )  __asm__("mbstowcs")  ;
#line 105
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __mbstowcs_chk_warn)(wchar_t * __restrict  __dst ,
                                                                                             char const   * __restrict  __src ,
                                                                                             size_t __len ,
                                                                                             size_t __dstlen )  __asm__("__mbstowcs_chk") __attribute__((__warning__("mbstowcs called with dst buffer smaller than len * sizeof (wchar_t)"))) ;
#line 112
__inline extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__, __artificial__,
__always_inline__)) mbstowcs)(wchar_t * __restrict  __dst , char const   * __restrict  __src ,
                              size_t __len ) ;
#line 112 "/usr/include/x86_64-linux-gnu/bits/stdlib.h"
__inline extern size_t ( __attribute__((__leaf__, __artificial__, __always_inline__)) mbstowcs)(wchar_t * __restrict  __dst ,
                                                                                                char const   * __restrict  __src ,
                                                                                                size_t __len ) 
{ 
  unsigned long tmp ;
  size_t tmp___0 ;
  unsigned long tmp___1 ;
  size_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  size_t tmp___5 ;

  {
#line 116
  tmp___4 = __builtin_object_size((void *)__dst, 1);
#line 116
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 119
    tmp = __builtin_object_size((void *)__dst, 1);
#line 119
    tmp___0 = __mbstowcs_chk(__dst, __src, __len, tmp / sizeof(wchar_t ));
#line 119
    return (tmp___0);
#line 122
    tmp___3 = __builtin_object_size((void *)__dst, 1);
#line 122
    if (__len > tmp___3 / sizeof(wchar_t )) {
#line 123
      tmp___1 = __builtin_object_size((void *)__dst, 1);
#line 123
      tmp___2 = __mbstowcs_chk_warn(__dst, __src, __len, tmp___1 / sizeof(wchar_t ));
#line 123
      return (tmp___2);
    }
  }
#line 126
  tmp___5 = __mbstowcs_alias(__dst, __src, __len);
#line 126
  return (tmp___5);
}
}
#line 130
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __wcstombs_chk)(char * __restrict  __dst ,
                                                                                        wchar_t const   * __restrict  __src ,
                                                                                        size_t __len ,
                                                                                        size_t __dstlen ) ;
#line 133
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __wcstombs_alias)(char * __restrict  __dst ,
                                                                                          wchar_t const   * __restrict  __src ,
                                                                                          size_t __len )  __asm__("wcstombs")  ;
#line 137
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) __wcstombs_chk_warn)(char * __restrict  __dst ,
                                                                                             wchar_t const   * __restrict  __src ,
                                                                                             size_t __len ,
                                                                                             size_t __dstlen )  __asm__("__wcstombs_chk") __attribute__((__warning__("wcstombs called with dst buffer smaller than len"))) ;
#line 143
__inline extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__, __artificial__,
__always_inline__)) wcstombs)(char * __restrict  __dst , wchar_t const   * __restrict  __src ,
                              size_t __len ) ;
#line 143 "/usr/include/x86_64-linux-gnu/bits/stdlib.h"
__inline extern size_t ( __attribute__((__leaf__, __artificial__, __always_inline__)) wcstombs)(char * __restrict  __dst ,
                                                                                                wchar_t const   * __restrict  __src ,
                                                                                                size_t __len ) 
{ 
  unsigned long tmp ;
  size_t tmp___0 ;
  unsigned long tmp___1 ;
  size_t tmp___2 ;
  unsigned long tmp___3 ;
  unsigned long tmp___4 ;
  size_t tmp___5 ;

  {
#line 147
  tmp___4 = __builtin_object_size((void *)__dst, 1);
#line 147
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 150
    tmp = __builtin_object_size((void *)__dst, 1);
#line 150
    tmp___0 = __wcstombs_chk(__dst, __src, __len, tmp);
#line 150
    return (tmp___0);
#line 151
    tmp___3 = __builtin_object_size((void *)__dst, 1);
#line 151
    if (__len > tmp___3) {
#line 152
      tmp___1 = __builtin_object_size((void *)__dst, 1);
#line 152
      tmp___2 = __wcstombs_chk_warn(__dst, __src, __len, tmp___1);
#line 152
      return (tmp___2);
    }
  }
#line 154
  tmp___5 = __wcstombs_alias(__dst, __src, __len);
#line 154
  return (tmp___5);
}
}
#line 232 "/usr/include/pthread.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,3))) pthread_create)(pthread_t * __restrict  __newthread ,
                                                                                             pthread_attr_t const   * __restrict  __attr ,
                                                                                             void *(*__start_routine)(void * ) ,
                                                                                             void * __restrict  __arg ) ;
#line 249
extern int pthread_join(pthread_t __th , void **__thread_return ) ;
#line 277
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) pthread_equal)(pthread_t __thread1 ,
                                                                                             pthread_t __thread2 )  __attribute__((__const__)) ;
#line 504
extern int pthread_cancel(pthread_t __th ) ;
#line 753
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) pthread_mutex_lock)(pthread_mutex_t *__mutex ) ;
#line 764
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1))) pthread_mutex_unlock)(pthread_mutex_t *__mutex ) ;
#line 1143
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) pthread_equal)(pthread_t __thread1 ,
                                                                                             pthread_t __thread2 )  __attribute__((__const__)) ;
#line 1143 "/usr/include/pthread.h"
__inline extern int ( __attribute__((__leaf__)) pthread_equal)(pthread_t __thread1 ,
                                                               pthread_t __thread2 ) 
{ 


  {
#line 1146
  return (__thread1 == __thread2);
}
}
#line 103 "cpcd_datastructures.h"
int new_queue_entry(struct queue **the_queue , char *data , char *net , int max_queue_size ) ;
#line 105
struct queue *pop_entry(struct queue **the_queue ) ;
#line 108
void free_queue_item(struct queue *the_item ) ;
#line 110
int init_context(struct cpcd_ctx **ctx___0 ) ;
#line 111
void free_context(struct cpcd_ctx *ctx___0 ) ;
#line 114
struct networks *get_first_network(struct networks *nets ) ;
#line 117
struct networks *get_network_by_name(struct networks *nets , char *name ) ;
#line 118
void free_networks(struct networks *networks ) ;
#line 120
unsigned long node_already_exists(struct hosts *cached_hosts , char *data ) ;
#line 121
int count_nodes(struct hosts *cached_hosts , int type ) ;
#line 122
struct hosts *get_first_host(struct hosts *cached_hosts ) ;
#line 124
struct hosts *get_oldest_host(struct hosts *cached_hosts , int type ) ;
#line 125
struct hosts *add_new_cached_host(struct hosts *cached_hosts , char *type_str , char *addr ,
                                  long bdate ) ;
#line 126
struct hosts *trim_struct_to_max(struct hosts *hosts , int max , char type ) ;
#line 127
struct hosts *delete_cached_host(struct hosts *host_to_delete ) ;
#line 128
struct hosts *delete_cached_host_by_name(struct hosts *cached_hosts , char *name ) ;
#line 129
void free_cached_hosts(struct hosts *cached_hosts ) ;
#line 80 "/usr/include/ctype.h"
extern  __attribute__((__nothrow__)) unsigned short const   **( __attribute__((__leaf__)) __ctype_b_loc)(void)  __attribute__((__const__)) ;
#line 82
extern  __attribute__((__nothrow__)) __int32_t const   **( __attribute__((__leaf__)) __ctype_tolower_loc)(void)  __attribute__((__const__)) ;
#line 84
extern  __attribute__((__nothrow__)) __int32_t const   **( __attribute__((__leaf__)) __ctype_toupper_loc)(void)  __attribute__((__const__)) ;
#line 125
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) tolower)(int __c ) ;
#line 128
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) toupper)(int __c ) ;
#line 215
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) tolower)(int __c ) ;
#line 215 "/usr/include/ctype.h"
__inline extern int ( __attribute__((__leaf__)) tolower)(int __c ) 
{ 
  __int32_t const   **tmp ;
  __int32_t tmp___0 ;

  {
#line 218
  if (__c >= -128) {
#line 218
    if (__c < 256) {
#line 218
      tmp = __ctype_tolower_loc();
#line 218
      tmp___0 = *(*tmp + __c);
    } else {
#line 218
      tmp___0 = (__int32_t const   )__c;
    }
  } else {
#line 218
    tmp___0 = (__int32_t const   )__c;
  }
#line 218
  return ((int )tmp___0);
}
}
#line 221
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) toupper)(int __c ) ;
#line 221 "/usr/include/ctype.h"
__inline extern int ( __attribute__((__leaf__)) toupper)(int __c ) 
{ 
  __int32_t const   **tmp ;
  __int32_t tmp___0 ;

  {
#line 224
  if (__c >= -128) {
#line 224
    if (__c < 256) {
#line 224
      tmp = __ctype_toupper_loc();
#line 224
      tmp___0 = *(*tmp + __c);
    } else {
#line 224
      tmp___0 = (__int32_t const   )__c;
    }
  } else {
#line 224
    tmp___0 = (__int32_t const   )__c;
  }
#line 224
  return ((int )tmp___0);
}
}
#line 210 "/usr/include/x86_64-linux-gnu/sys/stat.h"
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2),
__leaf__)) stat)(char const   * __restrict  __path , struct stat * __restrict  __statbuf ) ;
#line 215
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2),
__leaf__)) fstat)(int __fd , struct stat *__statbuf ) ;
#line 239
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2,3),
__leaf__)) fstatat)(int __fd , char const   * __restrict  __filename , struct stat * __restrict  __statbuf ,
                    int __flag ) ;
#line 264
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2),
__leaf__)) lstat)(char const   * __restrict  __path , struct stat * __restrict  __statbuf ) ;
#line 337
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1),
__leaf__)) mknod)(char const   *__path , __mode_t __mode , __dev_t __dev ) ;
#line 344
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2),
__leaf__)) mknodat)(int __fd , char const   *__path , __mode_t __mode , __dev_t __dev ) ;
#line 400
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(3), __leaf__)) __fxstat)(int __ver ,
                                                                                               int __fildes ,
                                                                                               struct stat *__stat_buf ) ;
#line 402
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2,3), __leaf__)) __xstat)(int __ver ,
                                                                                                char const   *__filename ,
                                                                                                struct stat *__stat_buf ) ;
#line 404
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2,3), __leaf__)) __lxstat)(int __ver ,
                                                                                                 char const   *__filename ,
                                                                                                 struct stat *__stat_buf ) ;
#line 406
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(3,4), __leaf__)) __fxstatat)(int __ver ,
                                                                                                   int __fildes ,
                                                                                                   char const   *__filename ,
                                                                                                   struct stat *__stat_buf ,
                                                                                                   int __flag ) ;
#line 443
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2,4), __leaf__)) __xmknod)(int __ver ,
                                                                                                 char const   *__path ,
                                                                                                 __mode_t __mode ,
                                                                                                 __dev_t *__dev ) ;
#line 446
extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(3,5), __leaf__)) __xmknodat)(int __ver ,
                                                                                                   int __fd ,
                                                                                                   char const   *__path ,
                                                                                                   __mode_t __mode ,
                                                                                                   __dev_t *__dev ) ;
#line 453
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2),
__leaf__)) stat)(char const   * __restrict  __path , struct stat * __restrict  __statbuf ) ;
#line 453 "/usr/include/x86_64-linux-gnu/sys/stat.h"
__inline extern int ( __attribute__((__nonnull__(1,2), __leaf__)) stat)(char const   * __restrict  __path ,
                                                                        struct stat * __restrict  __statbuf ) 
{ 
  int tmp ;

  {
#line 456
  tmp = __xstat(1, (char const   *)__path, (struct stat *)__statbuf);
#line 456
  return (tmp);
}
}
#line 460
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1,2),
__leaf__)) lstat)(char const   * __restrict  __path , struct stat * __restrict  __statbuf ) ;
#line 460 "/usr/include/x86_64-linux-gnu/sys/stat.h"
__inline extern int ( __attribute__((__nonnull__(1,2), __leaf__)) lstat)(char const   * __restrict  __path ,
                                                                         struct stat * __restrict  __statbuf ) 
{ 
  int tmp ;

  {
#line 463
  tmp = __lxstat(1, (char const   *)__path, (struct stat *)__statbuf);
#line 463
  return (tmp);
}
}
#line 467
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2),
__leaf__)) fstat)(int __fd , struct stat *__statbuf ) ;
#line 467 "/usr/include/x86_64-linux-gnu/sys/stat.h"
__inline extern int ( __attribute__((__nonnull__(2), __leaf__)) fstat)(int __fd ,
                                                                       struct stat *__statbuf ) 
{ 
  int tmp ;

  {
#line 470
  tmp = __fxstat(1, __fd, __statbuf);
#line 470
  return (tmp);
}
}
#line 474
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2,3),
__leaf__)) fstatat)(int __fd , char const   * __restrict  __filename , struct stat * __restrict  __statbuf ,
                    int __flag ) ;
#line 474 "/usr/include/x86_64-linux-gnu/sys/stat.h"
__inline extern int ( __attribute__((__nonnull__(2,3), __leaf__)) fstatat)(int __fd ,
                                                                           char const   * __restrict  __filename ,
                                                                           struct stat * __restrict  __statbuf ,
                                                                           int __flag ) 
{ 
  int tmp ;

  {
#line 478
  tmp = __fxstatat(1, __fd, (char const   *)__filename, (struct stat *)__statbuf,
                   __flag);
#line 478
  return (tmp);
}
}
#line 483
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(1),
__leaf__)) mknod)(char const   *__path , __mode_t __mode , __dev_t __dev ) ;
#line 483 "/usr/include/x86_64-linux-gnu/sys/stat.h"
__inline extern int ( __attribute__((__nonnull__(1), __leaf__)) mknod)(char const   *__path ,
                                                                       __mode_t __mode ,
                                                                       __dev_t __dev ) 
{ 
  int tmp ;

  {
#line 486
  tmp = __xmknod(0, __path, __mode, & __dev);
#line 486
  return (tmp);
}
}
#line 491
__inline extern  __attribute__((__nothrow__)) int ( __attribute__((__nonnull__(2),
__leaf__)) mknodat)(int __fd , char const   *__path , __mode_t __mode , __dev_t __dev ) ;
#line 491 "/usr/include/x86_64-linux-gnu/sys/stat.h"
__inline extern int ( __attribute__((__nonnull__(2), __leaf__)) mknodat)(int __fd ,
                                                                         char const   *__path ,
                                                                         __mode_t __mode ,
                                                                         __dev_t __dev ) 
{ 
  int tmp ;

  {
#line 495
  tmp = __xmknodat(0, __fd, __path, __mode, & __dev);
#line 495
  return (tmp);
}
}
#line 146 "/usr/include/fcntl.h"
__inline extern int ( __attribute__((__nonnull__(1), __artificial__, __always_inline__)) open)(char const   *__path ,
                                                                                               int __oflag 
                                                                                               , ...) ;
#line 170
__inline extern int ( __attribute__((__nonnull__(2), __artificial__, __always_inline__)) openat)(int __fd ,
                                                                                                 char const   *__path ,
                                                                                                 int __oflag 
                                                                                                 , ...) ;
#line 26 "/usr/include/x86_64-linux-gnu/bits/fcntl2.h"
extern int ( __attribute__((__nonnull__(1))) __open_2)(char const   *__path , int __oflag ) ;
#line 27
extern int ( __attribute__((__nonnull__(1))) __open_alias)(char const   *__path ,
                                                           int __oflag  , ...)  __asm__("open")  ;
#line 35
extern void __open_too_many_args(void)  __attribute__((__error__("open can be called either with 2 or 3 arguments, not more"))) ;
#line 40 "/usr/include/x86_64-linux-gnu/bits/fcntl2.h"
__inline extern int ( __attribute__((__nonnull__(1), __artificial__, __always_inline__)) open)(char const   *__path ,
                                                                                               int __oflag 
                                                                                               , ...) 
{ 
  int tmp ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 43
  tmp = __builtin_va_arg_pack_len();
#line 43
  if (tmp > 1) {
#line 44
    __open_too_many_args();
  }
#line 56
  tmp___4 = __builtin_va_arg_pack_len();
#line 56
  if (tmp___4 < 1) {
#line 57
    tmp___3 = __open_2(__path, __oflag);
#line 57
    return (tmp___3);
  }
#line 59
  tmp___5 = __open_alias(__path, __oflag, __builtin_va_arg_pack());
#line 59
  return (tmp___5);
}
}
#line 98
extern int ( __attribute__((__nonnull__(2))) __openat_2)(int __fd , char const   *__path ,
                                                         int __oflag ) ;
#line 100
extern int ( __attribute__((__nonnull__(2))) __openat_alias)(int __fd , char const   *__path ,
                                                             int __oflag  , ...)  __asm__("openat")  ;
#line 111
extern void __openat_too_many_args(void)  __attribute__((__error__("openat can be called either with 3 or 4 arguments, not more"))) ;
#line 116 "/usr/include/x86_64-linux-gnu/bits/fcntl2.h"
__inline extern int ( __attribute__((__nonnull__(2), __artificial__, __always_inline__)) openat)(int __fd ,
                                                                                                 char const   *__path ,
                                                                                                 int __oflag 
                                                                                                 , ...) 
{ 
  int tmp ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 119
  tmp = __builtin_va_arg_pack_len();
#line 119
  if (tmp > 1) {
#line 120
    __openat_too_many_args();
  }
#line 132
  tmp___4 = __builtin_va_arg_pack_len();
#line 132
  if (tmp___4 < 1) {
#line 133
    tmp___3 = __openat_2(__fd, __path, __oflag);
#line 133
    return (tmp___3);
  }
#line 135
  tmp___5 = __openat_alias(__fd, __path, __oflag, __builtin_va_arg_pack());
#line 135
  return (tmp___5);
}
}
#line 57 "/usr/include/x86_64-linux-gnu/sys/poll.h"
__inline extern int ( __attribute__((__artificial__, __always_inline__)) poll)(struct pollfd *__fds ,
                                                                               nfds_t __nfds ,
                                                                               int __timeout ) ;
#line 26 "/usr/include/x86_64-linux-gnu/bits/poll2.h"
extern int __poll_alias(struct pollfd *__fds , nfds_t __nfds , int __timeout )  __asm__("poll")  ;
#line 28
extern int __poll_chk(struct pollfd *__fds , nfds_t __nfds , int __timeout , unsigned long __fdslen ) ;
#line 35 "/usr/include/x86_64-linux-gnu/bits/poll2.h"
__inline extern int ( __attribute__((__artificial__, __always_inline__)) poll)(struct pollfd *__fds ,
                                                                               nfds_t __nfds ,
                                                                               int __timeout ) 
{ 
  unsigned long tmp ;
  int tmp___0 ;
  unsigned long tmp___4 ;
  int tmp___5 ;

  {
#line 38
  tmp___4 = __builtin_object_size((void *)__fds, 1);
#line 38
  if (tmp___4 != 0xffffffffffffffffUL) {
#line 41
    tmp = __builtin_object_size((void *)__fds, 1);
#line 41
    tmp___0 = __poll_chk(__fds, __nfds, __timeout, tmp);
#line 41
    return (tmp___0);
  }
#line 46
  tmp___5 = __poll_alias(__fds, __nfds, __timeout);
#line 46
  return (tmp___5);
}
}
#line 41 "datastructures.h"
char *get_value(struct name_value_pair_dllst *the_list , char *name ) ;
#line 42
void free_name_value_pair_dllst(struct name_value_pair_dllst *the_list ) ;
#line 42 "cpcd_util.h"
int clean_url_r(char *url , char **clean_url , int buff_size ) ;
#line 43
int verify_url(struct cpcd_ctx *ctx___0 , char *data ) ;
#line 44
int need_more_caches(struct hosts *caches , int max ) ;
#line 49
int write_pid_file(char *file_loc ) ;
#line 50
int delete_pid_file(char *file_loc ) ;
#line 55
int write_file(struct cpcd_config *config , struct hosts *cached_hosts , char *network ) ;
#line 62
int connect_nonblock(struct cpcd_ctx *ctx___0 , int *skt , struct sockaddr *addr ,
                     unsigned int len ) ;
#line 63
int write_line_to_socket(int skt , char *the_line ) ;
#line 64
int read_line(int skt , unsigned char *buffer , unsigned int read_len ) ;
#line 67
int log_access(FILE *log , char *ip , unsigned int code , char *request , unsigned long bytes ,
               char *client ) ;
#line 21 "cpcd_config.h"
int init_config(struct cpcd_ctx **ctx___0 , struct cpcd_config **config ) ;
#line 21 "cpcd_html.h"
long html_page(int c , struct cpcd_ctx *ctx___0 ) ;
#line 22
long stats_page(int c , struct cpcd_ctx *ctx___0 ) ;
#line 27 "cgi.h"
struct name_value_pair_dllst *parse_name_value_pairs_r(char *data ) ;
#line 28
int hex_to_ascii(char *s ) ;
#line 45 "cpcd.h"
int process_update(char *ip , char *url , struct networks *current_network ) ;
#line 48
long print_cached_hosts(int c , struct hosts *cached_hosts , int mode , int version ,
                        char *current_net ) ;
#line 51
int accept_connect(int c , struct cpcd_config *config ) ;
#line 54
void inthandler(int i ) ;
#line 57
void *thread_main(void *arg ) ;
#line 58
void *ip_verify_thread_main(void *nothing ) ;
#line 59
void *url_verify_thread_main(void *nothing ) ;
#line 60
void *file_writer_thread_main(void *nothing ) ;
#line 62
int process_node(struct queue *the_item ) ;
#line 63
int process_url(struct queue *the_item ) ;
#line 64
int write_files(void) ;
#line 67
int verify_node(char *ip , char *net_name , int port_restrict ) ;
#line 68
int process_ultrapeers(char *peers , struct networks *current_network ) ;
#line 69
int cache_known_bad(struct cpcd_ctx **ctx___0 , char *url ) ;
#line 71 "cpcd.h"
static pthread_mutex_t data_mutex  =    {{0, 0U, 0, 0U, 0, 0, {(struct __pthread_internal_list *)0, (struct __pthread_internal_list *)0}}};
#line 72 "cpcd.h"
static pthread_mutex_t ip_queue_mutex  =    {{0, 0U, 0, 0U, 0, 0, {(struct __pthread_internal_list *)0, (struct __pthread_internal_list *)0}}};
#line 73 "cpcd.h"
static pthread_mutex_t url_queue_mutex  =    {{0, 0U, 0, 0U, 0, 0, {(struct __pthread_internal_list *)0, (struct __pthread_internal_list *)0}}};
#line 19 "cpcd.c"
struct cpcd_ctx *ctx  =    (struct cpcd_ctx *)((void *)0);
#line 20 "cpcd.c"
int listenfd  =    0;
#line 23 "cpcd.c"
int main(int argc , char **argv ) 
{ 
  struct sockaddr_in addr_srvr ;
  struct linger so_linger ;
  char *srvr_addr ;
  char *srvr_port ;
  int z ;
  unsigned char buff[128] ;
  int arg ;
  int i ;
  int on ;
  struct sockaddr *cliaddr ;
  pthread_t url_verify_thread ;
  pthread_t file_writer_thread ;
  pthread_t *tptr ;
  pthread_t *vtptr ;
  __uid_t tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  char *tmp___2 ;
  char *tmp___3 ;
  FILE *tmp___4 ;
  register unsigned short __v ;
  register unsigned short __x ;
  int tmp___5 ;
  int tmp___6 ;
  void *tmp___7 ;
  void *tmp___8 ;

  {
#line 30
  srvr_addr = (char *)((void *)0);
#line 31
  srvr_port = (char *)((void *)0);
#line 33
  z = 0;
#line 37
  arg = 0;
#line 39
  i = 0;
#line 40
  on = 1;
#line 42
  cliaddr = (struct sockaddr *)((void *)0);
#line 45
  tptr = (pthread_t *)((void *)0);
#line 46
  vtptr = (pthread_t *)((void *)0);
#line 49
  tmp = geteuid();
#line 49
  if (tmp == 0U) {
#line 51
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"CPCD: This program may not be run as root.\n");
#line 52
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"CPCD: Please, drop your privlidges and re-launch.\n\n");
#line 54
    return (-1);
  }
#line 57
  memset((void *)(buff), 0, (size_t )128);
#line 59
  tmp___0 = malloc(sizeof(struct cpcd_ctx ));
#line 59
  ctx = (struct cpcd_ctx *)tmp___0;
#line 60
  if ((unsigned long )ctx == (unsigned long )((void *)0)) {
#line 62
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"CPCD: Failed to malloc. System out of memory.\n");
#line 64
    return (-1);
  }
#line 66
  init_context(& ctx);
#line 67
  tmp___1 = malloc(sizeof(struct cpcd_config ));
#line 67
  ctx->config = (struct cpcd_config *)tmp___1;
#line 68
  if ((unsigned long )ctx->config == (unsigned long )((void *)0)) {
#line 70
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"CPCD: Failed to malloc. System out of memory.\n");
#line 71
    free_context(ctx);
#line 73
    return (-1);
  }
#line 75
  init_config(& ctx, & ctx->config);
#line 76
  if (argc > 0) {
#line 78
    arg = 1;
#line 78
    while (arg < argc) {
#line 80
      if ((int )*(*(argv + arg) + 0) == 45) {
#line 82
        if ((int )*(*(argv + arg) + 1) == 45) {
#line 84
          tmp___3 = strstr((char const   *)*(argv + arg), "help");
#line 84
          if ((unsigned long )tmp___3 != (unsigned long )((void *)0)) {
#line 86
            printf((char const   * __restrict  )"Usage: cpcd\n");
#line 87
            printf((char const   * __restrict  )"\t-v Verbose Mode\n");
#line 88
            printf((char const   * __restrict  )"\t-h This Help Text\n");
#line 89
            printf((char const   * __restrict  )"\t--help This Help Text\n");
#line 90
            printf((char const   * __restrict  )"\t--version Display Version Information\n");
#line 91
            printf((char const   * __restrict  )"\n");
#line 92
            free_context(ctx);
#line 94
            return (0);
          } else {
#line 96
            tmp___2 = strstr((char const   *)*(argv + arg), "version");
#line 96
            if ((unsigned long )tmp___2 != (unsigned long )((void *)0)) {
#line 98
              printf((char const   * __restrict  )"%s\n", (ctx->config)->cpcd_version);
#line 99
              free_context(ctx);
#line 101
              return (0);
            }
          }
        } else
#line 104
        if ((int )*(*(argv + arg) + 1) == 118) {
#line 106
          ctx->verbose = 1;
        } else {
#line 110
          printf((char const   * __restrict  )"Usage: cpcd\n");
#line 111
          printf((char const   * __restrict  )"\t-v Verbose Mode\n");
#line 112
          printf((char const   * __restrict  )"\t-h This Help Text\n");
#line 113
          printf((char const   * __restrict  )"\t--help This Help Text\n");
#line 114
          printf((char const   * __restrict  )"\t--version Display Version Information\n");
#line 115
          printf((char const   * __restrict  )"\n");
#line 116
          free_context(ctx);
#line 118
          return (0);
        }
      }
#line 78
      arg ++;
    }
  }
#line 123
  write_pid_file((ctx->config)->pid_file);
#line 125
  if ((ctx->config)->cpcd_keep_log == 1) {
#line 127
    tmp___4 = fopen((char const   * __restrict  )((ctx->config)->log_file), (char const   * __restrict  )"a");
#line 127
    ctx->log = tmp___4;
#line 127
    if ((unsigned long )((void *)0) == (unsigned long )tmp___4) {
#line 129
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to open log file.  Not logging.\n\n");
    }
  }
#line 133
  signal(2, & inthandler);
#line 134
  signal(15, & inthandler);
#line 135
  signal(13, (void (*)(int  ))1);
#line 137
  srvr_addr = (char *)((ctx->config)->bind_ip);
#line 138
  srvr_port = (char *)((ctx->config)->web_bind_port);
#line 140
  listenfd = socket(2, 1, 0);
#line 141
  if (listenfd == -1) {
#line 143
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Socket call failed.\n");
#line 144
    delete_pid_file((ctx->config)->pid_file);
#line 145
    free_context(ctx);
#line 147
    return (-1);
  }
#line 150
  so_linger.l_onoff = 1;
#line 151
  so_linger.l_linger = 3;
#line 152
  setsockopt(listenfd, 1, 13, (void const   *)(& so_linger), (socklen_t )sizeof(so_linger));
#line 153
  setsockopt(listenfd, 1, 2, (void const   *)(& on), (socklen_t )sizeof(on));
#line 154
  memset((void *)(& addr_srvr), 0, sizeof(addr_srvr));
#line 155
  addr_srvr.sin_family = (sa_family_t )2;
#line 156
  tmp___5 = atoi((char const   *)srvr_port);
#line 156
  __x = (unsigned short )tmp___5;
#line 156
  __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 156
  addr_srvr.sin_port = __v;
#line 157
  addr_srvr.sin_addr.s_addr = inet_addr((char const   *)srvr_addr);
#line 159
  z = bind(listenfd, (struct sockaddr  const  *)((struct sockaddr *)(& addr_srvr)),
           (socklen_t )sizeof(addr_srvr));
#line 160
  if (z == -1) {
#line 162
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"bind call failed on z\n");
#line 163
    delete_pid_file((ctx->config)->pid_file);
#line 164
    free_context(ctx);
#line 166
    return (-1);
  }
#line 169
  tmp___6 = listen(listenfd, 4);
#line 169
  if (tmp___6 == -1) {
#line 171
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed on listen\n");
#line 172
    delete_pid_file((ctx->config)->pid_file);
#line 173
    free_context(ctx);
#line 175
    return (-1);
  }
#line 179
  if (ctx->verbose == 1) {
#line 180
    printf((char const   * __restrict  )"Creating thread pools...\n");
  }
#line 181
  tmp___7 = calloc((size_t )(ctx->config)->listen_threads, sizeof(pthread_t ));
#line 181
  tptr = (pthread_t *)tmp___7;
#line 182
  i = 0;
#line 182
  while (i < (ctx->config)->listen_threads) {
#line 184
    pthread_create((pthread_t * __restrict  )(tptr + i), (pthread_attr_t const   * __restrict  )((void *)0),
                   & thread_main, (void * __restrict  )((void *)0));
#line 182
    i ++;
  }
#line 186
  tmp___8 = calloc((size_t )(ctx->config)->host_threads, sizeof(pthread_t ));
#line 186
  vtptr = (pthread_t *)tmp___8;
#line 187
  i = 0;
#line 187
  while (i < (ctx->config)->host_threads) {
#line 189
    pthread_create((pthread_t * __restrict  )(vtptr + i), (pthread_attr_t const   * __restrict  )((void *)0),
                   & ip_verify_thread_main, (void * __restrict  )((void *)0));
#line 187
    i ++;
  }
#line 191
  pthread_create((pthread_t * __restrict  )(& url_verify_thread), (pthread_attr_t const   * __restrict  )((void *)0),
                 & url_verify_thread_main, (void * __restrict  )((void *)0));
#line 192
  pthread_create((pthread_t * __restrict  )(& file_writer_thread), (pthread_attr_t const   * __restrict  )((void *)0),
                 & file_writer_thread_main, (void * __restrict  )((void *)0));
#line 194
  while (ctx->exit_flag != 1) {
#line 196
    pause();
  }
#line 199
  if (ctx->verbose == 1) {
#line 201
    printf((char const   * __restrict  )"Exiting...\n");
#line 202
    printf((char const   * __restrict  )"\tShutting Down sockets...\n");
  }
#line 204
  shutdown(listenfd, 2);
#line 205
  close(listenfd);
#line 207
  if ((unsigned long )cliaddr != (unsigned long )((void *)0)) {
#line 208
    free((void *)cliaddr);
  }
#line 210
  if (ctx->verbose == 1) {
#line 212
    printf((char const   * __restrict  )"\tCanceling threads...\n");
  }
#line 215
  if ((unsigned long )tptr != (unsigned long )((void *)0)) {
#line 217
    i = 0;
#line 217
    while (i < (ctx->config)->listen_threads) {
#line 219
      if ((unsigned long )(tptr + i) != (unsigned long )((void *)0)) {
#line 221
        pthread_cancel(*(tptr + i));
#line 222
        pthread_join(*(tptr + i), (void **)((void *)0));
      }
#line 217
      i ++;
    }
#line 225
    free((void *)tptr);
  }
#line 227
  if ((unsigned long )vtptr != (unsigned long )((void *)0)) {
#line 229
    i = 0;
#line 229
    while (i < (ctx->config)->host_threads) {
#line 231
      if ((unsigned long )(vtptr + i) != (unsigned long )((void *)0)) {
#line 233
        pthread_cancel(*(vtptr + i));
#line 234
        pthread_join(*(vtptr + i), (void **)((void *)0));
      }
#line 229
      i ++;
    }
#line 237
    free((void *)vtptr);
  }
#line 239
  pthread_join(url_verify_thread, (void **)((void *)0));
#line 240
  pthread_join(file_writer_thread, (void **)((void *)0));
#line 243
  if (ctx->verbose == 1) {
#line 245
    printf((char const   * __restrict  )"\tWriting Files...\n");
  }
#line 247
  write_files();
#line 250
  if (ctx->verbose == 1) {
#line 251
    printf((char const   * __restrict  )"\tFreeing Memory...\n");
  }
#line 253
  free_networks(ctx->networks);
#line 254
  ctx->networks = (struct networks *)((void *)0);
#line 256
  if ((unsigned long )ctx->bad_caches != (unsigned long )((void *)0)) {
#line 258
    free_cached_hosts(ctx->bad_caches);
#line 259
    ctx->bad_caches = (struct hosts *)((void *)0);
  }
#line 262
  if (ctx->verbose == 1) {
#line 263
    printf((char const   * __restrict  )"\tClosing Log...\n");
  }
#line 264
  if ((ctx->config)->cpcd_keep_log == 1) {
#line 266
    if ((unsigned long )ctx->log != (unsigned long )((void *)0)) {
#line 268
      fclose(ctx->log);
    }
  }
#line 272
  if (ctx->verbose == 1) {
#line 273
    printf((char const   * __restrict  )"\tDestroying Context...\n");
  }
#line 274
  delete_pid_file((ctx->config)->pid_file);
#line 275
  if (ctx->verbose == 1) {
#line 276
    printf((char const   * __restrict  )"Done.\n");
  }
#line 277
  free_context(ctx);
#line 279
  return (0);
}
}
#line 283 "cpcd.c"
void inthandler(int i ) 
{ 


  {
#line 285
  ctx->exit_flag = 1;
#line 287
  return;
}
}
#line 291 "cpcd.c"
void *thread_main(void *arg ) 
{ 
  int c ;
  socklen_t inet_length ;
  struct sockaddr cliaddr ;

  {
#line 293
  c = 0;
#line 298
  inet_length = (socklen_t )sizeof(struct sockaddr_in );
#line 299
  while (ctx->exit_flag != 1) {
#line 302
    c = accept(listenfd, (struct sockaddr * __restrict  )(& cliaddr), (socklen_t * __restrict  )(& inet_length));
#line 303
    if (c == -1) {
#line 305
      continue;
    }
#line 308
    (ctx->total_hits) ++;
#line 309
    if (ctx->verbose == 1) {
#line 311
      if (ctx->total_hits % 100UL == 0UL) {
#line 313
        printf((char const   * __restrict  )"Total Hits: %ln\n", & ctx->total_hits);
      }
    }
#line 317
    accept_connect(c, ctx->config);
#line 319
    shutdown(c, 2);
#line 320
    close(c);
  }
#line 323
  return ((void *)0);
}
}
#line 327 "cpcd.c"
void *file_writer_thread_main(void *nothing ) 
{ 
  unsigned int i ;

  {
#line 329
  i = 0U;
#line 332
  while (ctx->exit_flag != 1) {
#line 334
    i = 0U;
#line 334
    while (i < 100U) {
#line 336
      if (ctx->exit_flag == 1) {
#line 338
        break;
      } else {
#line 342
        sleep(3U);
      }
#line 334
      i ++;
    }
#line 345
    write_files();
  }
#line 348
  return ((void *)0);
}
}
#line 352 "cpcd.c"
int write_files(void) 
{ 
  struct networks *walk_net ;

  {
#line 354
  walk_net = (struct networks *)((void *)0);
#line 357
  pthread_mutex_lock(& data_mutex);
#line 358
  walk_net = get_first_network(ctx->networks);
#line 359
  while ((unsigned long )walk_net != (unsigned long )((void *)0)) {
#line 361
    write_file(ctx->config, walk_net->hosts, walk_net->name);
#line 363
    walk_net = walk_net->next;
  }
#line 365
  write_file(ctx->config, ctx->bad_caches, (char *)"bad_caches");
#line 366
  pthread_mutex_unlock(& data_mutex);
#line 368
  return (0);
}
}
#line 372 "cpcd.c"
void *ip_verify_thread_main(void *nothing ) 
{ 
  struct queue *work_item ;
  struct queue *tmp ;

  {
#line 374
  work_item = (struct queue *)((void *)0);
#line 377
  while (ctx->exit_flag != 1) {
#line 379
    pthread_mutex_lock(& ip_queue_mutex);
#line 380
    tmp = pop_entry(& ctx->host_queue);
#line 380
    work_item = tmp;
#line 381
    pthread_mutex_unlock(& ip_queue_mutex);
#line 382
    if ((unsigned long )work_item == (unsigned long )((void *)0)) {
#line 384
      sleep(1U);
    } else {
#line 388
      process_node(work_item);
#line 389
      free_queue_item(work_item);
    }
  }
#line 393
  return ((void *)0);
}
}
#line 397 "cpcd.c"
int process_node(struct queue *the_item ) 
{ 
  struct hosts *oldest_host ;
  struct networks *current_net ;
  int host_count ;
  unsigned long bdate ;
  time_t time_of_discovery ;
  int tmp ;

  {
#line 399
  oldest_host = (struct hosts *)((void *)0);
#line 400
  current_net = (struct networks *)((void *)0);
#line 401
  host_count = 0;
#line 402
  bdate = 0UL;
#line 404
  time_of_discovery = (time_t )0;
#line 407
  time_of_discovery = time((time_t *)((void *)0));
#line 409
  current_net = get_network_by_name(ctx->networks, the_item->net_name);
#line 410
  if ((unsigned long )current_net == (unsigned long )((void *)0)) {
#line 412
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"get_network_by_name() returned NULL\n");
#line 414
    return (-1);
  }
#line 417
  tmp = verify_node(the_item->data, the_item->net_name, (ctx->config)->port_restriction);
#line 417
  if (tmp != -1) {
#line 419
    time_of_discovery = time((time_t *)((void *)0));
#line 421
    pthread_mutex_lock(& data_mutex);
#line 424
    bdate = node_already_exists(current_net->hosts, the_item->data);
#line 425
    if (bdate == 0UL) {
#line 427
      host_count = count_nodes(current_net->hosts, 2);
#line 428
      if ((ctx->config)->max_hosts < host_count) {
#line 430
        current_net->hosts = trim_struct_to_max(current_net->hosts, (ctx->config)->max_hosts,
                                                (char)2);
      }
#line 432
      if ((ctx->config)->max_hosts == host_count) {
#line 434
        oldest_host = get_oldest_host(current_net->hosts, 2);
#line 435
        current_net->hosts = delete_cached_host(oldest_host);
      }
#line 437
      current_net->hosts = add_new_cached_host(current_net->hosts, (char *)"H", the_item->data,
                                               time_of_discovery);
    }
#line 440
    pthread_mutex_unlock(& data_mutex);
  }
#line 443
  return (0);
}
}
#line 447 "cpcd.c"
void *url_verify_thread_main(void *nothing ) 
{ 
  struct queue *work_item ;
  struct queue *tmp ;

  {
#line 449
  work_item = (struct queue *)((void *)0);
#line 452
  while (ctx->exit_flag != 1) {
#line 454
    pthread_mutex_lock(& url_queue_mutex);
#line 455
    tmp = pop_entry(& ctx->url_queue);
#line 455
    work_item = tmp;
#line 456
    pthread_mutex_unlock(& url_queue_mutex);
#line 457
    if ((unsigned long )work_item == (unsigned long )((void *)0)) {
#line 459
      sleep(1U);
    } else {
#line 463
      process_url(work_item);
#line 464
      free_queue_item(work_item);
    }
  }
#line 468
  return ((void *)0);
}
}
#line 472 "cpcd.c"
int process_url(struct queue *the_item ) 
{ 
  struct hosts *oldest_url ;
  struct networks *current_network ;
  time_t time_of_discovery ;
  int url_count ;
  int rslt ;
  size_t url_len ;
  unsigned long bdate ;

  {
#line 474
  oldest_url = (struct hosts *)((void *)0);
#line 475
  current_network = (struct networks *)((void *)0);
#line 478
  url_count = 0;
#line 479
  rslt = 0;
#line 480
  url_len = (size_t )0;
#line 481
  bdate = 0UL;
#line 484
  url_len = strlen((char const   *)the_item->data);
#line 485
  if (url_len < 12UL) {
#line 486
    return (0);
  }
#line 488
  rslt = verify_url(ctx, the_item->data);
#line 489
  if (rslt == -1) {
#line 491
    return (0);
  }
#line 494
  time_of_discovery = time((time_t *)((void *)0));
#line 495
  pthread_mutex_lock(& data_mutex);
#line 496
  if (rslt == -1) {
#line 496
    goto _L;
  } else
#line 496
  if (rslt == 0) {
    _L: /* CIL Label */ 
#line 498
    bdate = node_already_exists(ctx->bad_caches, the_item->data);
#line 499
    if (bdate == 0UL) {
#line 501
      url_count = count_nodes(ctx->bad_caches, 3);
#line 502
      if ((ctx->config)->max_bad_urls < url_count) {
#line 504
        ctx->bad_caches = trim_struct_to_max(ctx->bad_caches, (ctx->config)->max_bad_urls,
                                             (char)3);
      }
#line 506
      if ((ctx->config)->max_bad_urls == url_count) {
#line 508
        oldest_url = get_oldest_host(ctx->bad_caches, 3);
#line 509
        ctx->bad_caches = delete_cached_host(oldest_url);
      }
#line 511
      ctx->bad_caches = add_new_cached_host(ctx->bad_caches, (char *)"U", the_item->data,
                                            time_of_discovery);
    }
  }
#line 514
  if (rslt == 1) {
#line 516
    current_network = get_network_by_name(ctx->networks, (char *)"gnutella");
#line 517
    if ((unsigned long )current_network == (unsigned long )((void *)0)) {
#line 519
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"get_network_by_name() returned NULL\n");
    }
#line 521
    bdate = node_already_exists(current_network->hosts, the_item->data);
#line 522
    if (bdate == 0UL) {
#line 524
      url_count = count_nodes(current_network->hosts, 3);
#line 525
      if ((ctx->config)->max_urls < url_count) {
#line 527
        current_network->hosts = trim_struct_to_max(current_network->hosts, (ctx->config)->max_urls,
                                                    (char)3);
      }
#line 529
      if ((ctx->config)->max_urls == url_count) {
#line 531
        oldest_url = get_oldest_host(current_network->hosts, 3);
#line 532
        current_network->hosts = delete_cached_host(oldest_url);
      }
#line 534
      current_network->hosts = add_new_cached_host(current_network->hosts, (char *)"U",
                                                   the_item->data, time_of_discovery);
    }
  } else
#line 537
  if (rslt == 2) {
#line 539
    current_network = get_network_by_name(ctx->networks, (char *)"gnutella2");
#line 540
    if ((unsigned long )current_network == (unsigned long )((void *)0)) {
#line 542
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"get_network_by_name() returned NULL\n");
    }
#line 544
    bdate = node_already_exists(current_network->hosts, the_item->data);
#line 545
    if (bdate == 0UL) {
#line 547
      url_count = count_nodes(current_network->hosts, 3);
#line 548
      if ((ctx->config)->max_urls < url_count) {
#line 550
        current_network->hosts = trim_struct_to_max(current_network->hosts, (ctx->config)->max_urls,
                                                    (char)3);
      }
#line 552
      if ((ctx->config)->max_urls == url_count) {
#line 554
        oldest_url = get_oldest_host(current_network->hosts, 3);
#line 555
        current_network->hosts = delete_cached_host(oldest_url);
      }
#line 557
      current_network->hosts = add_new_cached_host(current_network->hosts, (char *)"U",
                                                   the_item->data, time_of_discovery);
    }
  } else
#line 560
  if (rslt == 3) {
#line 563
    current_network = get_network_by_name(ctx->networks, (char *)"gnutella");
#line 564
    if ((unsigned long )current_network == (unsigned long )((void *)0)) {
#line 566
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"get_network_by_name() returned NULL\n");
    }
#line 568
    bdate = node_already_exists(current_network->hosts, the_item->data);
#line 569
    if (bdate == 0UL) {
#line 571
      url_count = count_nodes(current_network->hosts, 3);
#line 572
      if ((ctx->config)->max_urls < url_count) {
#line 574
        current_network->hosts = trim_struct_to_max(current_network->hosts, (ctx->config)->max_urls,
                                                    (char)3);
      }
#line 576
      if ((ctx->config)->max_urls == url_count) {
#line 578
        oldest_url = get_oldest_host(current_network->hosts, 3);
#line 579
        current_network->hosts = delete_cached_host(oldest_url);
      }
#line 581
      current_network->hosts = add_new_cached_host(current_network->hosts, (char *)"U",
                                                   the_item->data, time_of_discovery);
    }
#line 584
    current_network = get_network_by_name(ctx->networks, (char *)"gnutella2");
#line 585
    if ((unsigned long )current_network == (unsigned long )((void *)0)) {
#line 587
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"get_network_by_name() returned NULL\n");
    }
#line 589
    bdate = node_already_exists(current_network->hosts, the_item->data);
#line 590
    if (bdate == 0UL) {
#line 592
      url_count = count_nodes(current_network->hosts, 3);
#line 593
      if ((ctx->config)->max_urls < url_count) {
#line 595
        current_network->hosts = trim_struct_to_max(current_network->hosts, (ctx->config)->max_urls,
                                                    (char)3);
      }
#line 597
      if ((ctx->config)->max_urls == url_count) {
#line 599
        oldest_url = get_oldest_host(current_network->hosts, 3);
#line 600
        current_network->hosts = delete_cached_host(oldest_url);
      }
#line 602
      current_network->hosts = add_new_cached_host(current_network->hosts, (char *)"U",
                                                   the_item->data, time_of_discovery);
    }
  }
#line 605
  pthread_mutex_unlock(& data_mutex);
#line 607
  return (0);
}
}
#line 611 "cpcd.c"
int accept_connect(int c , struct cpcd_config *config ) 
{ 
  struct name_value_pair_dllst *form ;
  char remote_address[256] ;
  char *client ;
  char *version ;
  char *hostfile ;
  char *urlfile ;
  char *net ;
  char *get ;
  char *ip ;
  char *url ;
  char *update ;
  char *ping ;
  char *cluster ;
  char *stats ;
  int get_alt_nets ;
  int guess_version ;
  unsigned long z ;
  char bufftrash[256] ;
  char buff[256] ;
  char buff2[256] ;
  char *buff_ptr ;
  char log_client[256] ;
  char log_request[256] ;
  char *log_client_p ;
  char *log_request_p ;
  unsigned long total_bytes ;
  unsigned int code ;
  int rslt ;
  long lrslt ;
  struct sockaddr_in peer ;
  int namelen ;
  struct networks *current_network ;
  int tmp ;
  size_t tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  size_t tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;
  void *tmp___6 ;
  void *tmp___7 ;
  long tmp___8 ;
  long tmp___9 ;
  size_t tmp___10 ;
  void *tmp___11 ;
  long tmp___12 ;
  long tmp___13 ;
  long tmp___14 ;
  char *tmp___15 ;
  char *tmp___16 ;
  char *tmp___17 ;

  {
#line 613
  form = (struct name_value_pair_dllst *)((void *)0);
#line 619
  client = (char *)((void *)0);
#line 620
  version = (char *)((void *)0);
#line 621
  hostfile = (char *)((void *)0);
#line 622
  urlfile = (char *)((void *)0);
#line 623
  net = (char *)((void *)0);
#line 624
  get = (char *)((void *)0);
#line 625
  ip = (char *)((void *)0);
#line 626
  url = (char *)((void *)0);
#line 627
  update = (char *)((void *)0);
#line 628
  ping = (char *)((void *)0);
#line 629
  cluster = (char *)((void *)0);
#line 630
  stats = (char *)((void *)0);
#line 633
  get_alt_nets = 0;
#line 634
  guess_version = 0;
#line 636
  z = 0UL;
#line 641
  buff_ptr = (char *)((void *)0);
#line 646
  log_client_p = (char *)((void *)0);
#line 647
  log_request_p = (char *)((void *)0);
#line 648
  total_bytes = 0UL;
#line 649
  code = 200U;
#line 651
  rslt = 0;
#line 652
  lrslt = 0L;
#line 655
  namelen = 0;
#line 657
  current_network = (struct networks *)((void *)0);
#line 660
  memset((void *)(buff), 0, (size_t )256);
#line 663
  tmp = read_line(c, (unsigned char *)(buff), 255U);
#line 663
  z = (unsigned long )tmp;
#line 664
  if (z < 2UL) {
#line 666
    return (-1);
  } else
#line 668
  if (z == 0xffffffffffffffffUL) {
#line 670
    return (-1);
  }
#line 673
  memset((void *)(buff2), 0, (size_t )256);
#line 674
  memset((void *)(bufftrash), 0, (size_t )256);
#line 675
  memset((void *)(log_request), 0, (size_t )256);
#line 676
  memset((void *)(log_client), 0, (size_t )256);
#line 677
  memset((void *)(remote_address), 0, (size_t )256);
#line 680
  tmp___0 = strlen((char const   *)(buff));
#line 680
  buff[tmp___0 - 2UL] = (char )'\000';
#line 681
  strncpy((char * __restrict  )(log_request), (char const   * __restrict  )(buff),
          (size_t )255);
#line 682
  log_request_p = & log_request[0];
#line 683
  tmp___1 = memcmp((void const   *)(log_request), (void const   *)"GET /pwc.cgi ",
                   (size_t )13);
#line 683
  if (tmp___1 != 0) {
#line 683
    tmp___2 = memcmp((void const   *)(log_request), (void const   *)"GET /pwc.cgi?",
                     (size_t )13);
#line 683
    if (tmp___2 != 0) {
#line 686
      code = 404U;
    } else {
#line 690
      code = 200U;
    }
  } else {
#line 690
    code = 200U;
  }
#line 693
  tmp___4 = strncasecmp("GET", (char const   *)(buff), (size_t )3);
#line 693
  if (tmp___4 == 0) {
#line 696
    while (1) {
#line 698
      rslt = read_line(c, (unsigned char *)(bufftrash), 255U);
#line 696
      if ((int )bufftrash[0] == 10) {
#line 696
        goto _L___0;
      } else
#line 696
      if ((int )bufftrash[0] == 13) {
        _L___0: /* CIL Label */ 
#line 696
        tmp___3 = strlen((char const   *)(bufftrash));
#line 696
        if (tmp___3 < 3UL) {
#line 696
          break;
        } else {
#line 696
          goto _L;
        }
      } else
      _L: /* CIL Label */ 
#line 696
      if (! (rslt > 2)) {
#line 696
        break;
      }
    }
  }
#line 704
  tmp___5 = hex_to_ascii(buff);
#line 704
  if (tmp___5 == -1) {
#line 706
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"hex_to_ascii failure\n");
#line 708
    return (-1);
  }
#line 710
  tmp___6 = memchr((void const   *)(buff), '|', (size_t )255);
#line 710
  if ((unsigned long )tmp___6 != (unsigned long )((void *)0)) {
#line 712
    rslt = write_line_to_socket(c, (char *)"Meta characters are not allowed in requests.\n");
#line 713
    if (rslt != -1) {
#line 714
      total_bytes += (unsigned long )rslt;
    }
#line 716
    return (0);
  }
#line 718
  tmp___7 = memchr((void const   *)(buff), '?', (size_t )255);
#line 718
  buff_ptr = (char *)tmp___7;
#line 719
  if ((unsigned long )buff_ptr == (unsigned long )((void *)0)) {
#line 721
    tmp___8 = html_page(c, ctx);
#line 721
    rslt = (int )tmp___8;
#line 722
    if (rslt != -1) {
#line 723
      total_bytes += (unsigned long )rslt;
    }
#line 725
    return (0);
  }
#line 727
  buff_ptr ++;
#line 728
  if ((unsigned long )buff_ptr == (unsigned long )((void *)0)) {
#line 730
    tmp___9 = html_page(c, ctx);
#line 730
    rslt = (int )tmp___9;
#line 731
    if (rslt != -1) {
#line 732
      total_bytes += (unsigned long )rslt;
    }
#line 734
    return (0);
  }
#line 736
  tmp___10 = strlen((char const   *)buff_ptr);
#line 736
  strncpy((char * __restrict  )(buff2), (char const   * __restrict  )buff_ptr, tmp___10 + 1UL);
#line 737
  tmp___11 = memchr((void const   *)(buff2), ' ', (size_t )255);
#line 737
  buff_ptr = (char *)tmp___11;
#line 738
  if ((unsigned long )buff_ptr == (unsigned long )((void *)0)) {
#line 740
    tmp___12 = html_page(c, ctx);
#line 740
    rslt = (int )tmp___12;
#line 741
    if (rslt != -1) {
#line 742
      total_bytes += (unsigned long )rslt;
    }
#line 744
    return (0);
  }
#line 746
  *(buff_ptr + 0) = (char )'\000';
#line 747
  form = parse_name_value_pairs_r(buff2);
#line 748
  if ((unsigned long )form == (unsigned long )((void *)0)) {
#line 751
    tmp___13 = html_page(c, ctx);
#line 751
    rslt = (int )tmp___13;
#line 752
    if (rslt != -1) {
#line 753
      total_bytes += (unsigned long )rslt;
    }
#line 755
    return (0);
  }
#line 758
  stats = get_value(form, (char *)"stats");
#line 759
  if ((unsigned long )stats != (unsigned long )((void *)0)) {
#line 761
    tmp___14 = stats_page(c, ctx);
#line 761
    rslt = (int )tmp___14;
#line 762
    if (rslt != -1) {
#line 763
      total_bytes += (unsigned long )rslt;
    }
#line 765
    if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 767
      free_name_value_pair_dllst(form);
    }
#line 770
    return (0);
  } else {
#line 774
    client = get_value(form, (char *)"client");
#line 775
    version = get_value(form, (char *)"version");
#line 776
    hostfile = get_value(form, (char *)"hostfile");
#line 777
    urlfile = get_value(form, (char *)"urlfile");
#line 778
    net = get_value(form, (char *)"net");
#line 779
    get = get_value(form, (char *)"get");
#line 780
    ip = get_value(form, (char *)"ip");
#line 781
    url = get_value(form, (char *)"url");
#line 782
    update = get_value(form, (char *)"update");
#line 783
    ping = get_value(form, (char *)"ping");
#line 784
    cluster = get_value(form, (char *)"cluster");
#line 789
    snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"HTTP/1.1 %d OK\r\n",
             code);
#line 790
    rslt = write_line_to_socket(c, buff);
#line 791
    if (rslt == -1) {
#line 793
      if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 795
        free_name_value_pair_dllst(form);
      }
#line 798
      return (-1);
    } else {
#line 802
      total_bytes += (unsigned long )rslt;
    }
#line 804
    rslt = write_line_to_socket(c, (char *)"Content-type: text/plain\r\n");
#line 805
    if (rslt == -1) {
#line 807
      if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 809
        free_name_value_pair_dllst(form);
      }
#line 812
      return (-1);
    } else {
#line 816
      total_bytes += (unsigned long )rslt;
    }
#line 818
    rslt = write_line_to_socket(c, (char *)"Pragma: no-cache\r\n");
#line 819
    if (rslt == -1) {
#line 821
      if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 823
        free_name_value_pair_dllst(form);
      }
#line 826
      return (-1);
    } else {
#line 830
      total_bytes += (unsigned long )rslt;
    }
#line 832
    rslt = write_line_to_socket(c, (char *)"Cache-Control: no-store, no-cache, must-revalidate\r\n");
#line 833
    if (rslt == -1) {
#line 835
      if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 837
        free_name_value_pair_dllst(form);
      }
#line 840
      return (-1);
    } else {
#line 844
      total_bytes += (unsigned long )rslt;
    }
#line 846
    rslt = write_line_to_socket(c, (char *)"Cache-Control: post-check=0, pre-check=0\r\n");
#line 847
    if (rslt == -1) {
#line 849
      if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 851
        free_name_value_pair_dllst(form);
      }
#line 854
      return (-1);
    } else {
#line 858
      total_bytes += (unsigned long )rslt;
    }
#line 860
    namelen = (int )sizeof(peer);
#line 861
    rslt = getpeername(c, (struct sockaddr * __restrict  )((struct sockaddr *)(& peer)),
                       (socklen_t * __restrict  )(& namelen));
#line 862
    if (rslt == -1) {
#line 864
      if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 866
        free_name_value_pair_dllst(form);
      }
#line 869
      return (-1);
    }
#line 871
    tmp___15 = inet_ntoa(peer.sin_addr);
#line 871
    snprintf((char * __restrict  )(remote_address), (size_t )255, (char const   * __restrict  )"%s",
             tmp___15);
#line 872
    snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"X-Remote-IP: %s\r\n\r\n",
             remote_address);
#line 873
    rslt = write_line_to_socket(c, buff);
#line 874
    if (rslt == -1) {
#line 876
      if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 878
        free_name_value_pair_dllst(form);
      }
#line 881
      return (-1);
    } else {
#line 885
      total_bytes += (unsigned long )rslt;
    }
#line 888
    if (code == 404U) {
#line 890
      rslt = write_line_to_socket(c, (char *)"404: File not found.\n");
#line 891
      if (rslt != -1) {
#line 893
        total_bytes += (unsigned long )rslt;
      }
    } else {
#line 898
      if ((unsigned long )get == (unsigned long )((void *)0)) {
#line 901
        guess_version = 1;
      } else {
#line 906
        guess_version = 2;
      }
#line 910
      if ((unsigned long )ping != (unsigned long )((void *)0)) {
#line 912
        if (guess_version == 1) {
#line 914
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"PONG %s\n",
                   (ctx->config)->cpcd_version);
#line 915
          rslt = write_line_to_socket(c, buff);
#line 916
          if (rslt == -1) {
#line 918
            if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 920
              free_name_value_pair_dllst(form);
            }
#line 923
            return (-1);
          } else {
#line 927
            total_bytes += (unsigned long )rslt;
          }
        } else {
#line 932
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"I|pong|%s\n",
                   (ctx->config)->cpcd_version);
#line 933
          rslt = write_line_to_socket(c, buff);
#line 934
          if (rslt == -1) {
#line 936
            if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 938
              free_name_value_pair_dllst(form);
            }
#line 941
            return (-1);
          } else {
#line 945
            total_bytes += (unsigned long )rslt;
          }
        }
#line 949
        if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 951
          free_name_value_pair_dllst(form);
        }
#line 954
        return (0);
      }
#line 957
      if ((unsigned long )client == (unsigned long )((void *)0)) {
#line 959
        rslt = write_line_to_socket(c, (char *)"Must send correctly formatted client version information.\n");
#line 960
        if (rslt != -1) {
#line 962
          total_bytes += (unsigned long )rslt;
        }
#line 964
        if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 966
          free_name_value_pair_dllst(form);
        }
#line 969
        return (0);
      } else {
#line 973
        tmp___16 = strstr((char const   *)((ctx->config)->default_allow), (char const   *)client);
#line 973
        if ((unsigned long )tmp___16 == (unsigned long )((void *)0)) {
#line 975
          rslt = write_line_to_socket(c, (char *)"I|client-not-supported\n");
#line 976
          if (rslt != -1) {
#line 978
            total_bytes += (unsigned long )rslt;
          }
#line 980
          if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 982
            free_name_value_pair_dllst(form);
          }
#line 985
          return (0);
        }
      }
#line 990
      if ((unsigned long )net != (unsigned long )((void *)0)) {
#line 992
        tmp___17 = strstr((char const   *)((ctx->config)->allowed_networks), (char const   *)net);
#line 992
        if ((unsigned long )tmp___17 == (unsigned long )((void *)0)) {
#line 994
          get_alt_nets = 1;
#line 995
          rslt = write_line_to_socket(c, (char *)"I|net-not-supported\n");
#line 996
          if (rslt != -1) {
#line 998
            total_bytes += (unsigned long )rslt;
          }
#line 1001
          if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 1003
            free_name_value_pair_dllst(form);
          }
#line 1006
          return (0);
        }
      } else {
#line 1011
        net = (ctx->config)->default_network;
      }
#line 1013
      current_network = get_network_by_name(ctx->networks, net);
#line 1016
      if ((unsigned long )get != (unsigned long )((void *)0)) {
#line 1018
        (ctx->reqs) ++;
#line 1020
        lrslt = print_cached_hosts(c, current_network->hosts, 1, guess_version, net);
#line 1021
        if (lrslt != -1L) {
#line 1022
          total_bytes += (unsigned long )lrslt;
        }
      } else {
#line 1026
        (ctx->reqs) ++;
#line 1027
        if ((unsigned long )urlfile != (unsigned long )((void *)0)) {
#line 1029
          lrslt = print_cached_hosts(c, current_network->hosts, 3, guess_version,
                                     net);
#line 1030
          if (lrslt != -1L) {
#line 1031
            total_bytes += (unsigned long )lrslt;
          }
        }
#line 1033
        if ((unsigned long )hostfile != (unsigned long )((void *)0)) {
#line 1035
          lrslt = print_cached_hosts(c, current_network->hosts, 2, guess_version,
                                     net);
#line 1036
          if (lrslt != -1L) {
#line 1037
            total_bytes += (unsigned long )lrslt;
          }
        }
      }
#line 1042
      if ((unsigned long )ip != (unsigned long )((void *)0)) {
#line 1042
        goto _L___1;
      } else
#line 1042
      if ((unsigned long )url != (unsigned long )((void *)0)) {
        _L___1: /* CIL Label */ 
#line 1044
        (ctx->updts) ++;
#line 1045
        process_update(ip, url, current_network);
#line 1047
        if (guess_version == 1) {
#line 1050
          rslt = write_line_to_socket(c, (char *)"OK\n");
#line 1051
          if (rslt == -1) {
#line 1053
            if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 1055
              free_name_value_pair_dllst(form);
            }
#line 1058
            return (-1);
          } else {
#line 1062
            total_bytes += (unsigned long )rslt;
          }
#line 1064
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"%s %s\n",
                   ip, url);
#line 1065
          rslt = write_line_to_socket(c, buff);
#line 1066
          if (rslt == -1) {
#line 1067
            total_bytes += (unsigned long )rslt;
          }
        } else {
#line 1071
          rslt = write_line_to_socket(c, (char *)"I|update|OK\n");
#line 1072
          if (rslt == -1) {
#line 1073
            total_bytes += (unsigned long )rslt;
          }
        }
      }
    }
  }
#line 1080
  if ((ctx->config)->cpcd_keep_log == 1) {
#line 1082
    if ((unsigned long )ctx->log != (unsigned long )((void *)0)) {
#line 1084
      snprintf((char * __restrict  )(log_client), (size_t )255, (char const   * __restrict  )"%s %s",
               client, version);
#line 1085
      log_client_p = & log_client[0];
#line 1086
      log_access(ctx->log, remote_address, (unsigned int )total_bytes, log_request_p,
                 (unsigned long )code, log_client_p);
    }
  }
#line 1091
  if ((unsigned long )form != (unsigned long )((void *)0)) {
#line 1093
    free_name_value_pair_dllst(form);
  }
#line 1096
  return (0);
}
}
#line 1100 "cpcd.c"
long print_cached_hosts(int c , struct hosts *cached_hosts , int mode , int version ,
                        char *current_net ) 
{ 
  struct hosts *walk_cached_hosts ;
  time_t current_time ;
  unsigned long secs_old ;
  char buff[256] ;
  int rslt ;
  unsigned long total_bytes ;

  {
#line 1102
  walk_cached_hosts = (struct hosts *)((void *)0);
#line 1104
  secs_old = 0UL;
#line 1106
  rslt = 0;
#line 1107
  total_bytes = 0UL;
#line 1110
  if ((unsigned long )cached_hosts == (unsigned long )((void *)0)) {
#line 1111
    return (0L);
  }
#line 1113
  memset((void *)(buff), 0, (size_t )256);
#line 1115
  current_time = time((time_t *)((void *)0));
#line 1117
  walk_cached_hosts = get_first_host(cached_hosts);
#line 1118
  if ((unsigned long )walk_cached_hosts == (unsigned long )((void *)0)) {
#line 1120
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Error Cached Hosts was NULL\n");
  }
#line 1123
  while ((unsigned long )walk_cached_hosts != (unsigned long )((void *)0)) {
#line 1125
    secs_old = (unsigned long )current_time - walk_cached_hosts->bdate;
#line 1126
    if (mode == 1) {
#line 1126
      if (version == 2) {
#line 1128
        snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"%c|%s|%ln|\n",
                 (int )walk_cached_hosts->type, walk_cached_hosts->addr, & secs_old);
#line 1129
        rslt = write_line_to_socket(c, buff);
#line 1130
        if (rslt == -1) {
#line 1132
          return (-1L);
        } else {
#line 1136
          total_bytes += (unsigned long )rslt;
        }
      } else {
#line 1126
        goto _L___2;
      }
    } else
    _L___2: /* CIL Label */ 
#line 1141
    if (mode == 2) {
#line 1141
      if (version == 2) {
#line 1143
        if ((int )walk_cached_hosts->type == 72) {
#line 1145
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"%c|%s|%ln|\n",
                   (int )walk_cached_hosts->type, walk_cached_hosts->addr, & secs_old);
#line 1146
          rslt = write_line_to_socket(c, buff);
#line 1147
          if (rslt == -1) {
#line 1149
            return (-1L);
          } else {
#line 1153
            total_bytes += (unsigned long )rslt;
          }
        }
      } else {
#line 1141
        goto _L___1;
      }
    } else
    _L___1: /* CIL Label */ 
#line 1157
    if (mode == 2) {
#line 1157
      if (version == 1) {
#line 1159
        if ((int )walk_cached_hosts->type == 72) {
#line 1161
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"%s\n",
                   walk_cached_hosts->addr);
#line 1162
          rslt = write_line_to_socket(c, buff);
#line 1163
          if (rslt == -1) {
#line 1165
            return (-1L);
          } else {
#line 1169
            total_bytes += (unsigned long )rslt;
          }
        }
      } else {
#line 1157
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 1174
    if (mode == 3) {
#line 1174
      if (version == 2) {
#line 1176
        if ((int )walk_cached_hosts->type == 85) {
#line 1178
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"%c|%s|%ln|\n",
                   (int )walk_cached_hosts->type, walk_cached_hosts->addr, & secs_old);
#line 1179
          rslt = write_line_to_socket(c, buff);
#line 1180
          if (rslt == -1) {
#line 1182
            return (-1L);
          } else {
#line 1186
            total_bytes += (unsigned long )rslt;
          }
        }
      } else {
#line 1174
        goto _L;
      }
    } else
    _L: /* CIL Label */ 
#line 1190
    if (mode == 3) {
#line 1190
      if (version == 1) {
#line 1192
        if ((int )walk_cached_hosts->type == 85) {
#line 1194
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"%s\n",
                   walk_cached_hosts->addr);
#line 1195
          rslt = write_line_to_socket(c, buff);
#line 1196
          if (rslt == -1) {
#line 1199
            return (-1L);
          } else {
#line 1203
            total_bytes += (unsigned long )rslt;
          }
        }
      }
    }
#line 1208
    walk_cached_hosts = walk_cached_hosts->next;
  }
#line 1211
  return ((long )total_bytes);
}
}
#line 1215 "cpcd.c"
int process_update(char *ip , char *url , struct networks *current_network ) 
{ 
  size_t ip_len ;
  size_t url_len ;
  char *url_ptr ;
  int rslt ;
  unsigned long age ;
  unsigned long bdate ;
  time_t now ;
  unsigned short const   **tmp ;
  char *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;
  char *tmp___3 ;
  void *tmp___4 ;
  unsigned long age___0 ;
  unsigned long bdate___0 ;
  time_t now___0 ;
  size_t __s1_len ;
  size_t __s2_len ;
  int tmp___6 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;

  {
#line 1217
  ip_len = (size_t )0;
#line 1218
  url_len = (size_t )0;
#line 1220
  url_ptr = (char *)((void *)0);
#line 1221
  rslt = 0;
#line 1225
  if ((unsigned long )ip != (unsigned long )((void *)0)) {
#line 1227
    ip_len = strlen((char const   *)ip);
#line 1228
    if (ip_len < 6UL) {
#line 1231
      return (-1);
    } else
#line 1228
    if (ip_len > 32UL) {
#line 1231
      return (-1);
    }
#line 1233
    tmp = __ctype_b_loc();
#line 1233
    if ((int const   )*(*tmp + (int )*(ip + 0)) & 2048) {
#line 1235
      age = 0UL;
#line 1236
      bdate = 0UL;
#line 1237
      now = (time_t )0;
#line 1240
      now = time((time_t *)((void *)0));
#line 1241
      bdate = node_already_exists(current_network->hosts, ip);
#line 1242
      age = (unsigned long )now - bdate;
#line 1243
      if (bdate == 0UL) {
#line 1245
        pthread_mutex_lock(& ip_queue_mutex);
#line 1246
        new_queue_entry(& ctx->host_queue, ip, current_network->name, 250);
#line 1247
        pthread_mutex_unlock(& ip_queue_mutex);
      } else
#line 1249
      if (age > 86400UL) {
#line 1251
        pthread_mutex_lock(& data_mutex);
#line 1252
        current_network->hosts = delete_cached_host_by_name(current_network->hosts,
                                                            ip);
#line 1253
        pthread_mutex_unlock(& data_mutex);
#line 1254
        pthread_mutex_lock(& ip_queue_mutex);
#line 1255
        new_queue_entry(& ctx->host_queue, ip, current_network->name, 250);
#line 1256
        pthread_mutex_unlock(& ip_queue_mutex);
      }
    }
  }
#line 1260
  if ((unsigned long )url != (unsigned long )((void *)0)) {
#line 1262
    rslt = need_more_caches(current_network->hosts, (ctx->config)->max_urls);
#line 1263
    if (rslt != 1) {
#line 1265
      return (-1);
    }
#line 1267
    tmp___0 = strstr((char const   *)url, ".asp");
#line 1267
    if ((unsigned long )tmp___0 != (unsigned long )((void *)0)) {
#line 1276
      return (-1);
    } else {
#line 1267
      tmp___1 = strstr((char const   *)url, ".php");
#line 1267
      if ((unsigned long )tmp___1 != (unsigned long )((void *)0)) {
#line 1276
        return (-1);
      } else {
#line 1267
        tmp___2 = strstr((char const   *)url, ".ASP");
#line 1267
        if ((unsigned long )tmp___2 != (unsigned long )((void *)0)) {
#line 1276
          return (-1);
        } else {
#line 1267
          tmp___3 = strstr((char const   *)url, ".PHP");
#line 1267
          if ((unsigned long )tmp___3 != (unsigned long )((void *)0)) {
#line 1276
            return (-1);
          }
        }
      }
    }
#line 1278
    tmp___4 = malloc((size_t )1024);
#line 1278
    url_ptr = (char *)tmp___4;
#line 1279
    if ((unsigned long )url_ptr == (unsigned long )((void *)0)) {
#line 1280
      return (-1);
    }
#line 1281
    memset((void *)url_ptr, 0, (size_t )1024);
#line 1282
    url_len = strlen((char const   *)url);
#line 1283
    if (url_len < 12UL) {
#line 1283
      goto _L;
    } else
#line 1283
    if (url_len > 1000UL) {
      _L: /* CIL Label */ 
#line 1285
      if ((unsigned long )url_ptr != (unsigned long )((void *)0)) {
#line 1287
        free((void *)url_ptr);
      }
#line 1290
      return (-1);
    }
#line 1293
    rslt = clean_url_r(url, & url_ptr, 1024);
#line 1294
    if (rslt == -1) {
#line 1296
      if ((unsigned long )url_ptr != (unsigned long )((void *)0)) {
#line 1298
        free((void *)url_ptr);
      }
#line 1301
      return (-1);
    }
#line 1303
    rslt = cache_known_bad(& ctx, url_ptr);
#line 1304
    if (rslt == 1) {
#line 1306
      if ((unsigned long )url_ptr != (unsigned long )((void *)0)) {
#line 1308
        free((void *)url_ptr);
      }
#line 1311
      return (-1);
    }
#line 1313
    if ((unsigned long )url_ptr != (unsigned long )((void *)0)) {
#line 1315
      if (0) {
#line 1315
        __s1_len = __builtin_strlen((char const   *)url_ptr);
#line 1315
        __s2_len = __builtin_strlen((char const   *)((ctx->config)->server_url));
#line 1315
        if (! ((size_t )((void const   *)(url_ptr + 1)) - (size_t )((void const   *)url_ptr) == 1UL)) {
#line 1315
          goto _L___1;
        } else
#line 1315
        if (__s1_len >= 4UL) {
          _L___1: /* CIL Label */ 
#line 1315
          if (! ((size_t )((void const   *)((ctx->config)->server_url + 1)) - (size_t )((void const   *)((ctx->config)->server_url)) == 1UL)) {
#line 1315
            tmp___11 = 1;
          } else
#line 1315
          if (__s2_len >= 4UL) {
#line 1315
            tmp___11 = 1;
          } else {
#line 1315
            tmp___11 = 0;
          }
        } else {
#line 1315
          tmp___11 = 0;
        }
#line 1315
        if (tmp___11) {
#line 1315
          tmp___6 = __builtin_strcmp((char const   *)url_ptr, (char const   *)((ctx->config)->server_url));
#line 1315
          tmp___10 = tmp___6;
        } else {
#line 1315
          tmp___9 = __builtin_strcmp((char const   *)url_ptr, (char const   *)((ctx->config)->server_url));
#line 1315
          tmp___10 = tmp___9;
        }
      } else {
#line 1315
        tmp___9 = __builtin_strcmp((char const   *)url_ptr, (char const   *)((ctx->config)->server_url));
#line 1315
        tmp___10 = tmp___9;
      }
#line 1315
      if (tmp___10 != 0) {
#line 1317
        age___0 = 0UL;
#line 1318
        bdate___0 = 0UL;
#line 1319
        now___0 = (time_t )0;
#line 1322
        now___0 = time((time_t *)((void *)0));
#line 1323
        bdate___0 = node_already_exists(current_network->hosts, url_ptr);
#line 1324
        age___0 = (unsigned long )now___0 - bdate___0;
#line 1325
        if (bdate___0 == 0UL) {
#line 1327
          pthread_mutex_lock(& ip_queue_mutex);
#line 1328
          new_queue_entry(& ctx->url_queue, url_ptr, current_network->name, 250);
#line 1329
          pthread_mutex_unlock(& ip_queue_mutex);
        } else
#line 1331
        if (age___0 > 86400UL) {
#line 1333
          pthread_mutex_lock(& data_mutex);
#line 1334
          current_network->hosts = delete_cached_host_by_name(current_network->hosts,
                                                              url_ptr);
#line 1335
          pthread_mutex_unlock(& data_mutex);
#line 1336
          pthread_mutex_lock(& url_queue_mutex);
#line 1337
          new_queue_entry(& ctx->url_queue, url_ptr, current_network->name, 250);
#line 1338
          pthread_mutex_unlock(& url_queue_mutex);
        }
      }
    }
#line 1342
    if ((unsigned long )url_ptr != (unsigned long )((void *)0)) {
#line 1344
      free((void *)url_ptr);
    }
  }
#line 1348
  return (0);
}
}
#line 1352 "cpcd.c"
int verify_node(char *ip , char *net_name , int port_restrict ) 
{ 
  char *oct_1_c ;
  char *oct_2_c ;
  char *oct_3_c ;
  char *oct_4_c ;
  char *port_c ;
  unsigned int oct_1 ;
  unsigned int oct_2 ;
  unsigned int oct_3 ;
  unsigned int oct_4 ;
  unsigned long port ;
  unsigned int len ;
  char node[23] ;
  char *ip_c ;
  char *ptr ;
  int code ;
  int sockfd ;
  struct sockaddr_in addr ;
  int rslt ;
  int rslt2 ;
  char tmp_buffer[256] ;
  struct networks *current_network ;
  char *tmp___0 ;
  size_t tmp___1 ;
  char *tmp___3 ;
  unsigned short const   **tmp___4 ;
  char *tmp___6 ;
  char *tmp___8 ;
  char *tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  unsigned short const   **tmp___15 ;
  long tmp___16 ;
  char *tmp___18 ;
  register unsigned short __v ;
  register unsigned short __x ;
  char *tmp___19 ;
  char *tmp___20 ;

  {
#line 1354
  oct_1_c = (char *)((void *)0);
#line 1355
  oct_2_c = (char *)((void *)0);
#line 1356
  oct_3_c = (char *)((void *)0);
#line 1357
  oct_4_c = (char *)((void *)0);
#line 1358
  port_c = (char *)((void *)0);
#line 1359
  oct_1 = 0U;
#line 1360
  oct_2 = 0U;
#line 1361
  oct_3 = 0U;
#line 1362
  oct_4 = 0U;
#line 1363
  port = 0UL;
#line 1364
  len = 0U;
#line 1366
  ip_c = (char *)((void *)0);
#line 1367
  ptr = (char *)((void *)0);
#line 1368
  code = 0;
#line 1370
  sockfd = 0;
#line 1372
  rslt = 0;
#line 1373
  rslt2 = 0;
#line 1375
  current_network = (struct networks *)((void *)0);
#line 1378
  if ((unsigned long )ip == (unsigned long )((void *)0)) {
#line 1380
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"System Error: NULL argument passed to verify_node.\n");
#line 1382
    return (-1);
  }
#line 1386
  tmp___0 = __builtin_strchr(ip, ':');
#line 1386
  if ((unsigned long )tmp___0 == (unsigned long )((void *)0)) {
#line 1388
    return (-1);
  }
#line 1390
  tmp___1 = strlen((char const   *)ip);
#line 1390
  len = (unsigned int )tmp___1;
#line 1391
  if (len < 9U) {
#line 1393
    return (-1);
  } else
#line 1391
  if (len > 21U) {
#line 1393
    return (-1);
  }
#line 1397
  memset((void *)(node), 0, (size_t )23);
#line 1398
  strncpy((char * __restrict  )(node), (char const   * __restrict  )ip, (size_t )22);
#line 1399
  ip_c = & node[0];
#line 1400
  tmp___3 = __builtin_strchr(ip_c, ':');
#line 1400
  ptr = tmp___3;
#line 1401
  if ((unsigned long )ptr == (unsigned long )((void *)0)) {
#line 1403
    return (-1);
  }
#line 1405
  port_c = ptr;
#line 1406
  port_c ++;
#line 1407
  *(ptr + 0) = (char )'\000';
#line 1409
  tmp___4 = __ctype_b_loc();
#line 1409
  if (! ((int const   )*(*tmp___4 + (int )*(ip_c + 0)) & 2048)) {
#line 1411
    return (-1);
  }
#line 1413
  oct_1_c = ip_c + 0;
#line 1414
  tmp___6 = __builtin_strchr(ip_c, '.');
#line 1414
  ptr = tmp___6;
#line 1415
  if ((unsigned long )ptr == (unsigned long )((void *)0)) {
#line 1416
    return (-1);
  }
#line 1417
  oct_2_c = ptr + 0;
#line 1418
  oct_2_c ++;
#line 1419
  *(ptr + 0) = (char )'\000';
#line 1420
  tmp___8 = __builtin_strchr(oct_2_c, '.');
#line 1420
  ptr = tmp___8;
#line 1421
  if ((unsigned long )ptr == (unsigned long )((void *)0)) {
#line 1422
    return (-1);
  }
#line 1423
  oct_3_c = ptr + 0;
#line 1424
  oct_3_c ++;
#line 1425
  *(ptr + 0) = (char )'\000';
#line 1426
  tmp___10 = __builtin_strchr(oct_3_c, '.');
#line 1426
  ptr = tmp___10;
#line 1427
  if ((unsigned long )ptr == (unsigned long )((void *)0)) {
#line 1428
    return (-1);
  }
#line 1429
  oct_4_c = ptr + 0;
#line 1430
  oct_4_c ++;
#line 1431
  *(ptr + 0) = (char )'\000';
#line 1433
  tmp___11 = atoi((char const   *)oct_1_c);
#line 1433
  oct_1 = (unsigned int )tmp___11;
#line 1434
  tmp___12 = atoi((char const   *)oct_2_c);
#line 1434
  oct_2 = (unsigned int )tmp___12;
#line 1435
  tmp___13 = atoi((char const   *)oct_3_c);
#line 1435
  oct_3 = (unsigned int )tmp___13;
#line 1436
  tmp___14 = atoi((char const   *)oct_4_c);
#line 1436
  oct_3 = (unsigned int )tmp___14;
#line 1437
  if (oct_1 > 254U) {
#line 1439
    return (-1);
  } else
#line 1437
  if (oct_2 > 254U) {
#line 1439
    return (-1);
  } else
#line 1437
  if (oct_3 > 254U) {
#line 1439
    return (-1);
  } else
#line 1437
  if (oct_4 > 254U) {
#line 1439
    return (-1);
  }
#line 1442
  if (oct_1 == 127U) {
#line 1444
    return (-1);
  } else
#line 1442
  if (oct_1 == 10U) {
#line 1444
    return (-1);
  } else
#line 1447
  if (oct_1 == 192U) {
#line 1447
    if (oct_2 == 168U) {
#line 1449
      return (-1);
    } else {
#line 1447
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 1452
  if (oct_1 == 169U) {
#line 1452
    if (oct_2 == 254U) {
#line 1454
      return (-1);
    } else {
#line 1452
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 1457
  if (oct_1 == 172U) {
#line 1457
    if (oct_2 > 15U) {
#line 1457
      if (oct_2 < 32U) {
#line 1459
        return (-1);
      }
    }
  }
#line 1463
  tmp___15 = __ctype_b_loc();
#line 1463
  if (! ((int const   )*(*tmp___15 + (int )*(port_c + 0)) & 2048)) {
#line 1465
    return (-1);
  }
#line 1467
  tmp___16 = atol((char const   *)port_c);
#line 1467
  port = (unsigned long )tmp___16;
#line 1468
  if (port > 33000UL) {
#line 1470
    return (-1);
  } else
#line 1468
  if (port < 1024UL) {
#line 1470
    return (-1);
  }
#line 1472
  if (port_restrict == 1) {
#line 1472
    if (port != 6346UL) {
#line 1474
      return (-1);
    }
  }
#line 1477
  strncpy((char * __restrict  )(node), (char const   * __restrict  )ip, (size_t )22);
#line 1478
  tmp___18 = __builtin_strchr(node, ':');
#line 1478
  ptr = tmp___18;
#line 1479
  if ((unsigned long )ptr == (unsigned long )((void *)0)) {
#line 1480
    return (-1);
  }
#line 1481
  *(ptr + 0) = (char )'\000';
#line 1483
  sockfd = socket(2, 1, 0);
#line 1484
  if (sockfd == -1) {
#line 1485
    return (-1);
  }
#line 1486
  addr.sin_family = (sa_family_t )2;
#line 1487
  addr.sin_addr.s_addr = inet_addr((char const   *)(& node[0]));
#line 1488
  __x = (unsigned short )port;
#line 1488
  __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 1488
  addr.sin_port = __v;
#line 1489
  len = (unsigned int )sizeof(addr);
#line 1491
  rslt = connect_nonblock(ctx, & sockfd, (struct sockaddr *)(& addr), len);
#line 1492
  if (rslt == -1) {
#line 1494
    close(sockfd);
#line 1496
    return (-1);
  }
#line 1501
  rslt = write_line_to_socket(sockfd, (char *)"GNUTELLA CONNECT/0.6\r\n");
#line 1502
  if (rslt == -1) {
#line 1504
    shutdown(sockfd, 2);
#line 1505
    close(sockfd);
#line 1507
    return (-1);
  }
#line 1509
  rslt = write_line_to_socket(sockfd, (char *)"Node: 128.227.212.74:6346\r\n");
#line 1510
  if (rslt == -1) {
#line 1512
    shutdown(sockfd, 2);
#line 1513
    close(sockfd);
#line 1515
    return (-1);
  }
#line 1517
  snprintf((char * __restrict  )(tmp_buffer), (size_t )256, (char const   * __restrict  )"Remote-IP: %s\r\n",
           ip);
#line 1518
  rslt = write_line_to_socket(sockfd, tmp_buffer);
#line 1519
  if (rslt == -1) {
#line 1521
    shutdown(sockfd, 2);
#line 1522
    close(sockfd);
#line 1524
    return (-1);
  }
#line 1526
  rslt = write_line_to_socket(sockfd, (char *)"User-Agent: LimeWire/4.6.0\r\n\r\n");
#line 1527
  if (rslt == -1) {
#line 1529
    shutdown(sockfd, 2);
#line 1530
    close(sockfd);
#line 1532
    return (-1);
  }
#line 1536
  memset((void *)(tmp_buffer), 0, (size_t )256);
#line 1537
  rslt = read_line(sockfd, (unsigned char *)(tmp_buffer), (unsigned int )sizeof(tmp_buffer));
#line 1538
  if (rslt < 2) {
#line 1540
    shutdown(sockfd, 2);
#line 1541
    close(sockfd);
#line 1543
    return (-1);
  }
#line 1545
  tmp___19 = strstr((char const   *)(tmp_buffer), "503");
#line 1545
  if ((unsigned long )tmp___19 != (unsigned long )((void *)0)) {
#line 1547
    code = 503;
  }
#line 1549
  tmp___20 = strstr((char const   *)(tmp_buffer), "200");
#line 1549
  if ((unsigned long )tmp___20 != (unsigned long )((void *)0)) {
#line 1551
    code = 200;
  }
#line 1555
  current_network = get_network_by_name(ctx->networks, net_name);
#line 1556
  if ((unsigned long )current_network == (unsigned long )((void *)0)) {
#line 1558
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"get_network_by_name() returned NULL\n");
#line 1559
    shutdown(sockfd, 2);
#line 1560
    close(sockfd);
#line 1562
    return (-1);
  }
#line 1565
  while (1) {
#line 1567
    rslt = read_line(sockfd, (unsigned char *)(tmp_buffer), (unsigned int )sizeof(tmp_buffer));
#line 1568
    rslt2 = memcmp((void const   *)"X-Try-Ultrapeers: ", (void const   *)(tmp_buffer),
                   (size_t )18);
#line 1569
    if (rslt2 == 0) {
#line 1571
      process_ultrapeers(tmp_buffer, current_network);
    }
#line 1565
    if ((int )tmp_buffer[0] != 13) {
#line 1565
      if ((int )tmp_buffer[0] != 10) {
#line 1565
        if (! (rslt > 2)) {
#line 1565
          break;
        }
      } else {
#line 1565
        break;
      }
    } else {
#line 1565
      break;
    }
  }
#line 1575
  rslt = write_line_to_socket(sockfd, (char *)"GNUTELLA/0.6 503 Servent Shutdown\r\n");
#line 1576
  if (rslt == -1) {
#line 1578
    shutdown(sockfd, 2);
#line 1579
    close(sockfd);
#line 1580
    if (code == 200) {
#line 1581
      return (0);
    } else {
#line 1583
      return (-1);
    }
  }
#line 1585
  rslt = write_line_to_socket(sockfd, (char *)"User-Agent: LimeWire/4.6.0\r\n\r\n");
#line 1586
  if (rslt == -1) {
#line 1588
    shutdown(sockfd, 2);
#line 1589
    close(sockfd);
#line 1590
    if (code == 200) {
#line 1591
      return (0);
    } else {
#line 1593
      return (-1);
    }
  }
#line 1596
  shutdown(sockfd, 2);
#line 1597
  close(sockfd);
#line 1599
  if (code == 200) {
#line 1600
    return (0);
  } else {
#line 1602
    return (-1);
  }
#line 1604
  return (0);
}
}
#line 1608 "cpcd.c"
int process_ultrapeers(char *peers , struct networks *current_network ) 
{ 
  char *n ;
  char *p ;
  char *node ;
  char *tmp___0 ;
  char *tmp___2 ;
  char *tmp___4 ;

  {
#line 1610
  n = (char *)((void *)0);
#line 1611
  p = (char *)((void *)0);
#line 1612
  node = (char *)((void *)0);
#line 1615
  if ((unsigned long )peers == (unsigned long )((void *)0)) {
#line 1616
    return (-1);
  }
#line 1618
  tmp___0 = __builtin_strchr(peers, ' ');
#line 1618
  n = tmp___0;
#line 1619
  if ((unsigned long )n == (unsigned long )((void *)0)) {
#line 1620
    return (-1);
  }
#line 1622
  *n = (char )'\000';
#line 1623
  n ++;
#line 1625
  if ((unsigned long )n != (unsigned long )((void *)0)) {
#line 1627
    tmp___2 = __strtok_r((char * __restrict  )n, (char const   * __restrict  )",",
                         (char ** __restrict  )(& p));
#line 1627
    node = tmp___2;
#line 1628
    while (1) {
#line 1630
      process_update(node, (char *)((void *)0), current_network);
#line 1628
      tmp___4 = __strtok_r((char * __restrict  )'\000', (char const   * __restrict  )",",
                           (char ** __restrict  )(& p));
#line 1628
      node = tmp___4;
#line 1628
      if (! node) {
#line 1628
        break;
      }
    }
  }
#line 1634
  return (0);
}
}
#line 1638 "cpcd.c"
int cache_known_bad(struct cpcd_ctx **ctx___0 , char *url ) 
{ 
  unsigned long age ;
  unsigned long bdate ;
  time_t now ;

  {
#line 1640
  age = 0UL;
#line 1641
  bdate = 0UL;
#line 1642
  now = (time_t )0;
#line 1645
  now = time((time_t *)((void *)0));
#line 1646
  bdate = node_already_exists((*ctx___0)->bad_caches, url);
#line 1647
  if (bdate == 0UL) {
#line 1649
    return (0);
  }
#line 1652
  age = (unsigned long )now - bdate;
#line 1653
  if (age > 604800UL) {
#line 1655
    pthread_mutex_lock(& data_mutex);
#line 1656
    (*ctx___0)->bad_caches = delete_cached_host_by_name((*ctx___0)->bad_caches, url);
#line 1657
    pthread_mutex_unlock(& data_mutex);
  } else {
#line 1661
    return (1);
  }
#line 1664
  return (0);
}
}
#line 1 "cpcd-cpcd_datastructures.o"
#pragma merger("0","/tmp/cil-2STXadct.i","-g,-O2,-Wall,-g,-O2")
#line 104 "cpcd_datastructures.h"
int push_entry(struct queue **the_queue , struct queue *new_item , int max_queue_size ) ;
#line 106
int get_queue_depth(struct queue *the_queue ) ;
#line 107
struct queue *get_last_item(struct queue *the_queue ) ;
#line 115
struct networks *get_last_network(struct networks *nets ) ;
#line 116
struct networks *add_new_network(struct networks *nets , struct networks *new_net ) ;
#line 123
struct hosts *get_last_host(struct hosts *cached_hosts ) ;
#line 25 "cpcd_datastructures.c"
int init_context(struct cpcd_ctx **ctx___0 ) 
{ 


  {
#line 27
  (*ctx___0)->config = (struct cpcd_config *)((void *)0);
#line 28
  (*ctx___0)->networks = (struct networks *)((void *)0);
#line 29
  (*ctx___0)->bad_caches = (struct hosts *)((void *)0);
#line 31
  (*ctx___0)->total_hits = 0UL;
#line 32
  (*ctx___0)->updts = 0UL;
#line 33
  (*ctx___0)->reqs = 0UL;
#line 35
  (*ctx___0)->exit_flag = 0;
#line 36
  (*ctx___0)->verbose = 0;
#line 38
  (*ctx___0)->log = (FILE *)((void *)0);
#line 40
  (*ctx___0)->host_queue = (struct queue *)((void *)0);
#line 41
  (*ctx___0)->url_queue = (struct queue *)((void *)0);
#line 43
  return (0);
}
}
#line 52 "cpcd_datastructures.c"
int new_queue_entry(struct queue **the_queue , char *data , char *net , int max_queue_size ) 
{ 
  struct queue *new_item ;
  int data_len ;
  int net_len ;
  size_t tmp ;
  size_t tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;
  void *tmp___3 ;

  {
#line 55
  data_len = 0;
#line 56
  net_len = 0;
#line 59
  if ((unsigned long )data == (unsigned long )((void *)0)) {
#line 61
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Invalid values passed to new_queue_item()\n");
#line 63
    return (-1);
  } else
#line 59
  if ((unsigned long )net == (unsigned long )((void *)0)) {
#line 61
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Invalid values passed to new_queue_item()\n");
#line 63
    return (-1);
  }
#line 66
  tmp = strlen((char const   *)data);
#line 66
  data_len = (int )tmp;
#line 67
  tmp___0 = strlen((char const   *)net);
#line 67
  net_len = (int )tmp___0;
#line 68
  if (data_len == 0) {
#line 70
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Invalid values passed to new_queue_item()\n");
#line 72
    return (-1);
  } else
#line 68
  if (net_len == 0) {
#line 70
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Invalid values passed to new_queue_item()\n");
#line 72
    return (-1);
  }
#line 74
  tmp___1 = malloc(sizeof(struct queue ));
#line 74
  new_item = (struct queue *)tmp___1;
#line 75
  if ((unsigned long )new_item == (unsigned long )((void *)0)) {
#line 77
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Malloc call failed: out of memory\n");
#line 79
    return (-1);
  }
#line 81
  new_item->data = (char *)((void *)0);
#line 82
  new_item->net_name = (char *)((void *)0);
#line 83
  new_item->next = (struct queue *)((void *)0);
#line 85
  tmp___2 = malloc((size_t )(data_len + 2));
#line 85
  new_item->data = (char *)tmp___2;
#line 86
  if ((unsigned long )new_item->data == (unsigned long )((void *)0)) {
#line 88
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Malloc call failed: out of memory\n");
#line 89
    if ((unsigned long )new_item != (unsigned long )((void *)0)) {
#line 91
      free_queue_item(new_item);
    }
#line 94
    return (-1);
  }
#line 97
  tmp___3 = malloc((size_t )(net_len + 2));
#line 97
  new_item->net_name = (char *)tmp___3;
#line 98
  if ((unsigned long )new_item->net_name == (unsigned long )((void *)0)) {
#line 100
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Malloc call failed: out of memory\n");
#line 101
    if ((unsigned long )new_item != (unsigned long )((void *)0)) {
#line 103
      free_queue_item(new_item);
    }
#line 106
    return (-1);
  }
#line 109
  memset((void *)new_item->data, 0, (size_t )(data_len + 2));
#line 110
  memset((void *)new_item->net_name, 0, (size_t )(net_len + 2));
#line 111
  strncpy((char * __restrict  )new_item->data, (char const   * __restrict  )data,
          (size_t )(data_len + 1));
#line 112
  strncpy((char * __restrict  )new_item->net_name, (char const   * __restrict  )net,
          (size_t )(net_len + 1));
#line 114
  push_entry(the_queue, new_item, max_queue_size);
#line 116
  return (0);
}
}
#line 120 "cpcd_datastructures.c"
int get_queue_depth(struct queue *the_queue ) 
{ 
  int i ;

  {
#line 122
  i = 1;
#line 124
  if ((unsigned long )the_queue == (unsigned long )((void *)0)) {
#line 125
    return (0);
  }
#line 127
  while ((unsigned long )the_queue->next != (unsigned long )((void *)0)) {
#line 129
    the_queue = the_queue->next;
#line 130
    i ++;
  }
#line 133
  return (i);
}
}
#line 137 "cpcd_datastructures.c"
int push_entry(struct queue **the_queue , struct queue *new_item , int max_queue_size ) 
{ 
  struct queue *tail ;
  int i ;
  struct queue *expired_item ;

  {
#line 139
  tail = (struct queue *)((void *)0);
#line 140
  i = 0;
#line 143
  if ((unsigned long )new_item == (unsigned long )((void *)0)) {
#line 144
    return (-1);
  }
#line 146
  i = get_queue_depth(*the_queue);
#line 148
  if (i > max_queue_size) {
#line 150
    expired_item = (struct queue *)((void *)0);
#line 152
    expired_item = pop_entry(the_queue);
#line 153
    free_queue_item(expired_item);
  }
#line 155
  tail = get_last_item(*the_queue);
#line 156
  if ((unsigned long )tail == (unsigned long )((void *)0)) {
#line 158
    *the_queue = new_item;
  } else {
#line 162
    tail->next = new_item;
#line 163
    new_item->next = (struct queue *)((void *)0);
  }
#line 166
  return (0);
}
}
#line 170 "cpcd_datastructures.c"
struct queue *get_last_item(struct queue *the_queue ) 
{ 


  {
#line 172
  if ((unsigned long )the_queue == (unsigned long )((void *)0)) {
#line 173
    return ((struct queue *)((void *)0));
  }
#line 175
  while ((unsigned long )the_queue->next != (unsigned long )((void *)0)) {
#line 177
    the_queue = the_queue->next;
  }
#line 180
  return (the_queue);
}
}
#line 184 "cpcd_datastructures.c"
struct queue *pop_entry(struct queue **the_queue ) 
{ 
  struct queue *the_item ;

  {
#line 186
  the_item = (struct queue *)((void *)0);
#line 189
  if ((unsigned long )*the_queue == (unsigned long )((void *)0)) {
#line 190
    return ((struct queue *)((void *)0));
  }
#line 192
  the_item = *the_queue;
#line 194
  if ((unsigned long )(*the_queue)->next != (unsigned long )((void *)0)) {
#line 196
    *the_queue = (*the_queue)->next;
  } else {
#line 200
    *the_queue = (struct queue *)((void *)0);
  }
#line 203
  the_item->next = (struct queue *)((void *)0);
#line 205
  return (the_item);
}
}
#line 210 "cpcd_datastructures.c"
struct hosts *add_new_cached_host(struct hosts *cached_hosts , char *type_str , char *addr ,
                                  long bdate ) 
{ 
  struct hosts *last_host ;
  struct hosts *new_host ;
  int addr_len ;
  size_t tmp ;
  void *tmp___0 ;
  void *tmp___1 ;

  {
#line 212
  last_host = (struct hosts *)((void *)0);
#line 213
  new_host = (struct hosts *)((void *)0);
#line 214
  addr_len = 0;
#line 217
  tmp = strlen((char const   *)addr);
#line 217
  addr_len = (int )tmp;
#line 218
  if (addr_len < 6) {
#line 219
    return (cached_hosts);
  }
#line 221
  tmp___0 = malloc(sizeof(struct hosts ));
#line 221
  new_host = (struct hosts *)tmp___0;
#line 222
  if ((unsigned long )new_host == (unsigned long )((void *)0)) {
#line 224
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Malloc call failed.  Out of memory.\n");
#line 226
    return (cached_hosts);
  }
#line 228
  new_host->type = *(type_str + 0);
#line 229
  tmp___1 = malloc((size_t )(addr_len + 2));
#line 229
  new_host->addr = (unsigned char *)tmp___1;
#line 230
  if ((unsigned long )new_host->addr == (unsigned long )((void *)0)) {
#line 232
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Malloc call failed.  Out of memory.\n");
#line 233
    if ((unsigned long )new_host != (unsigned long )((void *)0)) {
#line 234
      free((void *)new_host);
    }
#line 236
    return (cached_hosts);
  }
#line 238
  memset((void *)new_host->addr, 0, (size_t )(addr_len + 2));
#line 239
  strncpy((char * __restrict  )new_host->addr, (char const   * __restrict  )addr,
          (size_t )(addr_len + 1));
#line 240
  new_host->bdate = (unsigned long )bdate;
#line 241
  new_host->prev = (struct hosts *)((void *)0);
#line 242
  new_host->next = (struct hosts *)((void *)0);
#line 244
  last_host = get_last_host(cached_hosts);
#line 245
  if ((unsigned long )last_host == (unsigned long )((void *)0)) {
#line 247
    cached_hosts = new_host;
#line 248
    cached_hosts->prev = (struct hosts *)((void *)0);
#line 249
    cached_hosts->next = (struct hosts *)((void *)0);
  } else {
#line 253
    last_host->next = new_host;
#line 254
    new_host->prev = last_host;
#line 255
    new_host->next = (struct hosts *)((void *)0);
  }
#line 258
  return (new_host);
}
}
#line 267 "cpcd_datastructures.c"
struct hosts *get_first_host(struct hosts *cached_hosts ) 
{ 


  {
#line 269
  if ((unsigned long )cached_hosts != (unsigned long )((void *)0)) {
#line 271
    while ((unsigned long )cached_hosts->prev != (unsigned long )((void *)0)) {
#line 273
      cached_hosts = cached_hosts->prev;
    }
  }
#line 278
  return (cached_hosts);
}
}
#line 282 "cpcd_datastructures.c"
struct hosts *get_last_host(struct hosts *cached_hosts ) 
{ 


  {
#line 284
  if ((unsigned long )cached_hosts != (unsigned long )((void *)0)) {
#line 286
    while ((unsigned long )cached_hosts->next != (unsigned long )((void *)0)) {
#line 288
      cached_hosts = cached_hosts->next;
    }
  }
#line 293
  return (cached_hosts);
}
}
#line 297 "cpcd_datastructures.c"
struct hosts *get_oldest_host(struct hosts *cached_hosts , int type ) 
{ 
  struct hosts *walk_host ;

  {
#line 299
  walk_host = (struct hosts *)((void *)0);
#line 302
  if (type != 3) {
#line 302
    if (type != 2) {
#line 303
      return (cached_hosts);
    } else {
#line 302
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 302
  if ((unsigned long )cached_hosts == (unsigned long )((void *)0)) {
#line 303
    return (cached_hosts);
  }
#line 305
  walk_host = get_first_host(cached_hosts);
#line 306
  if ((unsigned long )walk_host == (unsigned long )((void *)0)) {
#line 308
    return (cached_hosts);
  }
#line 311
  while ((unsigned long )walk_host != (unsigned long )((void *)0)) {
#line 313
    if (type == 3) {
#line 313
      if ((int )walk_host->type == 85) {
#line 315
        return (walk_host);
      } else {
#line 313
        goto _L___0;
      }
    } else
    _L___0: /* CIL Label */ 
#line 317
    if (type == 2) {
#line 317
      if ((int )walk_host->type == 72) {
#line 319
        return (walk_host);
      }
    }
#line 322
    walk_host = walk_host->next;
  }
#line 326
  return ((struct hosts *)((void *)0));
}
}
#line 330 "cpcd_datastructures.c"
struct networks *get_first_network(struct networks *nets ) 
{ 


  {
#line 332
  if ((unsigned long )nets != (unsigned long )((void *)0)) {
#line 334
    while ((unsigned long )nets->prev != (unsigned long )((void *)0)) {
#line 336
      nets = nets->prev;
    }
  }
#line 340
  return (nets);
}
}
#line 344 "cpcd_datastructures.c"
struct networks *get_last_network(struct networks *nets ) 
{ 


  {
#line 346
  if ((unsigned long )nets != (unsigned long )((void *)0)) {
#line 348
    while ((unsigned long )nets->next != (unsigned long )((void *)0)) {
#line 350
      nets = nets->next;
    }
  }
#line 354
  return (nets);
}
}
#line 358 "cpcd_datastructures.c"
struct networks *get_network_by_name(struct networks *nets , char *name ) 
{ 
  struct networks *walk_network ;
  size_t __s1_len ;
  size_t __s2_len ;
  int tmp___0 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 360
  walk_network = (struct networks *)((void *)0);
#line 363
  if ((unsigned long )nets == (unsigned long )((void *)0)) {
#line 364
    return ((struct networks *)((void *)0));
  }
#line 366
  walk_network = get_first_network(nets);
#line 368
  while ((unsigned long )walk_network != (unsigned long )((void *)0)) {
#line 370
    if (0) {
#line 370
      __s1_len = __builtin_strlen((char const   *)name);
#line 370
      __s2_len = __builtin_strlen((char const   *)(walk_network->name));
#line 370
      if (! ((size_t )((void const   *)(name + 1)) - (size_t )((void const   *)name) == 1UL)) {
#line 370
        goto _L___0;
      } else
#line 370
      if (__s1_len >= 4UL) {
        _L___0: /* CIL Label */ 
#line 370
        if (! ((size_t )((void const   *)(walk_network->name + 1)) - (size_t )((void const   *)(walk_network->name)) == 1UL)) {
#line 370
          tmp___5 = 1;
        } else
#line 370
        if (__s2_len >= 4UL) {
#line 370
          tmp___5 = 1;
        } else {
#line 370
          tmp___5 = 0;
        }
      } else {
#line 370
        tmp___5 = 0;
      }
#line 370
      if (tmp___5) {
#line 370
        tmp___0 = __builtin_strcmp((char const   *)name, (char const   *)(walk_network->name));
#line 370
        tmp___4 = tmp___0;
      } else {
#line 370
        tmp___3 = __builtin_strcmp((char const   *)name, (char const   *)(walk_network->name));
#line 370
        tmp___4 = tmp___3;
      }
    } else {
#line 370
      tmp___3 = __builtin_strcmp((char const   *)name, (char const   *)(walk_network->name));
#line 370
      tmp___4 = tmp___3;
    }
#line 370
    if (tmp___4 == 0) {
#line 372
      return (walk_network);
    } else {
#line 376
      walk_network = walk_network->next;
    }
  }
#line 380
  return ((struct networks *)((void *)0));
}
}
#line 389 "cpcd_datastructures.c"
int count_nodes(struct hosts *cached_hosts , int type ) 
{ 
  int count ;
  struct hosts *walk_host ;

  {
#line 391
  count = 0;
#line 392
  walk_host = (struct hosts *)((void *)0);
#line 395
  walk_host = get_first_host(cached_hosts);
#line 396
  if ((unsigned long )walk_host == (unsigned long )((void *)0)) {
#line 398
    return (-1);
  }
#line 401
  if (type == 3) {
#line 403
    while ((unsigned long )walk_host != (unsigned long )((void *)0)) {
#line 405
      if ((int )walk_host->type == 85) {
#line 407
        count ++;
      }
#line 410
      walk_host = walk_host->next;
    }
  } else
#line 413
  if (type == 2) {
#line 415
    while ((unsigned long )walk_host != (unsigned long )((void *)0)) {
#line 417
      if ((int )walk_host->type == 72) {
#line 419
        count ++;
      }
#line 422
      walk_host = walk_host->next;
    }
  } else {
#line 427
    while ((unsigned long )walk_host != (unsigned long )((void *)0)) {
#line 429
      count ++;
#line 431
      walk_host = walk_host->next;
    }
  }
#line 435
  return (count);
}
}
#line 439 "cpcd_datastructures.c"
unsigned long node_already_exists(struct hosts *cached_hosts , char *data ) 
{ 
  struct hosts *walk_host ;
  size_t __s1_len ;
  size_t __s2_len ;
  int tmp___0 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 441
  walk_host = (struct hosts *)((void *)0);
#line 444
  if ((unsigned long )cached_hosts == (unsigned long )((void *)0)) {
#line 445
    return (0UL);
  }
#line 446
  if ((unsigned long )data == (unsigned long )((void *)0)) {
#line 447
    return (1UL);
  }
#line 449
  walk_host = get_first_host(cached_hosts);
#line 450
  while ((unsigned long )walk_host != (unsigned long )((void *)0)) {
#line 452
    if (0) {
#line 452
      __s1_len = __builtin_strlen((char const   *)data);
#line 452
      __s2_len = __builtin_strlen((char const   *)walk_host->addr);
#line 452
      if (! ((size_t )((void const   *)(data + 1)) - (size_t )((void const   *)data) == 1UL)) {
#line 452
        goto _L___0;
      } else
#line 452
      if (__s1_len >= 4UL) {
        _L___0: /* CIL Label */ 
#line 452
        if (! ((size_t )((void const   *)(walk_host->addr + 1)) - (size_t )((void const   *)walk_host->addr) == 1UL)) {
#line 452
          tmp___5 = 1;
        } else
#line 452
        if (__s2_len >= 4UL) {
#line 452
          tmp___5 = 1;
        } else {
#line 452
          tmp___5 = 0;
        }
      } else {
#line 452
        tmp___5 = 0;
      }
#line 452
      if (tmp___5) {
#line 452
        tmp___0 = __builtin_strcmp((char const   *)data, (char const   *)walk_host->addr);
#line 452
        tmp___4 = tmp___0;
      } else {
#line 452
        tmp___3 = __builtin_strcmp((char const   *)data, (char const   *)walk_host->addr);
#line 452
        tmp___4 = tmp___3;
      }
    } else {
#line 452
      tmp___3 = __builtin_strcmp((char const   *)data, (char const   *)walk_host->addr);
#line 452
      tmp___4 = tmp___3;
    }
#line 452
    if (tmp___4 == 0) {
#line 454
      return (walk_host->bdate);
    }
#line 457
    walk_host = walk_host->next;
  }
#line 460
  return (0UL);
}
}
#line 464 "cpcd_datastructures.c"
struct hosts *trim_struct_to_max(struct hosts *hosts , int max , char type ) 
{ 
  int host_count ;
  struct hosts *free_host ;

  {
#line 466
  host_count = 0;
#line 467
  free_host = (struct hosts *)((void *)0);
#line 470
  host_count = count_nodes(hosts, (int )type);
#line 471
  while (host_count > max) {
#line 473
    free_host = get_oldest_host(hosts, (int )type);
#line 474
    hosts = delete_cached_host(free_host);
  }
#line 477
  return (hosts);
}
}
#line 481 "cpcd_datastructures.c"
struct hosts *delete_cached_host(struct hosts *host_to_delete ) 
{ 
  struct hosts *rtrn ;

  {
#line 483
  rtrn = (struct hosts *)((void *)0);
#line 486
  if ((unsigned long )host_to_delete != (unsigned long )((void *)0)) {
#line 488
    rtrn = get_first_host(host_to_delete);
#line 489
    if ((unsigned long )rtrn == (unsigned long )host_to_delete) {
#line 491
      if ((unsigned long )rtrn->next == (unsigned long )((void *)0)) {
#line 493
        rtrn = (struct hosts *)((void *)0);
      } else {
#line 497
        rtrn = rtrn->next;
      }
    }
#line 501
    if ((unsigned long )host_to_delete->prev != (unsigned long )((void *)0)) {
#line 503
      (host_to_delete->prev)->next = host_to_delete->next;
    }
#line 505
    if ((unsigned long )host_to_delete->next != (unsigned long )((void *)0)) {
#line 507
      (host_to_delete->next)->prev = host_to_delete->prev;
    }
#line 509
    if ((unsigned long )host_to_delete->addr != (unsigned long )((void *)0)) {
#line 511
      free((void *)host_to_delete->addr);
#line 512
      host_to_delete->addr = (unsigned char *)((void *)0);
    }
#line 514
    free((void *)host_to_delete);
#line 515
    host_to_delete = (struct hosts *)((void *)0);
  }
#line 519
  return (rtrn);
}
}
#line 523 "cpcd_datastructures.c"
struct hosts *delete_cached_host_by_name(struct hosts *cached_hosts , char *name ) 
{ 
  struct hosts *walk_host ;
  struct hosts *rtrn ;
  size_t __s1_len ;
  size_t __s2_len ;
  int tmp___0 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 525
  walk_host = (struct hosts *)((void *)0);
#line 526
  rtrn = (struct hosts *)((void *)0);
#line 529
  if ((unsigned long )name == (unsigned long )((void *)0)) {
#line 530
    return (cached_hosts);
  } else
#line 529
  if ((unsigned long )cached_hosts == (unsigned long )((void *)0)) {
#line 530
    return (cached_hosts);
  }
#line 532
  walk_host = get_first_host(cached_hosts);
#line 532
  rtrn = walk_host;
#line 534
  while ((unsigned long )walk_host != (unsigned long )((void *)0)) {
#line 536
    if (0) {
#line 536
      __s1_len = __builtin_strlen((char const   *)name);
#line 536
      __s2_len = __builtin_strlen((char const   *)walk_host->addr);
#line 536
      if (! ((size_t )((void const   *)(name + 1)) - (size_t )((void const   *)name) == 1UL)) {
#line 536
        goto _L___0;
      } else
#line 536
      if (__s1_len >= 4UL) {
        _L___0: /* CIL Label */ 
#line 536
        if (! ((size_t )((void const   *)(walk_host->addr + 1)) - (size_t )((void const   *)walk_host->addr) == 1UL)) {
#line 536
          tmp___5 = 1;
        } else
#line 536
        if (__s2_len >= 4UL) {
#line 536
          tmp___5 = 1;
        } else {
#line 536
          tmp___5 = 0;
        }
      } else {
#line 536
        tmp___5 = 0;
      }
#line 536
      if (tmp___5) {
#line 536
        tmp___0 = __builtin_strcmp((char const   *)name, (char const   *)walk_host->addr);
#line 536
        tmp___4 = tmp___0;
      } else {
#line 536
        tmp___3 = __builtin_strcmp((char const   *)name, (char const   *)walk_host->addr);
#line 536
        tmp___4 = tmp___3;
      }
    } else {
#line 536
      tmp___3 = __builtin_strcmp((char const   *)name, (char const   *)walk_host->addr);
#line 536
      tmp___4 = tmp___3;
    }
#line 536
    if (tmp___4 == 0) {
#line 538
      rtrn = delete_cached_host(walk_host);
#line 539
      return (rtrn);
    } else {
#line 543
      walk_host = walk_host->next;
    }
  }
#line 547
  return (rtrn);
}
}
#line 551 "cpcd_datastructures.c"
struct networks *add_new_network(struct networks *nets , struct networks *new_net ) 
{ 
  struct networks *last_net ;

  {
#line 553
  last_net = (struct networks *)((void *)0);
#line 556
  printf((char const   * __restrict  )"Adding: %s\n", new_net->name);
#line 557
  last_net = get_last_network(nets);
#line 558
  if ((unsigned long )last_net == (unsigned long )((void *)0)) {
#line 560
    nets = new_net;
#line 561
    nets->prev = (struct networks *)((void *)0);
#line 562
    nets->next = (struct networks *)((void *)0);
  } else {
#line 566
    last_net->next = new_net;
#line 567
    new_net->prev = last_net;
#line 568
    new_net->next = (struct networks *)((void *)0);
  }
#line 571
  return (new_net);
}
}
#line 580 "cpcd_datastructures.c"
void free_queue_item(struct queue *the_item ) 
{ 


  {
#line 582
  if ((unsigned long )the_item != (unsigned long )((void *)0)) {
#line 584
    if ((unsigned long )the_item->data != (unsigned long )((void *)0)) {
#line 586
      free((void *)the_item->data);
#line 587
      the_item->data = (char *)((void *)0);
    }
#line 589
    if ((unsigned long )the_item->net_name != (unsigned long )((void *)0)) {
#line 591
      free((void *)the_item->net_name);
#line 592
      the_item->net_name = (char *)((void *)0);
    }
#line 594
    free((void *)the_item);
#line 595
    the_item = (struct queue *)((void *)0);
  }
#line 598
  return;
}
}
#line 601 "cpcd_datastructures.c"
void free_queue(struct queue *the_queue ) 
{ 
  struct queue *next_item ;

  {
#line 603
  next_item = (struct queue *)((void *)0);
#line 605
  while ((unsigned long )the_queue != (unsigned long )((void *)0)) {
#line 607
    next_item = the_queue->next;
#line 608
    free_queue_item(the_queue);
#line 609
    the_queue = next_item;
  }
#line 611
  return;
}
}
#line 614 "cpcd_datastructures.c"
void free_cached_hosts(struct hosts *cached_hosts ) 
{ 
  struct hosts *walk_host ;
  struct hosts *next_host ;
  struct hosts *tmp ;

  {
#line 616
  walk_host = (struct hosts *)((void *)0);
#line 617
  next_host = (struct hosts *)((void *)0);
#line 620
  if ((unsigned long )cached_hosts != (unsigned long )((void *)0)) {
#line 622
    tmp = get_first_host(cached_hosts);
#line 622
    walk_host = tmp;
#line 623
    while ((unsigned long )walk_host != (unsigned long )((void *)0)) {
#line 625
      next_host = walk_host->next;
#line 626
      if ((unsigned long )walk_host->addr != (unsigned long )((void *)0)) {
#line 628
        free((void *)walk_host->addr);
#line 629
        walk_host->addr = (unsigned char *)((void *)0);
      }
#line 631
      free((void *)walk_host);
#line 632
      walk_host = next_host;
    }
  }
#line 636
  return;
}
}
#line 640 "cpcd_datastructures.c"
void free_networks(struct networks *networks ) 
{ 
  struct networks *next_networks ;

  {
#line 642
  next_networks = (struct networks *)((void *)0);
#line 644
  networks = get_first_network(networks);
#line 645
  if ((unsigned long )networks != (unsigned long )((void *)0)) {
#line 647
    while ((unsigned long )networks != (unsigned long )((void *)0)) {
#line 649
      printf((char const   * __restrict  )"Freeing: %s\n", networks->name);
#line 650
      next_networks = networks->next;
#line 651
      if ((unsigned long )networks->hosts != (unsigned long )((void *)0)) {
#line 653
        free_cached_hosts(networks->hosts);
      }
#line 655
      if ((unsigned long )networks->bad_hosts != (unsigned long )((void *)0)) {
#line 657
        free_cached_hosts(networks->bad_hosts);
      }
#line 659
      free((void *)networks);
#line 660
      networks = next_networks;
    }
  }
#line 664
  return;
}
}
#line 668 "cpcd_datastructures.c"
void free_context(struct cpcd_ctx *ctx___0 ) 
{ 


  {
#line 670
  if ((unsigned long )ctx___0 != (unsigned long )((void *)0)) {
#line 672
    if ((unsigned long )ctx___0->host_queue != (unsigned long )((void *)0)) {
#line 673
      free_queue(ctx___0->host_queue);
    }
#line 674
    if ((unsigned long )ctx___0->url_queue != (unsigned long )((void *)0)) {
#line 675
      free_queue(ctx___0->url_queue);
    }
#line 676
    if ((unsigned long )ctx___0->config != (unsigned long )((void *)0)) {
#line 678
      free((void *)ctx___0->config);
    }
#line 680
    free_networks(ctx___0->networks);
#line 681
    free((void *)ctx___0);
  }
#line 684
  return;
}
}
#line 1 "cpcd-cpcd_config.o"
#pragma merger("0","/tmp/cil-Df_CIYFF.i","-g,-O2,-Wall,-g,-O2")
#line 53 "cpcd_util.h"
int file_exists(char *path ) ;
#line 59
int load_network_caches(struct cpcd_ctx **ctx___0 , char *networks ) ;
#line 22 "cpcd_config.h"
int read_config(struct cpcd_config **config ) ;
#line 19 "cpcd_config.c"
int init_config(struct cpcd_ctx **ctx___0 , struct cpcd_config **config ) 
{ 
  int rslt ;

  {
#line 21
  rslt = 0;
#line 23
  memset((void *)((*config)->allowed_networks), 0, (size_t )255);
#line 24
  memset((void *)((*config)->default_allow), 0, (size_t )255);
#line 25
  memset((void *)((*config)->default_network), 0, (size_t )255);
#line 26
  memset((void *)((*config)->cpcd_version), 0, (size_t )49);
#line 27
  memset((void *)((*config)->server_url), 0, (size_t )255);
#line 28
  memset((void *)((*config)->data_dir), 0, (size_t )255);
#line 30
  strncpy((char * __restrict  )((*config)->allowed_networks), (char const   * __restrict  )"gnutella gnutella2 MetaNET",
          (size_t )35);
#line 31
  strncpy((char * __restrict  )((*config)->default_network), (char const   * __restrict  )"gnutella",
          (size_t )35);
#line 32
  strncpy((char * __restrict  )((*config)->default_allow), (char const   * __restrict  )"LIME GTKG GNUC BEAR MRPH MESH RAZA ACQX MNAP SWAP MUTE TEST META XOLO QTLA PHEX KIWI TFLS GALA ACQL GNZL GDNA GIFT",
          (size_t )200);
#line 33
  strncpy((char * __restrict  )((*config)->cpcd_version), (char const   * __restrict  )"CryptNET cpcd 1.0.0",
          (size_t )35);
#line 34
  strncpy((char * __restrict  )((*config)->server_url), (char const   * __restrict  )"localhost",
          (size_t )35);
#line 35
  strncpy((char * __restrict  )((*config)->bind_ip), (char const   * __restrict  )"0.0.0.0",
          (size_t )10);
#line 36
  strncpy((char * __restrict  )((*config)->web_bind_port), (char const   * __restrict  )"8080",
          (size_t )5);
#line 37
  strncpy((char * __restrict  )((*config)->gnutella_bind_port), (char const   * __restrict  )"6346",
          (size_t )5);
#line 38
  strncpy((char * __restrict  )((*config)->data_dir), (char const   * __restrict  )"/var/tmp/data",
          (size_t )255);
#line 39
  strncpy((char * __restrict  )((*config)->log_file), (char const   * __restrict  )"/var/log/cpcd.log",
          (size_t )255);
#line 40
  strncpy((char * __restrict  )((*config)->pid_file), (char const   * __restrict  )"/var/run/cpcd.pid",
          (size_t )255);
#line 43
  (*config)->cpcd_keep_log = 0;
#line 44
  (*config)->cpcd_throttle_support = 0;
#line 46
  (*config)->max_bad_urls = 500;
#line 48
  (*config)->max_hosts = 150;
#line 49
  (*config)->max_urls = 20;
#line 50
  (*config)->max_nets = 5;
#line 52
  (*config)->listen_threads = 100;
#line 53
  (*config)->host_threads = 20;
#line 55
  (*config)->port_restriction = 0;
#line 57
  rslt = read_config(config);
#line 58
  if (rslt != 0) {
#line 60
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"An error occured while attempting to read the configuration file.\n");
#line 61
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Some default config values may be used.\n");
  }
#line 64
  load_network_caches(ctx___0, (*config)->allowed_networks);
#line 66
  return (0);
}
}
#line 70 "cpcd_config.c"
int read_config(struct cpcd_config **config ) 
{ 
  FILE *conf_file ;
  char line[513] ;
  char file_loc[1024] ;
  char *p ;
  int tmp ;
  int tmp___0 ;
  int tmp___1 ;
  int tmp___2 ;
  int tmp___3 ;
  unsigned char *name ;
  unsigned char *value ;
  void *tmp___4 ;
  size_t tmp___5 ;
  int tmp___6 ;
  int tmp___7 ;
  int tmp___8 ;
  int tmp___9 ;
  int tmp___10 ;
  int tmp___11 ;
  int tmp___12 ;
  int tmp___13 ;
  int tmp___14 ;
  int tmp___15 ;
  int tmp___16 ;
  int tmp___17 ;
  int tmp___18 ;
  int tmp___19 ;
  int tmp___20 ;
  int tmp___21 ;
  int tmp___22 ;
  int tmp___23 ;
  int tmp___24 ;
  unsigned short const   **tmp___25 ;
  char *tmp___26 ;

  {
#line 72
  conf_file = (FILE *)((void *)0);
#line 75
  p = (char *)((void *)0);
#line 78
  memset((void *)(line), 0, (size_t )513);
#line 79
  memset((void *)(file_loc), 0, (size_t )1024);
#line 81
  tmp___3 = file_exists((char *)"/usr/local/etc/cpcd.conf");
#line 81
  if (tmp___3) {
#line 83
    strncpy((char * __restrict  )(file_loc), (char const   * __restrict  )"/usr/local/etc/cpcd.conf",
            (size_t )1023);
  } else {
#line 85
    tmp___2 = file_exists((char *)"/etc/cpcd.conf");
#line 85
    if (tmp___2) {
#line 87
      strncpy((char * __restrict  )(file_loc), (char const   * __restrict  )"/etc/cpcd.conf",
              (size_t )63);
    } else {
#line 89
      tmp___1 = file_exists((char *)"/usr/local/etc/cpcd.conf");
#line 89
      if (tmp___1) {
#line 91
        strncpy((char * __restrict  )(file_loc), (char const   * __restrict  )"/usr/local/etc/cpcd.conf",
                (size_t )63);
      } else {
#line 93
        tmp___0 = file_exists((char *)"/home/cpcd/etc/cpcd.conf");
#line 93
        if (tmp___0) {
#line 95
          strncpy((char * __restrict  )(file_loc), (char const   * __restrict  )"/home/cpcd/etc/cpcd.conf",
                  (size_t )63);
        } else {
#line 97
          tmp = file_exists((char *)"../cpcd.conf");
#line 97
          if (tmp) {
#line 99
            strncpy((char * __restrict  )(file_loc), (char const   * __restrict  )"../cpcd.conf",
                    (size_t )63);
          } else {
#line 103
            fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"CPCD: Unable to find configuration file.\n");
#line 105
            return (-1);
          }
        }
      }
    }
  }
#line 108
  conf_file = fopen((char const   * __restrict  )(file_loc), (char const   * __restrict  )"r");
#line 108
  if ((unsigned long )conf_file == (unsigned long )((void *)0)) {
#line 110
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to open configuration file: %s\n",
            file_loc);
#line 112
    return (-1);
  }
#line 115
  while (1) {
#line 115
    tmp___26 = fgets((char * __restrict  )(line), 512, (FILE * __restrict  )conf_file);
#line 115
    if (! ((unsigned long )tmp___26 != (unsigned long )((void *)0))) {
#line 115
      break;
    }
#line 117
    tmp___24 = memcmp((void const   *)(line), (void const   *)"#", (size_t )1);
#line 117
    if (! (tmp___24 == 0)) {
#line 117
      tmp___25 = __ctype_b_loc();
#line 117
      if (! ((int const   )*(*tmp___25 + (int )line[0]) & 8192)) {
#line 119
        name = (unsigned char *)((void *)0);
#line 120
        value = (unsigned char *)((void *)0);
#line 122
        name = (unsigned char *)(& line[0]);
#line 123
        tmp___4 = memchr((void const   *)name, ' ', (size_t )512);
#line 123
        p = (char *)tmp___4;
#line 124
        if ((unsigned long )p == (unsigned long )((void *)0)) {
#line 125
          continue;
        }
#line 126
        p ++;
#line 126
        value = (unsigned char *)p;
#line 127
        if ((unsigned long )value == (unsigned long )((void *)0)) {
#line 128
          continue;
        }
#line 129
        p = (char *)'\000';
#line 130
        tmp___5 = strlen((char const   *)value);
#line 130
        *(value + (tmp___5 - 1UL)) = (unsigned char )'\000';
#line 132
        tmp___23 = memcmp((void const   *)name, (void const   *)"allowed_networks",
                          (size_t )16);
#line 132
        if (tmp___23 == 0) {
#line 134
          strncpy((char * __restrict  )((*config)->allowed_networks), (char const   * __restrict  )value,
                  (size_t )255);
        } else {
#line 136
          tmp___22 = memcmp((void const   *)name, (void const   *)"default_network",
                            (size_t )15);
#line 136
          if (tmp___22 == 0) {
#line 138
            strncpy((char * __restrict  )((*config)->default_network), (char const   * __restrict  )value,
                    (size_t )255);
          } else {
#line 140
            tmp___21 = memcmp((void const   *)name, (void const   *)"allow_servlets",
                              (size_t )14);
#line 140
            if (tmp___21 == 0) {
#line 142
              strncpy((char * __restrict  )((*config)->default_allow), (char const   * __restrict  )value,
                      (size_t )255);
            } else {
#line 144
              tmp___20 = memcmp((void const   *)name, (void const   *)"server_url",
                                (size_t )10);
#line 144
              if (tmp___20 == 0) {
#line 146
                strncpy((char * __restrict  )((*config)->server_url), (char const   * __restrict  )value,
                        (size_t )255);
              } else {
#line 148
                tmp___19 = memcmp((void const   *)name, (void const   *)"bind_ip",
                                  (size_t )7);
#line 148
                if (tmp___19 == 0) {
#line 150
                  strncpy((char * __restrict  )((*config)->bind_ip), (char const   * __restrict  )value,
                          (size_t )15);
                } else {
#line 152
                  tmp___18 = memcmp((void const   *)name, (void const   *)"web_bind_port",
                                    (size_t )9);
#line 152
                  if (tmp___18 == 0) {
#line 154
                    strncpy((char * __restrict  )((*config)->web_bind_port), (char const   * __restrict  )value,
                            (size_t )9);
                  } else {
#line 156
                    tmp___17 = memcmp((void const   *)name, (void const   *)"gnutella_bind_port",
                                      (size_t )18);
#line 156
                    if (tmp___17 == 0) {
#line 158
                      strncpy((char * __restrict  )((*config)->gnutella_bind_port),
                              (char const   * __restrict  )value, (size_t )9);
                    } else {
#line 160
                      tmp___16 = memcmp((void const   *)name, (void const   *)"data_dir",
                                        (size_t )8);
#line 160
                      if (tmp___16 == 0) {
#line 162
                        strncpy((char * __restrict  )((*config)->data_dir), (char const   * __restrict  )value,
                                (size_t )255);
                      } else {
#line 164
                        tmp___15 = memcmp((void const   *)name, (void const   *)"cpcd_keep_log",
                                          (size_t )13);
#line 164
                        if (tmp___15 == 0) {
#line 166
                          (*config)->cpcd_keep_log = atoi((char const   *)value);
                        } else {
#line 168
                          tmp___14 = memcmp((void const   *)name, (void const   *)"log_dir",
                                            (size_t )7);
#line 168
                          if (tmp___14 == 0) {
#line 170
                            snprintf((char * __restrict  )((*config)->log_file), (size_t )255,
                                     (char const   * __restrict  )"%s/cpcd.log", value);
                          } else {
#line 172
                            tmp___13 = memcmp((void const   *)name, (void const   *)"pid_dir",
                                              (size_t )7);
#line 172
                            if (tmp___13 == 0) {
#line 174
                              snprintf((char * __restrict  )((*config)->pid_file),
                                       (size_t )255, (char const   * __restrict  )"%s/cpcd.pid",
                                       value);
                            } else {
#line 176
                              tmp___12 = memcmp((void const   *)name, (void const   *)"cpcd_throttle_support",
                                                (size_t )21);
#line 176
                              if (tmp___12 == 0) {
#line 178
                                (*config)->cpcd_throttle_support = atoi((char const   *)value);
                              } else {
#line 180
                                tmp___11 = memcmp((void const   *)name, (void const   *)"max_hosts",
                                                  (size_t )9);
#line 180
                                if (tmp___11 == 0) {
#line 182
                                  (*config)->max_hosts = atoi((char const   *)value);
                                } else {
#line 184
                                  tmp___10 = memcmp((void const   *)name, (void const   *)"max_urls",
                                                    (size_t )8);
#line 184
                                  if (tmp___10 == 0) {
#line 186
                                    (*config)->max_urls = atoi((char const   *)value);
                                  } else {
#line 188
                                    tmp___9 = memcmp((void const   *)name, (void const   *)"max_nets",
                                                     (size_t )8);
#line 188
                                    if (tmp___9 == 0) {
#line 190
                                      (*config)->max_nets = atoi((char const   *)value);
                                    } else {
#line 192
                                      tmp___8 = memcmp((void const   *)name, (void const   *)"listen_threads",
                                                       (size_t )14);
#line 192
                                      if (tmp___8 == 0) {
#line 194
                                        (*config)->listen_threads = atoi((char const   *)value);
                                      } else {
#line 196
                                        tmp___7 = memcmp((void const   *)name, (void const   *)"host_threads",
                                                         (size_t )12);
#line 196
                                        if (tmp___7 == 0) {
#line 198
                                          (*config)->host_threads = atoi((char const   *)value);
                                        } else {
#line 200
                                          tmp___6 = memcmp((void const   *)name, (void const   *)"port_restriction",
                                                           (size_t )16);
#line 200
                                          if (tmp___6 == 0) {
#line 202
                                            (*config)->port_restriction = atoi((char const   *)value);
                                          } else {
#line 206
                                            fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"cpcd_config:  Rejected config var: %s\n",
                                                    name);
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
#line 210
  fclose(conf_file);
#line 212
  return (0);
}
}
#line 1 "cpcd-cpcd_util.o"
#pragma merger("0","/tmp/cil-qVmeZktU.i","-g,-O2,-Wall,-g,-O2")
#line 366 "/usr/include/unistd.h"
extern ssize_t ( __attribute__((__warn_unused_result__)) write)(int __fd , void const   *__buf ,
                                                                size_t __n ) ;
#line 628
extern  __attribute__((__nothrow__)) __pid_t ( __attribute__((__leaf__)) getpid)(void) ;
#line 138 "/usr/include/x86_64-linux-gnu/sys/socket.h"
extern int connect(int __fd , struct sockaddr  const  *__addr , socklen_t __len ) ;
#line 179 "/usr/include/netdb.h"
extern int gethostbyname_r(char const   * __restrict  __name , struct hostent * __restrict  __result_buf ,
                           char * __restrict  __buf , size_t __buflen , struct hostent ** __restrict  __result ,
                           int * __restrict  __h_errnop ) ;
#line 205 "/usr/include/time.h"
extern  __attribute__((__nothrow__)) size_t ( __attribute__((__leaf__)) strftime)(char * __restrict  __s ,
                                                                                  size_t __maxsize ,
                                                                                  char const   * __restrict  __format ,
                                                                                  struct tm  const  * __restrict  __tp ) ;
#line 243
extern  __attribute__((__nothrow__)) struct tm *( __attribute__((__leaf__)) localtime)(time_t const   *__timer ) ;
#line 254
extern  __attribute__((__nothrow__)) struct tm *( __attribute__((__leaf__)) localtime_r)(time_t const   * __restrict  __timer ,
                                                                                         struct tm * __restrict  __tp ) ;
#line 137 "/usr/include/fcntl.h"
extern int fcntl(int __fd , int __cmd  , ...) ;
#line 50 "/usr/include/x86_64-linux-gnu/bits/errno.h"
extern  __attribute__((__nothrow__)) int *( __attribute__((__leaf__)) __errno_location)(void)  __attribute__((__const__)) ;
#line 178 "/usr/include/stdio.h"
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) remove)(char const   *__filename ) ;
#line 180
extern  __attribute__((__nothrow__)) int ( __attribute__((__leaf__)) rename)(char const   *__old ,
                                                                             char const   *__new ) ;
#line 242
extern int fflush(FILE *__stream ) ;
#line 689
extern int fputs(char const   * __restrict  __s , FILE * __restrict  __stream ) ;
#line 846
extern void perror(char const   *__s ) ;
#line 39 "cpcd_util.h"
static char const   gwc_ping[46]  = 
#line 39 "cpcd_util.h"
  {      (char const   )'?',      (char const   )'p',      (char const   )'i',      (char const   )'n', 
        (char const   )'g',      (char const   )'=',      (char const   )'1',      (char const   )'&', 
        (char const   )'n',      (char const   )'e',      (char const   )'t',      (char const   )'=', 
        (char const   )'g',      (char const   )'n',      (char const   )'u',      (char const   )'t', 
        (char const   )'e',      (char const   )'l',      (char const   )'l',      (char const   )'a', 
        (char const   )'&',      (char const   )'c',      (char const   )'l',      (char const   )'i', 
        (char const   )'e',      (char const   )'n',      (char const   )'t',      (char const   )'=', 
        (char const   )'T',      (char const   )'E',      (char const   )'S',      (char const   )'T', 
        (char const   )'&',      (char const   )'V',      (char const   )'e',      (char const   )'r', 
        (char const   )'s',      (char const   )'i',      (char const   )'o',      (char const   )'n', 
        (char const   )'=',      (char const   )'C',      (char const   )'P',      (char const   )'W', 
        (char const   )'C',      (char const   )'\000'};
#line 40 "cpcd_util.h"
static char const   gwc_ping_v2[47]  = 
#line 40
  {      (char const   )'?',      (char const   )'p',      (char const   )'i',      (char const   )'n', 
        (char const   )'g',      (char const   )'=',      (char const   )'1',      (char const   )'&', 
        (char const   )'n',      (char const   )'e',      (char const   )'t',      (char const   )'=', 
        (char const   )'g',      (char const   )'n',      (char const   )'u',      (char const   )'t', 
        (char const   )'e',      (char const   )'l',      (char const   )'l',      (char const   )'a', 
        (char const   )'2',      (char const   )'&',      (char const   )'c',      (char const   )'l', 
        (char const   )'i',      (char const   )'e',      (char const   )'n',      (char const   )'t', 
        (char const   )'=',      (char const   )'T',      (char const   )'E',      (char const   )'S', 
        (char const   )'T',      (char const   )'&',      (char const   )'V',      (char const   )'e', 
        (char const   )'r',      (char const   )'s',      (char const   )'i',      (char const   )'o', 
        (char const   )'n',      (char const   )'=',      (char const   )'C',      (char const   )'P', 
        (char const   )'W',      (char const   )'C',      (char const   )'\000'};
#line 45
int ping_cache_v1(struct cpcd_ctx *ctx___0 , char *file , char *hostname , unsigned long portnum ) ;
#line 46
int ping_cache_v2(struct cpcd_ctx *ctx___0 , char *file , char *hostname , unsigned long portnum ) ;
#line 54
int read_file(struct cpcd_config *config , struct hosts **cached_hosts , char *network ) ;
#line 58
int load_network_cache(struct cpcd_ctx **ctx___0 , char *net ) ;
#line 69
int str_to_lower(char **string ) ;
#line 70
int get_age_r(long *age , char **str_age , unsigned int buff_size ) ;
#line 19 "cpcd_util.c"
static pthread_mutex_t log_mutex  =    {{0, 0U, 0, 0U, 0, 0, {(struct __pthread_internal_list *)0, (struct __pthread_internal_list *)0}}};
#line 22 "cpcd_util.c"
int need_more_caches(struct hosts *caches , int max ) 
{ 
  int count ;
  struct hosts *walk_host ;
  unsigned long age ;
  time_t now ;

  {
#line 24
  count = 0;
#line 25
  walk_host = (struct hosts *)((void *)0);
#line 26
  age = 0UL;
#line 27
  now = (time_t )0;
#line 30
  now = time((time_t *)((void *)0));
#line 31
  count = count_nodes(caches, 3);
#line 32
  if (count < max) {
#line 33
    return (1);
  }
#line 35
  walk_host = get_first_host(caches);
#line 36
  if ((unsigned long )walk_host == (unsigned long )((void *)0)) {
#line 37
    return (1);
  }
#line 39
  while ((unsigned long )walk_host != (unsigned long )((void *)0)) {
#line 41
    if ((int )walk_host->type == 85) {
#line 43
      age = (unsigned long )now - walk_host->bdate;
#line 44
      if (age > 86400UL) {
#line 45
        return (1);
      }
    }
#line 47
    walk_host = walk_host->next;
  }
#line 51
  return (0);
}
}
#line 55 "cpcd_util.c"
int clean_url_r(char *url , char **clean_url , int buff_size ) 
{ 
  char *h ;
  char *p ;
  char *q ;
  char *r ;
  char *s ;
  char hostname[256] ;
  char port[256] ;
  char fileloc[256] ;
  char *file ;
  unsigned long portnum ;
  unsigned int len ;
  int rslt ;
  char *tmp___0 ;
  char *tmp___2 ;
  char *tmp___4 ;
  size_t tmp___5 ;
  unsigned short const   **tmp___6 ;
  long tmp___7 ;
  unsigned short const   **tmp___8 ;

  {
#line 57
  h = (char *)((void *)0);
#line 58
  p = (char *)((void *)0);
#line 59
  q = (char *)((void *)0);
#line 60
  r = (char *)((void *)0);
#line 61
  s = (char *)((void *)0);
#line 65
  file = (char *)((void *)0);
#line 66
  portnum = 0UL;
#line 67
  len = 0U;
#line 68
  rslt = 0;
#line 71
  if ((unsigned long )url == (unsigned long )((void *)0)) {
#line 73
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"System Error: clean_url was passed a NULL apgument\n");
#line 75
    return (-1);
  }
#line 77
  memset((void *)(hostname), 0, (size_t )256);
#line 78
  memset((void *)(port), 0, (size_t )256);
#line 79
  memset((void *)(fileloc), 0, (size_t )256);
#line 81
  rslt = memcmp((void const   *)url, (void const   *)"http://", (size_t )7);
#line 82
  if (rslt != 0) {
#line 84
    return (-1);
  }
#line 86
  p = strstr((char const   *)url, "://");
#line 87
  if ((unsigned long )p == (unsigned long )((void *)0)) {
#line 88
    return (-1);
  }
#line 89
  p += 3;
#line 90
  if ((unsigned long )p == (unsigned long )((void *)0)) {
#line 91
    return (-1);
  }
#line 92
  tmp___0 = __builtin_strchr(p, ':');
#line 92
  q = tmp___0;
#line 93
  if ((unsigned long )q == (unsigned long )((void *)0)) {
#line 96
    tmp___2 = __builtin_strchr(p, '/');
#line 96
    q = tmp___2;
#line 97
    if ((unsigned long )q == (unsigned long )((void *)0)) {
#line 99
      strncpy((char * __restrict  )(hostname), (char const   * __restrict  )p, (size_t )255);
    } else {
#line 105
      r = q;
#line 106
      r ++;
#line 107
      *q = (char )'\000';
#line 108
      strncpy((char * __restrict  )(hostname), (char const   * __restrict  )p, (size_t )255);
#line 109
      strncpy((char * __restrict  )(fileloc), (char const   * __restrict  )r, (size_t )255);
    }
  } else {
#line 115
    r = q;
#line 116
    r ++;
#line 117
    *q = (char )'\000';
#line 118
    strncpy((char * __restrict  )(hostname), (char const   * __restrict  )p, (size_t )255);
#line 120
    tmp___4 = __builtin_strchr(r, '/');
#line 120
    q = tmp___4;
#line 121
    if ((unsigned long )q == (unsigned long )((void *)0)) {
#line 124
      strncpy((char * __restrict  )(port), (char const   * __restrict  )r, (size_t )255);
#line 125
      strncpy((char * __restrict  )(fileloc), (char const   * __restrict  )q, (size_t )255);
    } else {
#line 130
      s = q;
#line 131
      *s = (char )'\000';
#line 132
      q ++;
#line 133
      strncpy((char * __restrict  )(port), (char const   * __restrict  )r, (size_t )255);
#line 134
      strncpy((char * __restrict  )(fileloc), (char const   * __restrict  )q, (size_t )255);
    }
  }
#line 137
  tmp___5 = strlen((char const   *)(hostname));
#line 137
  len = (unsigned int )tmp___5;
#line 138
  len --;
#line 139
  if ((int )hostname[len] == 46) {
#line 140
    hostname[len] = (char )'\000';
  }
#line 141
  tmp___6 = __ctype_b_loc();
#line 141
  if ((int const   )*(*tmp___6 + (int )hostname[len]) & 2048) {
#line 143
    return (-1);
  }
#line 145
  file = & fileloc[0];
#line 146
  if ((unsigned long )file != (unsigned long )((void *)0)) {
#line 148
    while (1) {
#line 148
      if (! ((int )*(file + 0) == 46)) {
#line 148
        if (! ((int )*(file + 0) == 47)) {
#line 148
          break;
        }
      }
#line 150
      file ++;
    }
  }
#line 153
  tmp___8 = __ctype_b_loc();
#line 153
  if ((int const   )*(*tmp___8 + (int )port[0]) & 2048) {
#line 155
    tmp___7 = atol((char const   *)(port));
#line 155
    portnum = (unsigned long )tmp___7;
#line 156
    if (portnum < 1UL) {
#line 158
      return (-1);
    } else
#line 156
    if (portnum > 32000UL) {
#line 158
      return (-1);
    }
  }
#line 168
  h = & hostname[0];
#line 169
  str_to_lower(& h);
#line 171
  if (portnum == 0UL) {
#line 173
    snprintf((char * __restrict  )*clean_url, (size_t )(buff_size - 1), (char const   * __restrict  )"http://%s/%s",
             hostname, file);
  } else {
#line 177
    snprintf((char * __restrict  )*clean_url, (size_t )(buff_size - 1), (char const   * __restrict  )"http://%s:%ln/%s",
             hostname, & portnum, file);
  }
#line 180
  return (0);
}
}
#line 184 "cpcd_util.c"
int verify_url(struct cpcd_ctx *ctx___0 , char *data ) 
{ 
  char *p ;
  char *q ;
  char *r ;
  char *s ;
  char urlb[256] ;
  char *url ;
  char hostname[256] ;
  char port[256] ;
  char fileloc[256] ;
  char newurl[256] ;
  char tmp_buffer[256] ;
  char *file ;
  int rslt ;
  unsigned long portnum ;
  unsigned int len ;
  int v1_rslt ;
  int v2_rslt ;
  char *tmp___0 ;
  char *tmp___2 ;
  char *tmp___4 ;
  size_t tmp___5 ;
  unsigned short const   **tmp___6 ;
  long tmp___7 ;
  unsigned short const   **tmp___8 ;

  {
#line 186
  p = (char *)((void *)0);
#line 187
  q = (char *)((void *)0);
#line 188
  r = (char *)((void *)0);
#line 189
  s = (char *)((void *)0);
#line 191
  url = (char *)((void *)0);
#line 197
  file = (char *)((void *)0);
#line 198
  rslt = 0;
#line 199
  portnum = 0UL;
#line 200
  len = 0U;
#line 202
  v1_rslt = 0;
#line 203
  v2_rslt = 0;
#line 206
  memset((void *)(urlb), 0, (size_t )256);
#line 207
  memset((void *)(hostname), 0, (size_t )256);
#line 208
  memset((void *)(port), 0, (size_t )256);
#line 209
  memset((void *)(fileloc), 0, (size_t )256);
#line 210
  memset((void *)(tmp_buffer), 0, (size_t )256);
#line 212
  strncpy((char * __restrict  )(urlb), (char const   * __restrict  )data, (size_t )255);
#line 213
  url = & urlb[0];
#line 215
  rslt = memcmp((void const   *)url, (void const   *)"http://", (size_t )7);
#line 216
  if (rslt != 0) {
#line 218
    return (-1);
  }
#line 220
  p = strstr((char const   *)url, "://");
#line 221
  if ((unsigned long )p == (unsigned long )((void *)0)) {
#line 222
    return (-1);
  }
#line 223
  p += 3;
#line 224
  if ((unsigned long )p == (unsigned long )((void *)0)) {
#line 225
    return (-1);
  }
#line 226
  tmp___0 = __builtin_strchr(p, ':');
#line 226
  q = tmp___0;
#line 227
  if ((unsigned long )q == (unsigned long )((void *)0)) {
#line 230
    tmp___2 = __builtin_strchr(p, '/');
#line 230
    q = tmp___2;
#line 231
    if ((unsigned long )q == (unsigned long )((void *)0)) {
#line 233
      strncpy((char * __restrict  )(hostname), (char const   * __restrict  )p, (size_t )255);
    } else {
#line 239
      r = q;
#line 240
      r ++;
#line 241
      *q = (char )'\000';
#line 242
      strncpy((char * __restrict  )(hostname), (char const   * __restrict  )p, (size_t )255);
#line 243
      strncpy((char * __restrict  )(fileloc), (char const   * __restrict  )r, (size_t )255);
    }
  } else {
#line 249
    r = q;
#line 250
    r ++;
#line 251
    *q = (char )'\000';
#line 252
    strncpy((char * __restrict  )(hostname), (char const   * __restrict  )p, (size_t )255);
#line 254
    tmp___4 = __builtin_strchr(r, '/');
#line 254
    q = tmp___4;
#line 255
    if ((unsigned long )q == (unsigned long )((void *)0)) {
#line 258
      strncpy((char * __restrict  )(port), (char const   * __restrict  )r, (size_t )255);
#line 259
      strncpy((char * __restrict  )(fileloc), (char const   * __restrict  )q, (size_t )255);
    } else {
#line 264
      s = q;
#line 265
      *s = (char )'\000';
#line 266
      q ++;
#line 267
      strncpy((char * __restrict  )(port), (char const   * __restrict  )r, (size_t )255);
#line 268
      strncpy((char * __restrict  )(fileloc), (char const   * __restrict  )q, (size_t )255);
    }
  }
#line 271
  tmp___5 = strlen((char const   *)(hostname));
#line 271
  len = (unsigned int )tmp___5;
#line 272
  len --;
#line 273
  if ((int )hostname[len] == 46) {
#line 274
    hostname[len] = (char )'\000';
  }
#line 275
  tmp___6 = __ctype_b_loc();
#line 275
  if ((int const   )*(*tmp___6 + (int )hostname[len]) & 2048) {
#line 277
    return (-1);
  }
#line 279
  file = & fileloc[0];
#line 280
  if ((unsigned long )file != (unsigned long )((void *)0)) {
#line 282
    while (1) {
#line 282
      if (! ((int )*(file + 0) == 46)) {
#line 282
        if (! ((int )*(file + 0) == 47)) {
#line 282
          break;
        }
      }
#line 284
      file ++;
    }
  }
#line 287
  tmp___8 = __ctype_b_loc();
#line 287
  if ((int const   )*(*tmp___8 + (int )port[0]) & 2048) {
#line 289
    tmp___7 = atol((char const   *)(port));
#line 289
    portnum = (unsigned long )tmp___7;
#line 290
    if (portnum < 1UL) {
#line 292
      return (-1);
    } else
#line 290
    if (portnum > 32000UL) {
#line 292
      return (-1);
    }
  }
#line 295
  if (portnum == 0UL) {
#line 297
    snprintf((char * __restrict  )(newurl), (size_t )255, (char const   * __restrict  )"http://%s/%s",
             hostname, file);
#line 298
    portnum = 80UL;
  } else {
#line 302
    snprintf((char * __restrict  )(newurl), (size_t )255, (char const   * __restrict  )"http://%s:%ln/%s",
             hostname, & portnum, file);
  }
#line 305
  v1_rslt = ping_cache_v1(ctx___0, file, hostname, portnum);
#line 306
  v2_rslt = ping_cache_v2(ctx___0, file, hostname, portnum);
#line 308
  if (v1_rslt == 0) {
#line 308
    if (v2_rslt == 0) {
#line 310
      return (0);
    } else {
#line 308
      goto _L___1;
    }
  } else
  _L___1: /* CIL Label */ 
#line 312
  if (v1_rslt == 1) {
#line 312
    if (v2_rslt == 0) {
#line 314
      return (1);
    } else {
#line 312
      goto _L___0;
    }
  } else
  _L___0: /* CIL Label */ 
#line 316
  if (v1_rslt == 0) {
#line 316
    if (v2_rslt == 1) {
#line 318
      return (2);
    } else {
#line 316
      goto _L;
    }
  } else
  _L: /* CIL Label */ 
#line 320
  if (v1_rslt == 1) {
#line 320
    if (v2_rslt == 1) {
#line 322
      return (3);
    }
  }
#line 325
  return (0);
}
}
#line 329 "cpcd_util.c"
int ping_cache_v1(struct cpcd_ctx *ctx___0 , char *file , char *hostname , unsigned long portnum ) 
{ 
  int sockfd ;
  struct sockaddr_in addr ;
  struct hostent ret ;
  struct hostent hostinfo ;
  struct hostent *hostinfo_p ;
  char hostent_buff[1024] ;
  char tmp_buffer[256] ;
  int rslt ;
  unsigned int len ;
  int h_errnop ;
  unsigned short const   **tmp ;
  register unsigned short __v ;
  register unsigned short __x ;
  char *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;

  {
#line 331
  sockfd = 0;
#line 335
  hostinfo_p = (struct hostent *)((void *)0);
#line 339
  rslt = 0;
#line 340
  len = 0U;
#line 341
  h_errnop = 0;
#line 344
  memset((void *)(tmp_buffer), 0, (size_t )256);
#line 345
  memset((void *)(hostent_buff), 0, (size_t )1024);
#line 348
  hostinfo_p = & hostinfo;
#line 349
  sockfd = socket(2, 1, 0);
#line 350
  if (sockfd == -1) {
#line 352
    return (-1);
  }
#line 355
  addr.sin_family = (sa_family_t )2;
#line 357
  strncpy((char * __restrict  )(tmp_buffer), (char const   * __restrict  )hostname,
          (size_t )1);
#line 358
  tmp = __ctype_b_loc();
#line 358
  if ((int const   )*(*tmp + (int )tmp_buffer[0]) & 2048) {
#line 360
    addr.sin_addr.s_addr = inet_addr((char const   *)hostname);
  } else {
#line 364
    rslt = gethostbyname_r((char const   * __restrict  )hostname, (struct hostent * __restrict  )(& ret),
                           (char * __restrict  )(hostent_buff), (size_t )1024, (struct hostent ** __restrict  )(& hostinfo_p),
                           (int * __restrict  )(& h_errnop));
#line 365
    if (rslt != 0) {
#line 367
      close(sockfd);
#line 369
      return (-1);
    } else
#line 365
    if ((unsigned long )hostinfo_p == (unsigned long )((void *)0)) {
#line 367
      close(sockfd);
#line 369
      return (-1);
    }
#line 371
    addr.sin_addr = *((struct in_addr *)*(hostinfo_p->h_addr_list));
  }
#line 373
  __x = (unsigned short )portnum;
#line 373
  __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 373
  addr.sin_port = __v;
#line 374
  len = (unsigned int )sizeof(addr);
#line 376
  rslt = connect_nonblock(ctx___0, & sockfd, (struct sockaddr *)(& addr), len);
#line 377
  if (rslt == -1) {
#line 379
    close(sockfd);
#line 381
    return (-1);
  }
#line 384
  snprintf((char * __restrict  )(tmp_buffer), (size_t )255, (char const   * __restrict  )"GET /%s%s HTTP/1.1\r\n",
           file, gwc_ping);
#line 385
  write_line_to_socket(sockfd, tmp_buffer);
#line 387
  snprintf((char * __restrict  )(tmp_buffer), (size_t )255, (char const   * __restrict  )"Host: %s\r\n\r\n",
           hostname);
#line 388
  write_line_to_socket(sockfd, tmp_buffer);
#line 391
  rslt = read_line(sockfd, (unsigned char *)(tmp_buffer), (unsigned int )sizeof(tmp_buffer));
#line 392
  if (rslt < 2) {
#line 394
    shutdown(sockfd, 2);
#line 395
    close(sockfd);
#line 397
    return (-1);
  }
#line 401
  tmp___0 = strstr((char const   *)(tmp_buffer), "200 OK");
#line 401
  if ((unsigned long )tmp___0 == (unsigned long )((void *)0)) {
#line 403
    shutdown(sockfd, 2);
#line 404
    close(sockfd);
#line 406
    return (-1);
  }
#line 409
  while (1) {
#line 411
    rslt = read_line(sockfd, (unsigned char *)(tmp_buffer), (unsigned int )sizeof(tmp_buffer));
#line 412
    if (rslt < 2) {
#line 414
      shutdown(sockfd, 2);
#line 415
      close(sockfd);
#line 417
      return (-1);
    }
#line 409
    if ((int )tmp_buffer[0] != 13) {
#line 409
      if (! ((int )tmp_buffer[0] != 10)) {
#line 409
        break;
      }
    } else {
#line 409
      break;
    }
  }
#line 421
  memset((void *)(tmp_buffer), 0, (size_t )256);
#line 422
  rslt = read_line(sockfd, (unsigned char *)(tmp_buffer), (unsigned int )sizeof(tmp_buffer));
#line 423
  if (rslt < 2) {
#line 425
    shutdown(sockfd, 2);
#line 426
    close(sockfd);
#line 427
    return (-1);
  }
#line 429
  tmp___1 = strstr((char const   *)(tmp_buffer), "PONG");
#line 429
  if ((unsigned long )tmp___1 == (unsigned long )((void *)0)) {
#line 429
    tmp___2 = strstr((char const   *)(tmp_buffer), "pong");
#line 429
    if ((unsigned long )tmp___2 == (unsigned long )((void *)0)) {
#line 432
      shutdown(sockfd, 2);
#line 433
      close(sockfd);
#line 435
      return (0);
    }
  }
#line 438
  shutdown(sockfd, 2);
#line 439
  close(sockfd);
#line 441
  return (1);
}
}
#line 445 "cpcd_util.c"
int ping_cache_v2(struct cpcd_ctx *ctx___0 , char *file , char *hostname , unsigned long portnum ) 
{ 
  int sockfd ;
  struct sockaddr_in addr ;
  struct hostent ret ;
  struct hostent hostinfo ;
  struct hostent *hostinfo_p ;
  char hostent_buff[1024] ;
  char tmp_buffer[256] ;
  int rslt ;
  unsigned int len ;
  int h_errnop ;
  unsigned short const   **tmp ;
  register unsigned short __v ;
  register unsigned short __x ;
  char *tmp___0 ;
  char *tmp___1 ;
  char *tmp___2 ;

  {
#line 447
  sockfd = 0;
#line 451
  hostinfo_p = (struct hostent *)((void *)0);
#line 455
  rslt = 0;
#line 456
  len = 0U;
#line 457
  h_errnop = 0;
#line 460
  memset((void *)(tmp_buffer), 0, (size_t )256);
#line 461
  memset((void *)(hostent_buff), 0, (size_t )1024);
#line 464
  hostinfo_p = & hostinfo;
#line 465
  sockfd = socket(2, 1, 0);
#line 466
  if (sockfd == -1) {
#line 468
    return (-1);
  }
#line 471
  addr.sin_family = (sa_family_t )2;
#line 473
  strncpy((char * __restrict  )(tmp_buffer), (char const   * __restrict  )hostname,
          (size_t )1);
#line 474
  tmp = __ctype_b_loc();
#line 474
  if ((int const   )*(*tmp + (int )tmp_buffer[0]) & 2048) {
#line 476
    addr.sin_addr.s_addr = inet_addr((char const   *)hostname);
  } else {
#line 480
    rslt = gethostbyname_r((char const   * __restrict  )hostname, (struct hostent * __restrict  )(& ret),
                           (char * __restrict  )(hostent_buff), (size_t )1024, (struct hostent ** __restrict  )(& hostinfo_p),
                           (int * __restrict  )(& h_errnop));
#line 481
    if (rslt != 0) {
#line 483
      close(sockfd);
#line 485
      return (-1);
    } else
#line 481
    if ((unsigned long )hostinfo_p == (unsigned long )((void *)0)) {
#line 483
      close(sockfd);
#line 485
      return (-1);
    }
#line 487
    addr.sin_addr = *((struct in_addr *)*(hostinfo_p->h_addr_list));
  }
#line 489
  __x = (unsigned short )portnum;
#line 489
  __asm__  ("rorw $8, %w0": "=r" (__v): "0" (__x): "cc");
#line 489
  addr.sin_port = __v;
#line 490
  len = (unsigned int )sizeof(addr);
#line 492
  rslt = connect_nonblock(ctx___0, & sockfd, (struct sockaddr *)(& addr), len);
#line 493
  if (rslt == -1) {
#line 495
    close(sockfd);
#line 497
    return (-1);
  }
#line 500
  snprintf((char * __restrict  )(tmp_buffer), (size_t )255, (char const   * __restrict  )"GET /%s%s HTTP/1.1\r\n",
           file, gwc_ping_v2);
#line 501
  write_line_to_socket(sockfd, tmp_buffer);
#line 503
  snprintf((char * __restrict  )(tmp_buffer), (size_t )255, (char const   * __restrict  )"Host: %s\r\n\r\n",
           hostname);
#line 504
  write_line_to_socket(sockfd, tmp_buffer);
#line 507
  rslt = read_line(sockfd, (unsigned char *)(tmp_buffer), (unsigned int )sizeof(tmp_buffer));
#line 508
  if (rslt < 2) {
#line 510
    shutdown(sockfd, 2);
#line 511
    close(sockfd);
#line 512
    return (-1);
  }
#line 516
  tmp___0 = strstr((char const   *)(tmp_buffer), "200 OK");
#line 516
  if ((unsigned long )tmp___0 == (unsigned long )((void *)0)) {
#line 518
    shutdown(sockfd, 2);
#line 519
    close(sockfd);
#line 521
    return (-1);
  }
#line 524
  while (1) {
#line 526
    rslt = read_line(sockfd, (unsigned char *)(tmp_buffer), (unsigned int )sizeof(tmp_buffer));
#line 527
    if (rslt < 2) {
#line 529
      shutdown(sockfd, 2);
#line 530
      close(sockfd);
#line 531
      return (-1);
    }
#line 524
    if ((int )tmp_buffer[0] != 13) {
#line 524
      if (! ((int )tmp_buffer[0] != 10)) {
#line 524
        break;
      }
    } else {
#line 524
      break;
    }
  }
#line 535
  memset((void *)(tmp_buffer), 0, (size_t )256);
#line 536
  rslt = read_line(sockfd, (unsigned char *)(tmp_buffer), (unsigned int )sizeof(tmp_buffer));
#line 537
  if (rslt < 2) {
#line 539
    shutdown(sockfd, 2);
#line 540
    close(sockfd);
#line 541
    return (-1);
  }
#line 543
  tmp___1 = strstr((char const   *)(tmp_buffer), "PONG");
#line 543
  if ((unsigned long )tmp___1 == (unsigned long )((void *)0)) {
#line 543
    tmp___2 = strstr((char const   *)(tmp_buffer), "pong");
#line 543
    if ((unsigned long )tmp___2 == (unsigned long )((void *)0)) {
#line 545
      shutdown(sockfd, 2);
#line 546
      close(sockfd);
#line 548
      return (0);
    }
  }
#line 551
  shutdown(sockfd, 2);
#line 552
  close(sockfd);
#line 554
  return (1);
}
}
#line 559 "cpcd_util.c"
int write_pid_file(char *file_loc ) 
{ 
  FILE *pid_file ;
  pid_t pid ;

  {
#line 561
  pid_file = (FILE *)((void *)0);
#line 562
  pid = -1;
#line 565
  pid = getpid();
#line 566
  pid_file = fopen((char const   * __restrict  )file_loc, (char const   * __restrict  )"w");
#line 566
  if ((unsigned long )((void *)0) == (unsigned long )pid_file) {
#line 568
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Error: Failed to open pid file: %s\n",
            file_loc);
#line 570
    return (-1);
  }
#line 572
  fprintf((FILE * __restrict  )pid_file, (char const   * __restrict  )"%d", pid);
#line 573
  fclose(pid_file);
#line 575
  return (0);
}
}
#line 579 "cpcd_util.c"
int delete_pid_file(char *file_loc ) 
{ 
  int rslt ;

  {
#line 581
  rslt = 0;
#line 584
  rslt = remove((char const   *)file_loc);
#line 585
  if (rslt == -1) {
#line 587
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to remove pid file: %s\n",
            file_loc);
#line 588
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Please, remove the file manually.\n");
#line 590
    return (-1);
  }
#line 593
  return (0);
}
}
#line 597 "cpcd_util.c"
int file_exists(char *path ) 
{ 
  int rslt ;
  struct stat tmp_stats ;

  {
#line 599
  rslt = 0;
#line 603
  rslt = lstat((char const   * __restrict  )path, (struct stat * __restrict  )(& tmp_stats));
#line 604
  if (rslt != -1) {
#line 606
    return (1);
  }
#line 609
  return (0);
}
}
#line 613 "cpcd_util.c"
int write_file(struct cpcd_config *config , struct hosts *cached_hosts , char *network ) 
{ 
  FILE *data ;
  char file_path[1024] ;
  char tmp_file_path[1024] ;
  struct hosts *walk_cached_hosts ;
  int rslt ;
  struct stat tmp_stats ;

  {
#line 615
  data = (FILE *)((void *)0);
#line 618
  walk_cached_hosts = (struct hosts *)((void *)0);
#line 619
  rslt = 0;
#line 623
  if ((unsigned long )cached_hosts == (unsigned long )((void *)0)) {
#line 625
    return (-1);
  }
#line 628
  walk_cached_hosts = get_first_host(cached_hosts);
#line 629
  if ((unsigned long )walk_cached_hosts == (unsigned long )((void *)0)) {
#line 631
    return (-1);
  }
#line 634
  memset((void *)(file_path), 0, (size_t )1024);
#line 635
  memset((void *)(tmp_file_path), 0, (size_t )1024);
#line 637
  snprintf((char * __restrict  )(file_path), (size_t )1018, (char const   * __restrict  )"%s/%s.dat",
           config->data_dir, network);
#line 638
  snprintf((char * __restrict  )(tmp_file_path), (size_t )1023, (char const   * __restrict  )"%s/%s.dat.tmp",
           config->data_dir, network);
#line 640
  rslt = lstat((char const   * __restrict  )(tmp_file_path), (struct stat * __restrict  )(& tmp_stats));
#line 641
  if (rslt != -1) {
#line 643
    if (((tmp_stats.st_mode & 61440U) == 32768U) != 0) {
#line 645
      rslt = remove((char const   *)(tmp_file_path));
#line 646
      if (rslt != -1) {
#line 648
        fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to remove stale tmp file.  Please, remove it manually.  File: %s\n",
                tmp_file_path);
#line 650
        return (-1);
      }
    } else {
#line 655
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Tmp file appears to exist.  Please, remove it.\n");
#line 657
      return (-1);
    }
  }
#line 661
  data = fopen((char const   * __restrict  )(tmp_file_path), (char const   * __restrict  )"w");
#line 661
  if ((unsigned long )((void *)0) == (unsigned long )data) {
#line 663
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to open tmp data file for writing.\n");
#line 665
    return (-1);
  }
#line 668
  while ((unsigned long )walk_cached_hosts != (unsigned long )((void *)0)) {
#line 670
    if ((unsigned long )walk_cached_hosts->addr != (unsigned long )((void *)0)) {
#line 672
      rslt = fprintf((FILE * __restrict  )data, (char const   * __restrict  )"%c|%s|%ln|\n",
                     (int )walk_cached_hosts->type, walk_cached_hosts->addr, & walk_cached_hosts->bdate);
#line 673
      if (rslt < 1) {
#line 675
        fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Error writing file. Disk may be full.\n");
#line 676
        remove((char const   *)(tmp_file_path));
#line 678
        return (-1);
      }
    }
#line 682
    walk_cached_hosts = walk_cached_hosts->next;
  }
#line 684
  fclose(data);
#line 686
  rslt = rename((char const   *)(tmp_file_path), (char const   *)(file_path));
#line 687
  if (rslt == -1) {
#line 689
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to overwrite data file (%s) with tmp file (%s)\n",
            file_path, tmp_file_path);
#line 691
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Disk may be full.\n");
#line 693
    return (-1);
  }
#line 697
  return (0);
}
}
#line 701 "cpcd_util.c"
int load_network_caches(struct cpcd_ctx **ctx___0 , char *networks ) 
{ 
  char *net ;
  char *p ;
  int rslt ;
  char nets[512] ;
  char *tmp___0 ;
  char *tmp___2 ;

  {
#line 703
  net = (char *)((void *)0);
#line 704
  p = (char *)((void *)0);
#line 705
  rslt = 0;
#line 709
  memset((void *)(nets), 0, (size_t )512);
#line 710
  strncpy((char * __restrict  )(nets), (char const   * __restrict  )networks, (size_t )511);
#line 713
  tmp___0 = __strtok_r((char * __restrict  )(nets), (char const   * __restrict  )" ",
                       (char ** __restrict  )(& p));
#line 713
  net = tmp___0;
#line 714
  while (1) {
#line 716
    rslt = load_network_cache(ctx___0, net);
#line 714
    tmp___2 = __strtok_r((char * __restrict  )'\000', (char const   * __restrict  )" ",
                         (char ** __restrict  )(& p));
#line 714
    net = tmp___2;
#line 714
    if (! net) {
#line 714
      break;
    }
  }
#line 719
  rslt = read_file((*ctx___0)->config, & (*ctx___0)->bad_caches, (char *)"bad_caches");
#line 720
  if (rslt == -1) {
#line 722
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"System error reading bad cache file.\n");
  }
#line 725
  return (0);
}
}
#line 729 "cpcd_util.c"
int load_network_cache(struct cpcd_ctx **ctx___0 , char *net ) 
{ 
  int rslt ;
  struct networks *new_net ;
  void *tmp ;

  {
#line 731
  rslt = 0;
#line 732
  new_net = (struct networks *)((void *)0);
#line 735
  if ((unsigned long )net == (unsigned long )((void *)0)) {
#line 737
    return (-1);
  }
#line 740
  tmp = malloc(sizeof(struct networks ));
#line 740
  new_net = (struct networks *)tmp;
#line 741
  if ((unsigned long )new_net == (unsigned long )((void *)0)) {
#line 743
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to allocate memory for new network.\n");
#line 745
    return (-1);
  }
#line 747
  strncpy((char * __restrict  )(new_net->name), (char const   * __restrict  )net,
          (size_t )255);
#line 748
  new_net->hosts = (struct hosts *)((void *)0);
#line 749
  new_net->bad_hosts = (struct hosts *)((void *)0);
#line 751
  rslt = read_file((*ctx___0)->config, & new_net->hosts, net);
#line 752
  if (rslt == -1) {
#line 754
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"System error reading file for network %s.\n",
            net);
  }
#line 757
  (*ctx___0)->networks = add_new_network((*ctx___0)->networks, new_net);
#line 759
  return (0);
}
}
#line 763 "cpcd_util.c"
int read_file(struct cpcd_config *config , struct hosts **cached_hosts , char *network ) 
{ 
  FILE *fp ;
  char line[256] ;
  char file_path[256] ;
  char *lineptr ;
  char *type_str ;
  char *addr ;
  char *bdate_str ;
  char *p ;
  int tmp ;
  char *tmp___1 ;
  char *tmp___3 ;
  char *tmp___5 ;
  struct hosts *tmp___6 ;
  long tmp___7 ;
  char *tmp___8 ;

  {
#line 768
  lineptr = (char *)((void *)0);
#line 770
  type_str = (char *)((void *)0);
#line 771
  addr = (char *)((void *)0);
#line 772
  bdate_str = (char *)((void *)0);
#line 774
  p = (char *)((void *)0);
#line 777
  memset((void *)(line), 0, (size_t )256);
#line 778
  memset((void *)(file_path), 0, (size_t )256);
#line 780
  snprintf((char * __restrict  )(file_path), (size_t )255, (char const   * __restrict  )"%s/%s.dat",
           config->data_dir, network);
#line 783
  tmp = file_exists(file_path);
#line 783
  if (tmp == 0) {
#line 785
    fp = fopen((char const   * __restrict  )(file_path), (char const   * __restrict  )"w");
#line 786
    if ((unsigned long )fp == (unsigned long )((void *)0)) {
#line 788
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to open data file: \'%s\'\n",
              file_path);
#line 789
      perror("File error");
#line 791
      return (-1);
    }
#line 793
    fclose(fp);
  }
#line 796
  fp = fopen((char const   * __restrict  )(file_path), (char const   * __restrict  )"r");
#line 797
  if ((unsigned long )fp == (unsigned long )((void *)0)) {
#line 799
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to open data file: \'%s\'\n",
            file_path);
#line 800
    perror("File error");
#line 802
    return (-1);
  }
#line 805
  while (1) {
#line 805
    tmp___8 = fgets((char * __restrict  )(line), (int )sizeof(line), (FILE * __restrict  )fp);
#line 805
    if (! ((unsigned long )tmp___8 != (unsigned long )((void *)0))) {
#line 805
      break;
    }
#line 807
    lineptr = & line[0];
#line 808
    tmp___1 = __strtok_r((char * __restrict  )lineptr, (char const   * __restrict  )"|",
                         (char ** __restrict  )(& p));
#line 808
    type_str = tmp___1;
#line 809
    if ((unsigned long )type_str == (unsigned long )((void *)0)) {
#line 810
      continue;
    }
#line 811
    tmp___3 = __strtok_r((char * __restrict  )((void *)0), (char const   * __restrict  )"|",
                         (char ** __restrict  )(& p));
#line 811
    addr = tmp___3;
#line 812
    if ((unsigned long )addr == (unsigned long )((void *)0)) {
#line 813
      continue;
    }
#line 814
    tmp___5 = __strtok_r((char * __restrict  )((void *)0), (char const   * __restrict  )"|",
                         (char ** __restrict  )(& p));
#line 814
    bdate_str = tmp___5;
#line 815
    if ((unsigned long )bdate_str == (unsigned long )((void *)0)) {
#line 816
      continue;
    }
#line 818
    if ((unsigned long )type_str != (unsigned long )((void *)0)) {
#line 818
      if ((unsigned long )addr != (unsigned long )((void *)0)) {
#line 818
        if ((unsigned long )bdate_str != (unsigned long )((void *)0)) {
#line 820
          tmp___7 = atol((char const   *)bdate_str);
#line 820
          tmp___6 = add_new_cached_host(*cached_hosts, type_str, addr, tmp___7);
#line 820
          *cached_hosts = tmp___6;
#line 820
          if ((unsigned long )tmp___6 == (unsigned long )((void *)0)) {
#line 822
            fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"failed to add cached host.\n");
#line 824
            return (-1);
          }
        }
      }
    }
  }
#line 829
  fclose(fp);
#line 832
  return (0);
}
}
#line 836 "cpcd_util.c"
int connect_nonblock(struct cpcd_ctx *ctx___0 , int *skt , struct sockaddr *addr ,
                     unsigned int len ) 
{ 
  int i ;
  int flags ;
  int rslt ;
  int *tmp ;

  {
#line 838
  i = 0;
#line 839
  flags = 0;
#line 840
  rslt = 0;
#line 844
  flags = fcntl(*skt, 3, 0);
#line 845
  fcntl(*skt, 4, flags | 2048);
#line 847
  i = 0;
#line 847
  while (i < 10) {
#line 849
    if (ctx___0->exit_flag == 1) {
#line 851
      return (-1);
    } else {
#line 855
      rslt = connect(*skt, (struct sockaddr  const  *)addr, len);
#line 856
      if (rslt == 0) {
#line 859
        fcntl(*skt, 4, flags);
#line 860
        return (0);
      } else
#line 862
      if (rslt == -1) {
#line 864
        tmp = __errno_location();
#line 864
        if (*tmp != 115) {
#line 867
          return (-1);
        }
      }
#line 871
      sleep(1U);
    }
#line 847
    i ++;
  }
#line 875
  return (-1);
}
}
#line 879 "cpcd_util.c"
int read_line(int skt , unsigned char *buffer , unsigned int read_len ) 
{ 
  unsigned char c ;
  unsigned char *ptr ;
  unsigned int n ;
  unsigned int rc ;
  struct pollfd client[2] ;
  int rslt ;
  unsigned char *tmp ;
  ssize_t tmp___0 ;

  {
#line 881
  c = (unsigned char)0;
#line 882
  ptr = (unsigned char *)((void *)0);
#line 883
  n = 0U;
#line 884
  rc = 0U;
#line 887
  rslt = 0;
#line 890
  if (skt == -1) {
#line 891
    return (-1);
  }
#line 893
  if ((unsigned long )buffer == (unsigned long )((void *)0)) {
#line 895
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Error: NULL buffer passed to read_line.\n");
#line 897
    return (-1);
  }
#line 900
  ptr = buffer;
#line 902
  client[0].fd = skt;
#line 903
  client[1].fd = -1;
#line 904
  client[0].events = (short)1;
#line 905
  rslt = poll(client, (nfds_t )1, 3000);
#line 906
  if (rslt == -1) {
#line 908
    return (-1);
  } else
#line 910
  if (rslt == 0) {
#line 912
    return (-1);
  } else {
#line 916
    n = 1U;
#line 916
    while (n < read_len) {
#line 918
      tmp___0 = read(skt, (void *)(& c), (size_t )1);
#line 918
      rc = (unsigned int )tmp___0;
#line 918
      if (rc == 1U) {
#line 920
        tmp = ptr;
#line 920
        ptr ++;
#line 920
        *tmp = c;
#line 921
        if ((int )c == 10) {
#line 923
          break;
        }
      } else
#line 926
      if (rc == 0U) {
#line 928
        if (n == 1U) {
#line 930
          return (0);
        } else {
#line 934
          break;
        }
      } else {
#line 939
        return (-1);
      }
#line 916
      n ++;
    }
#line 942
    *ptr = (unsigned char)0;
  }
#line 946
  return ((int )n);
}
}
#line 950 "cpcd_util.c"
int write_line_to_socket(int skt , char *the_line ) 
{ 
  int status ;
  int result ;
  unsigned int count ;
  int rslt ;
  struct pollfd client[2] ;
  size_t tmp ;
  ssize_t tmp___0 ;

  {
#line 952
  status = 0;
#line 953
  result = 0;
#line 954
  count = 0U;
#line 956
  rslt = 0;
#line 960
  if (skt == -1) {
#line 961
    return (-1);
  }
#line 962
  if ((unsigned long )the_line == (unsigned long )((void *)0)) {
#line 964
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Error: NULL buffer passed to write_line_to_socket.\n");
#line 966
    return (0);
  }
#line 968
  tmp = strlen((char const   *)the_line);
#line 968
  count = (unsigned int )tmp;
#line 970
  client[0].fd = skt;
#line 971
  client[1].fd = -1;
#line 972
  client[0].events = (short)4;
#line 973
  rslt = poll(client, (nfds_t )1, 3001);
#line 975
  if (rslt == -1) {
#line 977
    return (-1);
  } else
#line 979
  if (rslt == 0) {
#line 981
    return (-1);
  } else {
#line 985
    while ((unsigned int )status != count) {
#line 987
      tmp___0 = write(skt, (void const   *)(the_line + status), (size_t )(count - (unsigned int )status));
#line 987
      result = (int )tmp___0;
#line 988
      if (result < 0) {
#line 988
        return (result);
      }
#line 989
      status += result;
    }
  }
#line 993
  return (status);
}
}
#line 997 "cpcd_util.c"
int log_access(FILE *log , char *ip , unsigned int code , char *request , unsigned long bytes ,
               char *client ) 
{ 
  char ncsa_date[256] ;
  char buffer[2048] ;
  time_t lt ;
  struct tm *ptr ;

  {
#line 1003
  ptr = (struct tm *)((void *)0);
#line 1006
  memset((void *)(ncsa_date), 0, (size_t )256);
#line 1007
  memset((void *)(buffer), 0, (size_t )2048);
#line 1009
  lt = time((time_t *)((void *)0));
#line 1010
  ptr = localtime((time_t const   *)(& lt));
#line 1012
  strftime((char * __restrict  )(& ncsa_date[0]), (size_t )255, (char const   * __restrict  )"[%d/%b/%Y:%H:%M:%S %z]",
           (struct tm  const  * __restrict  )ptr);
#line 1013
  snprintf((char * __restrict  )(buffer), (size_t )2047, (char const   * __restrict  )"%s - - %s \"%s\" %d %ln \"\" \"%s\" \"\"\n",
           ip, ncsa_date, request, code, & bytes, client);
#line 1014
  pthread_mutex_lock(& log_mutex);
#line 1015
  fputs((char const   * __restrict  )(buffer), (FILE * __restrict  )log);
#line 1016
  pthread_mutex_unlock(& log_mutex);
#line 1018
  fflush(log);
#line 1020
  return (0);
}
}
#line 1024 "cpcd_util.c"
int str_to_lower(char **string ) 
{ 
  unsigned int i ;
  int __res ;
  __int32_t const   **tmp___0 ;

  {
#line 1026
  i = 0U;
#line 1029
  if ((unsigned long )*string == (unsigned long )((void *)0)) {
#line 1031
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"strtoupper was passed a null arg.\n");
#line 1033
    return (-1);
  }
#line 1035
  while (*(*string + i)) {
#line 1037
    if (sizeof(*(*string + i)) > 1UL) {
#line 1037
      __res = tolower((int )*(*string + i));
    } else {
#line 1037
      tmp___0 = __ctype_tolower_loc();
#line 1037
      __res = (int )*(*tmp___0 + (int )*(*string + i));
    }
#line 1037
    *(*string + i) = (char )__res;
#line 1038
    i ++;
  }
#line 1041
  return (0);
}
}
#line 1046 "cpcd_util.c"
int get_age_r(long *age , char **str_age , unsigned int buff_size ) 
{ 
  struct tm *bdate ;
  void *tmp ;
  struct tm *tmp___0 ;

  {
#line 1048
  bdate = (struct tm *)((void *)0);
#line 1051
  if ((unsigned long )*str_age == (unsigned long )((void *)0)) {
#line 1052
    return (-1);
  } else
#line 1051
  if (buff_size < 30U) {
#line 1052
    return (-1);
  }
#line 1053
  tmp = malloc(sizeof(struct tm ));
#line 1053
  bdate = (struct tm *)tmp;
#line 1054
  if ((unsigned long )bdate == (unsigned long )((void *)0)) {
#line 1056
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Out of memory. Malloc call failed.\n");
#line 1058
    return (-1);
  }
#line 1060
  tmp___0 = localtime_r((time_t const   * __restrict  )age, (struct tm * __restrict  )bdate);
#line 1060
  if ((unsigned long )((void *)0) == (unsigned long )tmp___0) {
#line 1062
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Call to localtime_r failed.\n");
#line 1063
    if ((unsigned long )bdate != (unsigned long )((void *)0)) {
#line 1064
      free((void *)bdate);
    }
#line 1066
    return (-1);
  }
#line 1069
  (bdate->tm_mon) ++;
#line 1069
  snprintf((char * __restrict  )*str_age, (size_t )(buff_size - 1U), (char const   * __restrict  )"%d.%02d.%02d.%02d.%02d.%02d",
           bdate->tm_year + 1900, bdate->tm_mon, bdate->tm_mday, bdate->tm_hour, bdate->tm_min,
           bdate->tm_sec);
#line 1072
  if ((unsigned long )bdate != (unsigned long )((void *)0)) {
#line 1073
    free((void *)bdate);
  }
#line 1075
  return (0);
}
}
#line 1 "cpcd-cpcd_html.o"
#pragma merger("0","/tmp/cil-Q00CUR4s.i","-g,-O2,-Wall,-g,-O2")
#line 20 "cpcd_html.c"
long html_page(int c , struct cpcd_ctx *ctx___0 ) 
{ 
  struct hosts *walk_cached_hosts ;
  time_t current_time ;
  char buff[256] ;
  unsigned int buff_size ;
  char tmpdate[256] ;
  char *tmpdate_ptr ;
  unsigned long total_bytes ;
  int rslt ;
  struct networks *current_network ;
  size_t __s1_len ;
  size_t __s2_len ;
  int tmp___0 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 22
  walk_cached_hosts = (struct hosts *)((void *)0);
#line 26
  buff_size = 255U;
#line 28
  tmpdate_ptr = (char *)((void *)0);
#line 29
  total_bytes = 0UL;
#line 30
  rslt = 0;
#line 31
  current_network = (struct networks *)((void *)0);
#line 34
  memset((void *)(buff), 0, (size_t )256);
#line 35
  memset((void *)(tmpdate), 0, (size_t )256);
#line 37
  current_time = time((time_t *)((void *)0));
#line 39
  tmpdate_ptr = & tmpdate[0];
#line 42
  rslt = write_line_to_socket(c, (char *)"HTTP/1.1 200 OK\r\n");
#line 43
  if (rslt == -1) {
#line 44
    return ((long )rslt);
  } else {
#line 46
    total_bytes += (unsigned long )rslt;
  }
#line 47
  rslt = write_line_to_socket(c, (char *)"Content-type: text/html\r\n\r\n");
#line 48
  if (rslt == -1) {
#line 49
    return ((long )rslt);
  } else {
#line 51
    total_bytes += (unsigned long )rslt;
  }
#line 52
  rslt = write_line_to_socket(c, (char *)"<HTML><HEAD>\n");
#line 53
  if (rslt == -1) {
#line 54
    return ((long )rslt);
  } else {
#line 56
    total_bytes += (unsigned long )rslt;
  }
#line 57
  rslt = write_line_to_socket(c, (char *)"<TITLE>CryptNET Peer Cache</TITLE>\n");
#line 58
  if (rslt == -1) {
#line 59
    return ((long )rslt);
  } else {
#line 61
    total_bytes += (unsigned long )rslt;
  }
#line 62
  rslt = write_line_to_socket(c, (char *)"<STYLE TYPE=\"text/css\">\n");
#line 63
  if (rslt == -1) {
#line 64
    return ((long )rslt);
  } else {
#line 66
    total_bytes += (unsigned long )rslt;
  }
#line 67
  rslt = write_line_to_socket(c, (char *)"BODY,P,TD  {\n");
#line 68
  if (rslt == -1) {
#line 69
    return ((long )rslt);
  } else {
#line 71
    total_bytes += (unsigned long )rslt;
  }
#line 72
  rslt = write_line_to_socket(c, (char *)"\tfont-family: Tahoma, Arial, Helvetica, sans-serif;\n");
#line 73
  if (rslt == -1) {
#line 74
    return ((long )rslt);
  } else {
#line 76
    total_bytes += (unsigned long )rslt;
  }
#line 77
  rslt = write_line_to_socket(c, (char *)"\tfont-size: 10pt;\n");
#line 78
  if (rslt == -1) {
#line 79
    return ((long )rslt);
  } else {
#line 81
    total_bytes += (unsigned long )rslt;
  }
#line 82
  rslt = write_line_to_socket(c, (char *)"}\n");
#line 83
  if (rslt == -1) {
#line 84
    return ((long )rslt);
  } else {
#line 86
    total_bytes += (unsigned long )rslt;
  }
#line 87
  rslt = write_line_to_socket(c, (char *)"H1 { font-size: 16pt; }\n");
#line 88
  if (rslt == -1) {
#line 89
    return ((long )rslt);
  } else {
#line 91
    total_bytes += (unsigned long )rslt;
  }
#line 92
  rslt = write_line_to_socket(c, (char *)"H3 { font-size: 12pt; }\n");
#line 93
  if (rslt == -1) {
#line 94
    return ((long )rslt);
  } else {
#line 96
    total_bytes += (unsigned long )rslt;
  }
#line 97
  rslt = write_line_to_socket(c, (char *)"TD { font-size: 8pt; white-space: nowrap; background: lightblue; }\n");
#line 98
  if (rslt == -1) {
#line 99
    return ((long )rslt);
  } else {
#line 101
    total_bytes += (unsigned long )rslt;
  }
#line 102
  rslt = write_line_to_socket(c, (char *)"TH { font-size: 8pt; font-weight: bold; white-space: nowrap; background: lightsteelblue; }\n");
#line 103
  if (rslt == -1) {
#line 104
    return ((long )rslt);
  } else {
#line 106
    total_bytes += (unsigned long )rslt;
  }
#line 107
  rslt = write_line_to_socket(c, (char *)"A { color: blue; text-decoration: none; }\n");
#line 108
  if (rslt == -1) {
#line 109
    return ((long )rslt);
  } else {
#line 111
    total_bytes += (unsigned long )rslt;
  }
#line 112
  rslt = write_line_to_socket(c, (char *)"A:Hover { text-decoration: underline; }\n");
#line 113
  if (rslt == -1) {
#line 114
    return ((long )rslt);
  } else {
#line 116
    total_bytes += (unsigned long )rslt;
  }
#line 117
  rslt = write_line_to_socket(c, (char *)"A:Visited { color:darkblue; }\n");
#line 118
  if (rslt == -1) {
#line 119
    return ((long )rslt);
  } else {
#line 121
    total_bytes += (unsigned long )rslt;
  }
#line 122
  rslt = write_line_to_socket(c, (char *)"</STYLE>\n");
#line 123
  if (rslt == -1) {
#line 124
    return ((long )rslt);
  } else {
#line 126
    total_bytes += (unsigned long )rslt;
  }
#line 127
  rslt = write_line_to_socket(c, (char *)"</HEAD>\n");
#line 128
  if (rslt == -1) {
#line 129
    return ((long )rslt);
  } else {
#line 131
    total_bytes += (unsigned long )rslt;
  }
#line 132
  rslt = write_line_to_socket(c, (char *)"<BODY>\n");
#line 133
  if (rslt == -1) {
#line 134
    return ((long )rslt);
  } else {
#line 136
    total_bytes += (unsigned long )rslt;
  }
#line 137
  rslt = write_line_to_socket(c, (char *)"<H1><A HREF=\"http://cryptnet.net/\">CryptNET</A> Peer Cache</H1>\n\n");
#line 138
  if (rslt == -1) {
#line 139
    return ((long )rslt);
  } else {
#line 141
    total_bytes += (unsigned long )rslt;
  }
#line 142
  rslt = write_line_to_socket(c, (char *)"<P>\n");
#line 143
  if (rslt == -1) {
#line 144
    return ((long )rslt);
  } else {
#line 146
    total_bytes += (unsigned long )rslt;
  }
#line 147
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"Running: <A HREF=\"http://cryptnet.net/fsp/cpcd/\">%s</A> on %s<BR>\n",
           (ctx___0->config)->cpcd_version, (ctx___0->config)->server_url);
#line 148
  rslt = write_line_to_socket(c, buff);
#line 149
  if (rslt == -1) {
#line 150
    return ((long )rslt);
  } else {
#line 152
    total_bytes += (unsigned long )rslt;
  }
#line 153
  rslt = write_line_to_socket(c, (char *)"by <A HREF=\"http://cryptnet.net/people/vab/\">V. Alex Brennen</A> (<A HREF=\"mailto:codepoet@dublin.ie\">codepoet@dublin.ie</A>)\n");
#line 154
  if (rslt == -1) {
#line 155
    return ((long )rslt);
  } else {
#line 157
    total_bytes += (unsigned long )rslt;
  }
#line 158
  rslt = write_line_to_socket(c, (char *)"</P>\n\n");
#line 159
  if (rslt == -1) {
#line 160
    return ((long )rslt);
  } else {
#line 162
    total_bytes += (unsigned long )rslt;
  }
#line 163
  rslt = write_line_to_socket(c, (char *)"<H3>Data</H3>\n\n");
#line 164
  if (rslt == -1) {
#line 165
    return ((long )rslt);
  } else {
#line 167
    total_bytes += (unsigned long )rslt;
  }
#line 169
  current_network = get_network_by_name(ctx___0->networks, (ctx___0->config)->default_network);
#line 170
  if ((unsigned long )current_network != (unsigned long )((void *)0)) {
#line 172
    rslt = write_line_to_socket(c, (char *)"<P><TABLE BORDER=0 CELLPADDING=3 CELLSPACING=2>\n");
#line 173
    if (rslt == -1) {
#line 174
      return ((long )rslt);
    } else {
#line 176
      total_bytes += (unsigned long )rslt;
    }
#line 177
    snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"<TR><TH COLSPAN=2>Network: %s</TH></TR>\n",
             current_network->name);
#line 178
    rslt = write_line_to_socket(c, buff);
#line 179
    if (rslt == -1) {
#line 180
      return ((long )rslt);
    } else {
#line 182
      total_bytes += (unsigned long )rslt;
    }
#line 183
    rslt = write_line_to_socket(c, (char *)"<TR><TH>Host Info</TH><TH>Age</TH></TR>\n");
#line 184
    if (rslt == -1) {
#line 185
      return ((long )rslt);
    } else {
#line 187
      total_bytes += (unsigned long )rslt;
    }
#line 188
    walk_cached_hosts = get_first_host(current_network->hosts);
#line 190
    while ((unsigned long )walk_cached_hosts != (unsigned long )((void *)0)) {
#line 192
      if ((int )walk_cached_hosts->type == 72) {
#line 194
        rslt = get_age_r((long *)(& walk_cached_hosts->bdate), & tmpdate_ptr, buff_size);
#line 195
        if (rslt != -1) {
#line 197
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"<TR><TD><A HREF=\"http://%s\">%s</A></TD><TD>%s</TD></TR>\n",
                   walk_cached_hosts->addr, walk_cached_hosts->addr, tmpdate_ptr);
#line 199
          rslt = write_line_to_socket(c, buff);
        }
      }
#line 203
      walk_cached_hosts = walk_cached_hosts->next;
    }
#line 206
    write_line_to_socket(c, (char *)"<TR><TH>Cache URL</TH><TH>Age</TH></TR>\n");
#line 207
    if (rslt == -1) {
#line 208
      return ((long )rslt);
    } else {
#line 210
      total_bytes += (unsigned long )rslt;
    }
#line 211
    walk_cached_hosts = get_first_host(current_network->hosts);
#line 213
    while ((unsigned long )walk_cached_hosts != (unsigned long )((void *)0)) {
#line 215
      if ((int )walk_cached_hosts->type == 85) {
#line 217
        rslt = get_age_r((long *)(& walk_cached_hosts->bdate), & tmpdate_ptr, buff_size);
#line 218
        if (rslt != -1) {
#line 220
          snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"<TR><TD><A HREF=\"%s\">%s</A></TD><TD>%s</TD></TR>\n",
                   walk_cached_hosts->addr, walk_cached_hosts->addr, tmpdate_ptr);
#line 222
          rslt = write_line_to_socket(c, buff);
#line 223
          if (rslt == -1) {
#line 224
            return ((long )rslt);
          } else {
#line 226
            total_bytes += (unsigned long )rslt;
          }
        }
      }
#line 229
      walk_cached_hosts = walk_cached_hosts->next;
    }
#line 232
    rslt = write_line_to_socket(c, (char *)"</TABLE></P>\n");
#line 233
    if (rslt == -1) {
#line 234
      return ((long )rslt);
    } else {
#line 236
      total_bytes += (unsigned long )rslt;
    }
  }
#line 239
  rslt = write_line_to_socket(c, (char *)"<P><TABLE BORDER=0 CELLPADDING=3 CELLSPACING=2>\n");
#line 240
  if (rslt == -1) {
#line 241
    return ((long )rslt);
  } else {
#line 243
    total_bytes += (unsigned long )rslt;
  }
#line 244
  rslt = write_line_to_socket(c, (char *)"<TR><TH COLSPAN=3>Alternate Networks</TH></TR>\n");
#line 245
  if (rslt == -1) {
#line 246
    return ((long )rslt);
  } else {
#line 248
    total_bytes += (unsigned long )rslt;
  }
#line 250
  current_network = get_first_network(ctx___0->networks);
#line 251
  while ((unsigned long )current_network != (unsigned long )((void *)0)) {
#line 253
    if (0) {
#line 253
      __s1_len = __builtin_strlen((char const   *)(current_network->name));
#line 253
      __s2_len = __builtin_strlen((char const   *)((ctx___0->config)->default_network));
#line 253
      if (! ((size_t )((void const   *)(current_network->name + 1)) - (size_t )((void const   *)(current_network->name)) == 1UL)) {
#line 253
        goto _L___0;
      } else
#line 253
      if (__s1_len >= 4UL) {
        _L___0: /* CIL Label */ 
#line 253
        if (! ((size_t )((void const   *)((ctx___0->config)->default_network + 1)) - (size_t )((void const   *)((ctx___0->config)->default_network)) == 1UL)) {
#line 253
          tmp___5 = 1;
        } else
#line 253
        if (__s2_len >= 4UL) {
#line 253
          tmp___5 = 1;
        } else {
#line 253
          tmp___5 = 0;
        }
      } else {
#line 253
        tmp___5 = 0;
      }
#line 253
      if (tmp___5) {
#line 253
        tmp___0 = __builtin_strcmp((char const   *)(current_network->name), (char const   *)((ctx___0->config)->default_network));
#line 253
        tmp___4 = tmp___0;
      } else {
#line 253
        tmp___3 = __builtin_strcmp((char const   *)(current_network->name), (char const   *)((ctx___0->config)->default_network));
#line 253
        tmp___4 = tmp___3;
      }
    } else {
#line 253
      tmp___3 = __builtin_strcmp((char const   *)(current_network->name), (char const   *)((ctx___0->config)->default_network));
#line 253
      tmp___4 = tmp___3;
    }
#line 253
    if (tmp___4 != 0) {
#line 255
      walk_cached_hosts = get_first_host(current_network->hosts);
#line 257
      rslt = write_line_to_socket(c, (char *)"<TR><TH>Network</TH><TH>Cache URL</TH><TH>Age</TH></TR>\n");
#line 258
      if (rslt == -1) {
#line 259
        return ((long )rslt);
      } else {
#line 261
        total_bytes += (unsigned long )rslt;
      }
#line 263
      while ((unsigned long )walk_cached_hosts != (unsigned long )((void *)0)) {
#line 265
        if ((int )walk_cached_hosts->type == 85) {
#line 267
          rslt = get_age_r((long *)(& walk_cached_hosts->bdate), & tmpdate_ptr, buff_size);
#line 268
          if (rslt != -1) {
#line 270
            snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"<TR><TD>%s</TD><TD><A HREF=\"%s\">%s</A></TD><TD>%s</TD></TR>\n",
                     current_network->name, walk_cached_hosts->addr, walk_cached_hosts->addr,
                     tmpdate_ptr);
#line 272
            rslt = write_line_to_socket(c, buff);
          }
        }
#line 275
        walk_cached_hosts = walk_cached_hosts->next;
      }
    }
#line 278
    current_network = current_network->next;
  }
#line 281
  rslt = write_line_to_socket(c, (char *)"</TABLE></P>\n");
#line 282
  if (rslt == -1) {
#line 283
    return ((long )rslt);
  } else {
#line 285
    total_bytes += (unsigned long )rslt;
  }
#line 287
  rslt = write_line_to_socket(c, (char *)"<!-- Config Data\n");
#line 288
  if (rslt == -1) {
#line 289
    return ((long )rslt);
  } else {
#line 291
    total_bytes += (unsigned long )rslt;
  }
#line 292
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"Allowed Nets: %s\n",
           (ctx___0->config)->allowed_networks);
#line 293
  rslt = write_line_to_socket(c, buff);
#line 294
  if (rslt == -1) {
#line 295
    return ((long )rslt);
  } else {
#line 297
    total_bytes += (unsigned long )rslt;
  }
#line 298
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"Default Net: %s\n",
           (ctx___0->config)->default_network);
#line 299
  rslt = write_line_to_socket(c, buff);
#line 300
  if (rslt == -1) {
#line 301
    return ((long )rslt);
  } else {
#line 303
    total_bytes += (unsigned long )rslt;
  }
#line 304
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"Max Hosts: %d\n",
           (ctx___0->config)->max_hosts);
#line 305
  rslt = write_line_to_socket(c, buff);
#line 306
  if (rslt == -1) {
#line 307
    return ((long )rslt);
  } else {
#line 309
    total_bytes += (unsigned long )rslt;
  }
#line 310
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"Max URLS: %d\n",
           (ctx___0->config)->max_urls);
#line 311
  rslt = write_line_to_socket(c, buff);
#line 312
  if (rslt == -1) {
#line 313
    return ((long )rslt);
  } else {
#line 315
    total_bytes += (unsigned long )rslt;
  }
#line 316
  rslt = write_line_to_socket(c, (char *)"-->\n");
#line 317
  if (rslt == -1) {
#line 318
    return ((long )rslt);
  } else {
#line 320
    total_bytes += (unsigned long )rslt;
  }
#line 321
  rslt = write_line_to_socket(c, (char *)"</BODY></HTML>\n");
#line 322
  if (rslt == -1) {
#line 323
    return ((long )rslt);
  } else {
#line 325
    total_bytes += (unsigned long )rslt;
  }
#line 328
  return ((long )total_bytes);
}
}
#line 332 "cpcd_html.c"
long stats_page(int c , struct cpcd_ctx *ctx___0 ) 
{ 
  char buff[256] ;
  int host_count ;
  int url_count ;
  unsigned long total_bytes ;
  int rslt ;
  struct networks *default_network ;

  {
#line 335
  host_count = 0;
#line 336
  url_count = 0;
#line 337
  total_bytes = 0UL;
#line 338
  rslt = 0;
#line 339
  default_network = (struct networks *)((void *)0);
#line 342
  memset((void *)(buff), 0, (size_t )256);
#line 344
  rslt = write_line_to_socket(c, (char *)"HTTP/1.1 200 OK\r\n");
#line 345
  if (rslt == -1) {
#line 346
    return ((long )rslt);
  } else {
#line 348
    total_bytes += (unsigned long )rslt;
  }
#line 349
  rslt = write_line_to_socket(c, (char *)"Content-type: text/html\r\n\r\n");
#line 350
  if (rslt == -1) {
#line 351
    return ((long )rslt);
  } else {
#line 353
    total_bytes += (unsigned long )rslt;
  }
#line 354
  rslt = write_line_to_socket(c, (char *)"<HTML><HEAD>\n");
#line 355
  if (rslt == -1) {
#line 356
    return ((long )rslt);
  } else {
#line 358
    total_bytes += (unsigned long )rslt;
  }
#line 359
  rslt = write_line_to_socket(c, (char *)"        <TITLE>CryptNET Peer Cache Statistics</TITLE>\n");
#line 360
  if (rslt == -1) {
#line 361
    return ((long )rslt);
  } else {
#line 363
    total_bytes += (unsigned long )rslt;
  }
#line 364
  rslt = write_line_to_socket(c, (char *)"<STYLE TYPE=\"text/css\">\n");
#line 365
  if (rslt == -1) {
#line 366
    return ((long )rslt);
  } else {
#line 368
    total_bytes += (unsigned long )rslt;
  }
#line 369
  rslt = write_line_to_socket(c, (char *)"BODY,P,TD  {\n");
#line 370
  if (rslt == -1) {
#line 371
    return ((long )rslt);
  } else {
#line 373
    total_bytes += (unsigned long )rslt;
  }
#line 374
  rslt = write_line_to_socket(c, (char *)"        font-family: Tahoma, Arial, Helvetica, sans-serif;\n");
#line 375
  if (rslt == -1) {
#line 376
    return ((long )rslt);
  } else {
#line 378
    total_bytes += (unsigned long )rslt;
  }
#line 379
  rslt = write_line_to_socket(c, (char *)"        font-size: 10pt;\n");
#line 380
  if (rslt == -1) {
#line 381
    return ((long )rslt);
  } else {
#line 383
    total_bytes += (unsigned long )rslt;
  }
#line 384
  rslt = write_line_to_socket(c, (char *)"}\n");
#line 385
  if (rslt == -1) {
#line 386
    return ((long )rslt);
  } else {
#line 388
    total_bytes += (unsigned long )rslt;
  }
#line 389
  rslt = write_line_to_socket(c, (char *)"H1 { font-size: 16pt; }\n");
#line 390
  if (rslt == -1) {
#line 391
    return ((long )rslt);
  } else {
#line 393
    total_bytes += (unsigned long )rslt;
  }
#line 394
  rslt = write_line_to_socket(c, (char *)"H3 { font-size: 12pt; }\n");
#line 395
  if (rslt == -1) {
#line 396
    return ((long )rslt);
  } else {
#line 398
    total_bytes += (unsigned long )rslt;
  }
#line 399
  rslt = write_line_to_socket(c, (char *)"TD { font-size: 8pt; white-space: nowrap; }\n");
#line 400
  if (rslt == -1) {
#line 401
    return ((long )rslt);
  } else {
#line 403
    total_bytes += (unsigned long )rslt;
  }
#line 404
  rslt = write_line_to_socket(c, (char *)"TH { font-size: 8pt; font-weight: bold; white-space: nowrap; }\n");
#line 405
  if (rslt == -1) {
#line 406
    return ((long )rslt);
  } else {
#line 408
    total_bytes += (unsigned long )rslt;
  }
#line 409
  rslt = write_line_to_socket(c, (char *)"TD.cent { text-align: center; }\n");
#line 410
  if (rslt == -1) {
#line 411
    return ((long )rslt);
  } else {
#line 413
    total_bytes += (unsigned long )rslt;
  }
#line 414
  rslt = write_line_to_socket(c, (char *)".lite { background: lightblue; }\n");
#line 415
  if (rslt == -1) {
#line 416
    return ((long )rslt);
  } else {
#line 418
    total_bytes += (unsigned long )rslt;
  }
#line 419
  rslt = write_line_to_socket(c, (char *)".dark { background: lightsteelblue; }\n");
#line 420
  if (rslt == -1) {
#line 421
    return ((long )rslt);
  } else {
#line 423
    total_bytes += (unsigned long )rslt;
  }
#line 424
  rslt = write_line_to_socket(c, (char *)"A { color: blue; text-decoration: none; }\n");
#line 425
  if (rslt == -1) {
#line 426
    return ((long )rslt);
  } else {
#line 428
    total_bytes += (unsigned long )rslt;
  }
#line 429
  rslt = write_line_to_socket(c, (char *)"A:Hover { text-decoration: underline; }\n");
#line 430
  if (rslt == -1) {
#line 431
    return ((long )rslt);
  } else {
#line 433
    total_bytes += (unsigned long )rslt;
  }
#line 434
  rslt = write_line_to_socket(c, (char *)"A:Visited { color:darkblue; }\n");
#line 435
  if (rslt == -1) {
#line 436
    return ((long )rslt);
  } else {
#line 438
    total_bytes += (unsigned long )rslt;
  }
#line 439
  rslt = write_line_to_socket(c, (char *)"</STYLE></HEAD>\n");
#line 440
  if (rslt == -1) {
#line 441
    return ((long )rslt);
  } else {
#line 443
    total_bytes += (unsigned long )rslt;
  }
#line 444
  rslt = write_line_to_socket(c, (char *)"<BODY>\n");
#line 445
  if (rslt == -1) {
#line 446
    return ((long )rslt);
  } else {
#line 448
    total_bytes += (unsigned long )rslt;
  }
#line 449
  rslt = write_line_to_socket(c, (char *)"<H1><A HREF=\"http://cryptnet.net/\">CryptNET</A> <A HREF=\"http://cryptnet.net/fsp/cpcd/\">Peer Cache</A> Statistics</H1>\n\n\n\n");
#line 450
  if (rslt == -1) {
#line 451
    return ((long )rslt);
  } else {
#line 453
    total_bytes += (unsigned long )rslt;
  }
#line 454
  rslt = write_line_to_socket(c, (char *)"<P>\n");
#line 455
  if (rslt == -1) {
#line 456
    return ((long )rslt);
  } else {
#line 458
    total_bytes += (unsigned long )rslt;
  }
#line 459
  rslt = write_line_to_socket(c, (char *)"[ <A HREF=\"pwc.cgi\">Home</A>\n");
#line 460
  if (rslt == -1) {
#line 461
    return ((long )rslt);
  } else {
#line 463
    total_bytes += (unsigned long )rslt;
  }
#line 464
  rslt = write_line_to_socket(c, (char *)"| <A HREF=\"pwc.cgi?stats=1&client=TEST&version=1.0\">Statistics</A>\n");
#line 465
  if (rslt == -1) {
#line 466
    return ((long )rslt);
  } else {
#line 468
    total_bytes += (unsigned long )rslt;
  }
#line 469
  rslt = write_line_to_socket(c, (char *)"| <A HREF=\"pwc.cgi?get=1&client=TEST&version=1.0\">Data</A> ]\n");
#line 470
  if (rslt == -1) {
#line 471
    return ((long )rslt);
  } else {
#line 473
    total_bytes += (unsigned long )rslt;
  }
#line 474
  rslt = write_line_to_socket(c, (char *)"</P>\n\n\n\n");
#line 475
  if (rslt == -1) {
#line 476
    return ((long )rslt);
  } else {
#line 478
    total_bytes += (unsigned long )rslt;
  }
#line 479
  rslt = write_line_to_socket(c, (char *)"<TABLE BORDER=0 CELLPADDING=3 CELLSPACING=2>\n");
#line 480
  if (rslt == -1) {
#line 481
    return ((long )rslt);
  } else {
#line 483
    total_bytes += (unsigned long )rslt;
  }
#line 484
  rslt = write_line_to_socket(c, (char *)"<TR><TD CLASS=dark WIDTH=50%%>&nbsp;Total Requests:</TD>\n");
#line 485
  if (rslt == -1) {
#line 486
    return ((long )rslt);
  } else {
#line 488
    total_bytes += (unsigned long )rslt;
  }
#line 489
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"        <TD CLASS=lite WIDTH=50%%>&nbsp;%ln</TD> </TR>\n",
           & ctx___0->total_hits);
#line 490
  rslt = write_line_to_socket(c, buff);
#line 491
  if (rslt == -1) {
#line 492
    return ((long )rslt);
  } else {
#line 494
    total_bytes += (unsigned long )rslt;
  }
#line 495
  rslt = write_line_to_socket(c, (char *)"<TR><TD CLASS=dark VALIGN=Top>&nbsp;Requests:</TD>\n");
#line 496
  if (rslt == -1) {
#line 497
    return ((long )rslt);
  } else {
#line 499
    total_bytes += (unsigned long )rslt;
  }
#line 501
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"<TD CLASS=lite>&nbsp;%ln Update, %ln Host/URL-File<BR>\n\n",
           & ctx___0->updts, & ctx___0->reqs);
#line 502
  rslt = write_line_to_socket(c, buff);
#line 503
  if (rslt == -1) {
#line 504
    return ((long )rslt);
  } else {
#line 506
    total_bytes += (unsigned long )rslt;
  }
#line 507
  rslt = write_line_to_socket(c, (char *)"<TR><TD CLASS=dark>&nbsp;Hosts in Cache:</TD>\n");
#line 508
  if (rslt == -1) {
#line 509
    return ((long )rslt);
  } else {
#line 511
    total_bytes += (unsigned long )rslt;
  }
#line 513
  default_network = get_network_by_name(ctx___0->networks, (ctx___0->config)->default_network);
#line 514
  if ((unsigned long )default_network->hosts != (unsigned long )((void *)0)) {
#line 516
    host_count = count_nodes(default_network->hosts, 2);
#line 517
    url_count = count_nodes(default_network->hosts, 3);
  }
#line 520
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"        <TD CLASS=lite>&nbsp; (%d of %d)</TD></TR>\n",
           host_count, (ctx___0->config)->max_hosts);
#line 521
  rslt = write_line_to_socket(c, buff);
#line 522
  if (rslt == -1) {
#line 523
    return ((long )rslt);
  } else {
#line 525
    total_bytes += (unsigned long )rslt;
  }
#line 526
  rslt = write_line_to_socket(c, (char *)"<TR><TD CLASS=dark>&nbsp;Alternate Caches:</TD>\n");
#line 527
  if (rslt == -1) {
#line 528
    return ((long )rslt);
  } else {
#line 530
    total_bytes += (unsigned long )rslt;
  }
#line 531
  snprintf((char * __restrict  )(buff), (size_t )255, (char const   * __restrict  )"        <TD CLASS=lite>&nbsp; (%d of %d)</TD></TR>\n",
           url_count, (ctx___0->config)->max_urls);
#line 532
  rslt = write_line_to_socket(c, buff);
#line 533
  if (rslt == -1) {
#line 534
    return ((long )rslt);
  } else {
#line 536
    total_bytes += (unsigned long )rslt;
  }
#line 538
  rslt = write_line_to_socket(c, (char *)"</TABLE>\n");
#line 539
  if (rslt == -1) {
#line 540
    return ((long )rslt);
  } else {
#line 542
    total_bytes += (unsigned long )rslt;
  }
#line 543
  rslt = write_line_to_socket(c, (char *)"</BODY></HTML>\n\n");
#line 544
  if (rslt == -1) {
#line 545
    return ((long )rslt);
  } else {
#line 547
    total_bytes += (unsigned long )rslt;
  }
#line 550
  return ((long )total_bytes);
}
}
#line 1 "cpcd-cpcd_uhc.o"
#pragma merger("0","/tmp/cil-XOD3OJyQ.i","-g,-O2,-Wall,-g,-O2")
#line 19 "cpcd_uhc.h"
int process_uhc_request(char *the_request ) ;
#line 19 "cpcd_uhc.c"
int process_uhc_request(char *the_request ) 
{ 


  {
#line 22
  return (0);
}
}
#line 1 "cpcd-datastructures.o"
#pragma merger("0","/tmp/cil-kFRee9Ey.i","-g,-O2,-Wall,-g,-O2")
#line 37 "datastructures.h"
struct name_value_pair_dllst *new_dll_node(void *name , unsigned long name_size ,
                                           void *value , unsigned long value_size ) ;
#line 38
int add_dllst_item(struct name_value_pair_dllst **the_list , struct name_value_pair_dllst *new_node ) ;
#line 39
struct name_value_pair_dllst *get_first_pair(struct name_value_pair_dllst *the_list ) ;
#line 40
struct name_value_pair_dllst *get_last_pair(struct name_value_pair_dllst *the_list ) ;
#line 29 "datastructures.c"
struct name_value_pair_dllst *new_dll_node(void *name , unsigned long name_size ,
                                           void *value , unsigned long value_size ) 
{ 
  struct name_value_pair_dllst *new_node ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;

  {
#line 34
  tmp = malloc(sizeof(struct name_value_pair_dllst ));
#line 34
  new_node = (struct name_value_pair_dllst *)tmp;
#line 35
  if ((unsigned long )new_node != (unsigned long )((void *)0)) {
#line 37
    new_node->next = (struct name_value_pair_dllst *)((void *)0);
#line 38
    new_node->prev = (struct name_value_pair_dllst *)((void *)0);
#line 39
    new_node->name = (unsigned char *)((void *)0);
#line 40
    new_node->value = (unsigned char *)((void *)0);
#line 41
    tmp___0 = malloc(name_size + 2UL);
#line 41
    new_node->name = (unsigned char *)tmp___0;
#line 42
    if ((unsigned long )new_node->name != (unsigned long )((void *)0)) {
#line 44
      strncpy((char * __restrict  )new_node->name, (char const   * __restrict  )name,
              name_size + 1UL);
    } else {
#line 48
      free((void *)new_node);
#line 49
      new_node = (struct name_value_pair_dllst *)((void *)0);
    }
#line 51
    if ((unsigned long )value != (unsigned long )((void *)0)) {
#line 53
      tmp___1 = malloc(value_size + 2UL);
#line 53
      new_node->value = (unsigned char *)tmp___1;
#line 54
      if ((unsigned long )new_node->value != (unsigned long )((void *)0)) {
#line 56
        strncpy((char * __restrict  )new_node->value, (char const   * __restrict  )value,
                value_size + 1UL);
      } else {
#line 60
        free((void *)new_node->name);
#line 61
        free((void *)new_node);
#line 62
        new_node = (struct name_value_pair_dllst *)((void *)0);
      }
    }
  }
#line 67
  return (new_node);
}
}
#line 71 "datastructures.c"
int add_dllst_item(struct name_value_pair_dllst **the_list , struct name_value_pair_dllst *new_node ) 
{ 
  int rslt ;
  struct name_value_pair_dllst *local_list ;

  {
#line 73
  rslt = 0;
#line 76
  if ((unsigned long )the_list != (unsigned long )((void *)0)) {
#line 78
    local_list = get_last_pair(*the_list);
#line 79
    if ((unsigned long )local_list == (unsigned long )((void *)0)) {
#line 81
      local_list = new_node;
    } else {
#line 85
      local_list->next = new_node;
#line 86
      new_node->prev = local_list;
    }
#line 88
    *the_list = local_list;
  } else {
#line 92
    rslt = -1;
  }
#line 95
  return (rslt);
}
}
#line 99 "datastructures.c"
struct name_value_pair_dllst *get_first_pair(struct name_value_pair_dllst *the_list ) 
{ 


  {
#line 101
  if ((unsigned long )the_list != (unsigned long )((void *)0)) {
#line 103
    while ((unsigned long )the_list->prev != (unsigned long )((void *)0)) {
#line 105
      the_list = the_list->prev;
    }
  }
#line 110
  return (the_list);
}
}
#line 114 "datastructures.c"
struct name_value_pair_dllst *get_last_pair(struct name_value_pair_dllst *the_list ) 
{ 


  {
#line 116
  if ((unsigned long )the_list != (unsigned long )((void *)0)) {
#line 118
    while ((unsigned long )the_list->next != (unsigned long )((void *)0)) {
#line 120
      the_list = the_list->next;
    }
  }
#line 125
  return (the_list);
}
}
#line 128 "datastructures.c"
char *get_value(struct name_value_pair_dllst *the_list , char *name ) 
{ 
  size_t __s1_len ;
  size_t __s2_len ;
  int tmp___0 ;
  int tmp___3 ;
  int tmp___4 ;
  int tmp___5 ;

  {
#line 130
  if ((unsigned long )the_list == (unsigned long )((void *)0)) {
#line 132
    return ((char *)((void *)0));
  }
#line 136
  the_list = get_first_pair(the_list);
#line 138
  while ((unsigned long )the_list != (unsigned long )((void *)0)) {
#line 140
    if (0) {
#line 140
      __s1_len = __builtin_strlen((char const   *)the_list->name);
#line 140
      __s2_len = __builtin_strlen((char const   *)name);
#line 140
      if (! ((size_t )((void const   *)(the_list->name + 1)) - (size_t )((void const   *)the_list->name) == 1UL)) {
#line 140
        goto _L___0;
      } else
#line 140
      if (__s1_len >= 4UL) {
        _L___0: /* CIL Label */ 
#line 140
        if (! ((size_t )((void const   *)(name + 1)) - (size_t )((void const   *)name) == 1UL)) {
#line 140
          tmp___5 = 1;
        } else
#line 140
        if (__s2_len >= 4UL) {
#line 140
          tmp___5 = 1;
        } else {
#line 140
          tmp___5 = 0;
        }
      } else {
#line 140
        tmp___5 = 0;
      }
#line 140
      if (tmp___5) {
#line 140
        tmp___0 = __builtin_strcmp((char const   *)the_list->name, (char const   *)name);
#line 140
        tmp___4 = tmp___0;
      } else {
#line 140
        tmp___3 = __builtin_strcmp((char const   *)the_list->name, (char const   *)name);
#line 140
        tmp___4 = tmp___3;
      }
    } else {
#line 140
      tmp___3 = __builtin_strcmp((char const   *)the_list->name, (char const   *)name);
#line 140
      tmp___4 = tmp___3;
    }
#line 140
    if (tmp___4 == 0) {
#line 142
      return ((char *)the_list->value);
    } else {
#line 146
      the_list = the_list->next;
    }
  }
#line 151
  return ((char *)((void *)0));
}
}
#line 155 "datastructures.c"
void free_name_value_pair_dllst(struct name_value_pair_dllst *the_list ) 
{ 
  struct name_value_pair_dllst *walk_pair ;
  struct name_value_pair_dllst *next_pair ;
  struct name_value_pair_dllst *tmp ;

  {
#line 157
  walk_pair = (struct name_value_pair_dllst *)((void *)0);
#line 158
  next_pair = (struct name_value_pair_dllst *)((void *)0);
#line 160
  if ((unsigned long )the_list != (unsigned long )((void *)0)) {
#line 162
    tmp = get_first_pair(the_list);
#line 162
    walk_pair = tmp;
#line 163
    while ((unsigned long )walk_pair != (unsigned long )((void *)0)) {
#line 166
      next_pair = walk_pair->next;
#line 167
      if ((unsigned long )walk_pair->name != (unsigned long )((void *)0)) {
#line 170
        free((void *)walk_pair->name);
#line 171
        walk_pair->name = (unsigned char *)((void *)0);
      }
#line 173
      if ((unsigned long )walk_pair->value != (unsigned long )((void *)0)) {
#line 176
        free((void *)walk_pair->value);
#line 177
        walk_pair->value = (unsigned char *)((void *)0);
      }
#line 179
      free((void *)walk_pair);
#line 180
      walk_pair = next_pair;
    }
  }
#line 184
  return;
}
}
#line 1 "cpcd-cgi.o"
#pragma merger("0","/tmp/cil-nZJ7VzRG.i","-g,-O2,-Wall,-g,-O2")
#line 26 "cgi.h"
struct name_value_pair_dllst *parse_name_value_pairs(char *data ) ;
#line 22 "cgi.c"
struct name_value_pair_dllst *parse_name_value_pairs(char *data ) 
{ 
  struct name_value_pair_dllst *cgidata ;
  struct name_value_pair_dllst *current ;
  char *dataptr ;
  char *name ;
  char *true_name ;
  char *true_value ;
  char *p ;
  void *tmp ;
  char *tmp___1 ;
  size_t tmp___2 ;
  void *tmp___3 ;
  int tmp___4 ;
  size_t tmp___5 ;
  void *tmp___6 ;
  size_t tmp___7 ;
  size_t tmp___8 ;
  void *tmp___9 ;
  size_t tmp___10 ;
  void *tmp___11 ;
  char *tmp___13 ;

  {
#line 24
  cgidata = (struct name_value_pair_dllst *)((void *)0);
#line 25
  current = (struct name_value_pair_dllst *)((void *)0);
#line 27
  dataptr = (char *)((void *)0);
#line 28
  name = (char *)((void *)0);
#line 29
  true_name = (char *)((void *)0);
#line 30
  true_value = (char *)((void *)0);
#line 31
  p = (char *)((void *)0);
#line 34
  tmp = malloc(sizeof(struct name_value_pair_dllst ));
#line 34
  cgidata = (struct name_value_pair_dllst *)tmp;
#line 35
  if ((unsigned long )cgidata == (unsigned long )((void *)0)) {
#line 37
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Malloc call failed: Out of memory.\n");
#line 39
    return ((struct name_value_pair_dllst *)((void *)0));
  }
#line 42
  cgidata->prev = (struct name_value_pair_dllst *)((void *)0);
#line 43
  cgidata->next = (struct name_value_pair_dllst *)((void *)0);
#line 44
  cgidata->name = (unsigned char *)((void *)0);
#line 45
  cgidata->value = (unsigned char *)((void *)0);
#line 47
  current = cgidata;
#line 49
  dataptr = data + 0;
#line 51
  tmp___1 = __strtok_r((char * __restrict  )dataptr, (char const   * __restrict  )"&",
                       (char ** __restrict  )(& p));
#line 51
  name = tmp___1;
#line 52
  if ((unsigned long )name == (unsigned long )((void *)0)) {
#line 54
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"incorrectly formated query.\n");
#line 55
    free_name_value_pair_dllst(cgidata);
#line 57
    return ((struct name_value_pair_dllst *)((void *)0));
  }
#line 59
  while (1) {
#line 61
    true_name = name + 0;
#line 62
    tmp___2 = strlen((char const   *)name);
#line 62
    tmp___3 = memchr((void const   *)name, '=', tmp___2);
#line 62
    true_value = (char *)tmp___3;
#line 63
    if ((unsigned long )true_value == (unsigned long )((void *)0)) {
#line 65
      free_name_value_pair_dllst(cgidata);
#line 67
      return ((struct name_value_pair_dllst *)((void *)0));
    }
#line 70
    *(true_value + 0) = (char )'\000';
#line 71
    true_value ++;
#line 72
    if ((unsigned long )true_value == (unsigned long )((void *)0)) {
#line 74
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Unexpected Error: The value is null.");
#line 75
      free_name_value_pair_dllst(cgidata);
#line 77
      return ((struct name_value_pair_dllst *)((void *)0));
    }
#line 79
    tmp___4 = hex_to_ascii(true_value);
#line 79
    if (tmp___4 == -1) {
#line 81
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"hex_to_ascii failure\n");
#line 82
      free_name_value_pair_dllst(cgidata);
#line 84
      return ((struct name_value_pair_dllst *)((void *)0));
    }
#line 87
    tmp___5 = strlen((char const   *)true_name);
#line 87
    tmp___6 = malloc(tmp___5 + 2UL);
#line 87
    cgidata->name = (unsigned char *)((char *)tmp___6);
#line 88
    if ((unsigned long )cgidata->name == (unsigned long )((void *)0)) {
#line 90
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to malloc: out of memory\n");
#line 91
      free_name_value_pair_dllst(cgidata);
#line 93
      return ((struct name_value_pair_dllst *)((void *)0));
    }
#line 95
    tmp___7 = strlen((char const   *)true_name);
#line 95
    strncpy((char * __restrict  )cgidata->name, (char const   * __restrict  )true_name,
            tmp___7 + 1UL);
#line 96
    tmp___8 = strlen((char const   *)true_value);
#line 96
    tmp___9 = malloc(tmp___8 + 2UL);
#line 96
    cgidata->value = (unsigned char *)((char *)tmp___9);
#line 97
    if ((unsigned long )cgidata->value == (unsigned long )((void *)0)) {
#line 99
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to malloc: out of memory\n");
#line 100
      free_name_value_pair_dllst(cgidata);
#line 102
      return ((struct name_value_pair_dllst *)((void *)0));
    }
#line 104
    tmp___10 = strlen((char const   *)true_value);
#line 104
    strncpy((char * __restrict  )cgidata->value, (char const   * __restrict  )true_value,
            tmp___10 + 1UL);
#line 105
    tmp___11 = malloc(sizeof(struct name_value_pair_dllst ));
#line 105
    cgidata->next = (struct name_value_pair_dllst *)tmp___11;
#line 106
    if ((unsigned long )cgidata->next == (unsigned long )((void *)0)) {
#line 108
      fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Failed to malloc:  out of memory\n");
#line 109
      free_name_value_pair_dllst(cgidata);
#line 111
      return ((struct name_value_pair_dllst *)((void *)0));
    }
#line 113
    (cgidata->next)->prev = cgidata;
#line 114
    cgidata = cgidata->next;
#line 115
    cgidata->next = (struct name_value_pair_dllst *)((void *)0);
#line 116
    cgidata->name = (unsigned char *)((void *)0);
#line 117
    cgidata->value = (unsigned char *)((void *)0);
#line 59
    tmp___13 = __strtok_r((char * __restrict  )'\000', (char const   * __restrict  )"&",
                          (char ** __restrict  )(& p));
#line 59
    name = tmp___13;
#line 59
    if (! name) {
#line 59
      break;
    }
  }
#line 120
  cgidata = cgidata->prev;
#line 122
  if ((unsigned long )cgidata->next != (unsigned long )((void *)0)) {
#line 124
    free((void *)cgidata->next);
#line 125
    cgidata->next = (struct name_value_pair_dllst *)((void *)0);
  }
#line 128
  return (cgidata);
}
}
#line 132 "cgi.c"
struct name_value_pair_dllst *parse_name_value_pairs_r(char *data ) 
{ 
  struct name_value_pair_dllst *new_node ;
  struct name_value_pair_dllst *tmpdata ;
  char *name ;
  char *value ;
  char *p ;
  char *tmp___0 ;
  size_t tmp___1 ;
  void *tmp___2 ;
  size_t tmp___3 ;
  size_t tmp___4 ;
  char *tmp___6 ;

  {
#line 134
  new_node = (struct name_value_pair_dllst *)((void *)0);
#line 135
  tmpdata = (struct name_value_pair_dllst *)((void *)0);
#line 137
  name = (char *)((void *)0);
#line 138
  value = (char *)((void *)0);
#line 139
  p = (char *)((void *)0);
#line 142
  tmp___0 = __strtok_r((char * __restrict  )(data + 0), (char const   * __restrict  )"&",
                       (char ** __restrict  )(& p));
#line 142
  name = tmp___0;
#line 143
  if ((unsigned long )name == (unsigned long )((void *)0)) {
#line 145
    return ((struct name_value_pair_dllst *)((void *)0));
  }
#line 148
  while (1) {
#line 150
    tmp___1 = strlen((char const   *)name);
#line 150
    tmp___2 = memchr((void const   *)name, '=', tmp___1);
#line 150
    value = (char *)tmp___2;
#line 151
    if ((unsigned long )value == (unsigned long )((void *)0)) {
#line 153
      goto __Cont;
    }
#line 155
    *(value + 0) = (char )'\000';
#line 156
    value ++;
#line 158
    tmp___3 = strlen((char const   *)value);
#line 158
    tmp___4 = strlen((char const   *)name);
#line 158
    new_node = new_dll_node((void *)name, tmp___4, (void *)value, tmp___3);
#line 159
    if ((unsigned long )new_node == (unsigned long )((void *)0)) {
#line 160
      printf((char const   * __restrict  )"New Node is NULL\n");
    }
#line 161
    add_dllst_item(& tmpdata, new_node);
    __Cont: /* CIL Label */ 
#line 148
    tmp___6 = __strtok_r((char * __restrict  )'\000', (char const   * __restrict  )"&",
                         (char ** __restrict  )(& p));
#line 148
    name = tmp___6;
#line 148
    if (! name) {
#line 148
      break;
    }
  }
#line 164
  return (tmpdata);
}
}
#line 170 "cgi.c"
static char const   *hex  =    "0123456789ABCDEF";
#line 168 "cgi.c"
int hex_to_ascii(char *s ) 
{ 
  unsigned int ascii ;
  char *p ;
  char *match ;
  int error ;
  char *tmp ;
  char *tmp___1 ;
  char *tmp___3 ;
  char *tmp___4 ;
  char *tmp___5 ;

  {
#line 171
  ascii = 0U;
#line 172
  p = (char *)((void *)0);
#line 173
  match = (char *)((void *)0);
#line 174
  error = 0;
#line 177
  if ((unsigned long )s == (unsigned long )((void *)0)) {
#line 179
    return (-1);
  }
#line 182
  p = s;
#line 182
  while (1) {
#line 182
    if (! error) {
#line 182
      if (! ((int )*s != 0)) {
#line 182
        break;
      }
    } else {
#line 182
      break;
    }
#line 184
    if ((int )*s == 37) {
#line 186
      s ++;
#line 187
      tmp___3 = __builtin_strchr((char *)hex, (int )*s);
#line 187
      match = tmp___3;
#line 187
      if ((unsigned long )match != (unsigned long )((void *)0)) {
#line 189
        ascii = (unsigned int )(match - (char *)hex);
#line 191
        s ++;
#line 192
        tmp___1 = __builtin_strchr((char *)hex, (int )*s);
#line 192
        match = tmp___1;
#line 192
        if ((unsigned long )match != (unsigned long )((void *)0)) {
#line 194
          ascii <<= 4;
#line 195
          ascii |= (unsigned int )(match - (char *)hex);
#line 197
          tmp = p;
#line 197
          p ++;
#line 197
          *tmp = (char )ascii;
        }
      }
    } else
#line 201
    if ((int )*s == 43) {
#line 203
      tmp___4 = p;
#line 203
      p ++;
#line 203
      *tmp___4 = (char )' ';
    } else {
#line 207
      tmp___5 = p;
#line 207
      p ++;
#line 207
      *tmp___5 = *s;
    }
#line 182
    s ++;
  }
#line 210
  *p = (char )'\000';
#line 212
  return (0);
}
}
